<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <link rel="stylesheet" href="https://npm.elemecdn.com/font-awesome/css/font-awesome.min.css"/ media="defer" onload="this.media='all'">
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/avatar.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/avatar.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wbuildings.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="人间何所以，观风与月舒。">
<meta property="og:type" content="article">
<meta property="og:title" content="MT19937实战">
<meta property="og:url" content="https://wbuildings.github.io/Crypto/MT19937%E5%AE%9E%E6%88%98/index.html">
<meta property="og:site_name" content="W&#39;Blog">
<meta property="og:description" content="人间何所以，观风与月舒。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-03-20T17:05:13.000Z">
<meta property="article:modified_time" content="2024-11-14T13:26:32.215Z">
<meta property="article:author" content="Wbuildings">
<meta property="article:tag" content="MT19937">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://wbuildings.github.io/Crypto/MT19937%E5%AE%9E%E6%88%98/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>MT19937实战 | W'Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <script defer src="/live2d-widget/autoload.js"></script>
  
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">W'Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Wbuildings的自勉小屋</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">23</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">2</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">30</span></a>

  </li>
        <li class="menu-item menu-item-links">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL1didWlsZGluZ3M=" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wbuildings.github.io/Crypto/MT19937%E5%AE%9E%E6%88%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Wbuildings">
      <meta itemprop="description" content="须知少年凌云志，曾许人间第一流">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="W'Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MT19937实战
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-03-21 01:05:13" itemprop="dateCreated datePublished" datetime="2024-03-21T01:05:13+08:00">2024-03-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Crypto/" itemprop="url" rel="index"><span itemprop="name">Crypto</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/Crypto/MT19937%E5%AE%9E%E6%88%98/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/Crypto/MT19937%E5%AE%9E%E6%88%98/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>54k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>49 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><strong>人间何所以，观风与月舒。</strong> </p>
<span id="more"></span>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>回首看<code>MT19937</code>，似乎当脚本小子也不错，常规的四种题型是可以解的，魔改的大概也只能去啃原理了</p>
<p>此篇仅供常规解题所需</p>
<hr>
<h1 id="例题："><a href="#例题：" class="headerlink" title="例题："></a>例题：</h1><h2 id="NKCTF2023-real-MT"><a href="#NKCTF2023-real-MT" class="headerlink" title="[NKCTF2023]real_MT"></a>[NKCTF2023]real_MT</h2><blockquote>
<p>题目：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_1</span>():</span><br><span class="line">    randoms = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">208</span>):</span><br><span class="line">        randoms.append(random.getrandbits(<span class="number">96</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;randoms = &quot;</span>+<span class="built_in">str</span>(randoms))</span><br><span class="line">    number = <span class="built_in">str</span>(random.getrandbits(<span class="number">96</span>))</span><br><span class="line">    guess = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess after number:&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_2</span>():</span><br><span class="line">    number = <span class="built_in">str</span>(random.getrandbits(<span class="number">96</span>))</span><br><span class="line">    randoms = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">627</span>):</span><br><span class="line">        randoms.append(random.getrandbits(<span class="number">32</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;randoms = &quot;</span>+<span class="built_in">str</span>(randoms))</span><br><span class="line">    guess = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess pre number:&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_3</span>():</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_int32</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(<span class="number">0xFFFFFFFF</span> &amp; x)  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">init</span>(<span class="params">seed</span>):</span><br><span class="line">        mt = [<span class="number">0</span>] * <span class="number">624</span></span><br><span class="line">        mt[<span class="number">0</span>] = seed</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">624</span>):</span><br><span class="line">            mt[i] = _int32(<span class="number">1812433253</span> * (mt[i - <span class="number">1</span>] ^ mt[i - <span class="number">1</span>] &gt;&gt; <span class="number">30</span>) + i)</span><br><span class="line">        <span class="keyword">return</span> mt[-<span class="number">1</span>]</span><br><span class="line">    number = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;last number = &quot;</span>+ <span class="built_in">str</span>(init(number)))</span><br><span class="line">    guess = <span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess seed number:&quot;</span>)))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_4</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_number</span>(<span class="params">y</span>):</span><br><span class="line">        y = y ^ y &gt;&gt; <span class="number">11</span></span><br><span class="line">        y = y ^ y &lt;&lt; <span class="number">7</span> &amp; <span class="number">2636928640</span></span><br><span class="line">        y = y ^ y &lt;&lt; <span class="number">15</span> &amp; <span class="number">4022730752</span></span><br><span class="line">        y = y ^ y &gt;&gt; <span class="number">18</span></span><br><span class="line">        <span class="keyword">return</span> y&amp;<span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">    number = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;extract number = &quot;</span>+ <span class="built_in">str</span>(extract_number(number)))</span><br><span class="line">    guess = <span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess be extracted number:&quot;</span>)))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the Mersenne Twister basic challenge. Please try to solve 20 challenges in 60 seconds.&quot;</span>)</span><br><span class="line">signal.alarm(<span class="number">60</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Round: &quot;</span>+<span class="built_in">str</span>(i+<span class="number">1</span>))</span><br><span class="line">    random.choice([guess_number_1,guess_number_2,guess_number_3,guess_number_4])()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Good job!&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;/flag&#x27;</span>).read()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Congratulations on passing the challenge. This is your flag: &quot;</span> + <span class="built_in">str</span>(flag))</span><br></pre></td></tr></table></figure>
<h3 id="题解："><a href="#题解：" class="headerlink" title="题解："></a>题解：</h3><p>四种情况先逐个分析吧：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_3</span>():</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_int32</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(<span class="number">0xFFFFFFFF</span> &amp; x)  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">init</span>(<span class="params">seed</span>):</span><br><span class="line">        mt = [<span class="number">0</span>] * <span class="number">624</span></span><br><span class="line">        mt[<span class="number">0</span>] = seed</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">624</span>):</span><br><span class="line">            mt[i] = _int32(<span class="number">1812433253</span> * (mt[i - <span class="number">1</span>] ^ mt[i - <span class="number">1</span>] &gt;&gt; <span class="number">30</span>) + i)</span><br><span class="line">        <span class="keyword">return</span> mt[-<span class="number">1</span>]</span><br><span class="line">    number = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;last number = &quot;</span>+ <span class="built_in">str</span>(init(number)))</span><br><span class="line">    guess = <span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess seed number:&quot;</span>)))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_4</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_number</span>(<span class="params">y</span>):</span><br><span class="line">        y = y ^ y &gt;&gt; <span class="number">11</span></span><br><span class="line">        y = y ^ y &lt;&lt; <span class="number">7</span> &amp; <span class="number">2636928640</span></span><br><span class="line">        y = y ^ y &lt;&lt; <span class="number">15</span> &amp; <span class="number">4022730752</span></span><br><span class="line">        y = y ^ y &gt;&gt; <span class="number">18</span></span><br><span class="line">        <span class="keyword">return</span> y&amp;<span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">    number = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;extract number = &quot;</span>+ <span class="built_in">str</span>(extract_number(number)))</span><br><span class="line">    guess = <span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess be extracted number:&quot;</span>)))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>这两个直接跟着<code>badmonkey</code>师傅无脑代就行：<span class="exturl" data-url="aHR0cHM6Ly9iYWRtb25rZXkuc2l0ZS9hcmNoaXZlcy9tdDE5OTM3I+mimOWeizIt6aKE5rWL6ZqP5py65pWw">浅析MT19937伪随机数生成算法 - badmonkey<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="求seed"><a href="#求seed" class="headerlink" title="求seed"></a>求seed</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3 seed</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_int32</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="number">0xFFFFFFFF</span> &amp; x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_right</span>(<span class="params">res,shift</span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>//shift):</span><br><span class="line">        res = tmp^res&gt;&gt;shift</span><br><span class="line">    <span class="keyword">return</span> _int32(res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover</span>(<span class="params">last</span>):</span><br><span class="line">    n = <span class="number">1</span>&lt;&lt;<span class="number">32</span></span><br><span class="line">    inv = invert(<span class="number">1812433253</span>,n)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">623</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">        last = ((last-i)*inv)%n</span><br><span class="line">        last = invert_right(last,<span class="number">30</span>)</span><br><span class="line">    <span class="keyword">return</span> last</span><br><span class="line">seed = <span class="number">578972588</span></span><br><span class="line"><span class="built_in">print</span>(recover(seed))</span><br></pre></td></tr></table></figure>
<h3 id="求extracted"><a href="#求extracted" class="headerlink" title="求extracted"></a>求extracted</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4 extracted</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># right shift inverse</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_right</span>(<span class="params">res, shift, bits=<span class="number">32</span></span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = res ^ tmp &gt;&gt; shift</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># left shift with mask inverse</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_left_mask</span>(<span class="params">res, shift, mask, bits=<span class="number">32</span></span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = res ^ tmp &lt;&lt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover</span>(<span class="params">y</span>):</span><br><span class="line">    y = inverse_right(y,<span class="number">18</span>)</span><br><span class="line">    y = inverse_left_mask(y,<span class="number">15</span>,<span class="number">4022730752</span>)</span><br><span class="line">    y = inverse_left_mask(y,<span class="number">7</span>,<span class="number">2636928640</span>)</span><br><span class="line">    y = inverse_right(y,<span class="number">11</span>)</span><br><span class="line">    <span class="keyword">return</span> y&amp;<span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">extract = <span class="number">1531729985</span></span><br><span class="line"><span class="built_in">print</span>(recover(extract))</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="预测随机数"><a href="#预测随机数" class="headerlink" title="预测随机数"></a>预测随机数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_1</span>():</span><br><span class="line">    randoms = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">208</span>):</span><br><span class="line">        randoms.append(random.getrandbits(<span class="number">96</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;randoms = &quot;</span>+<span class="built_in">str</span>(randoms))</span><br><span class="line">    number = <span class="built_in">str</span>(random.getrandbits(<span class="number">96</span>))</span><br><span class="line">    guess = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess after number:&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>预测后面的一个<code>96bit</code>的随机数</p>
<p>常规的每个数都是<code>32bit</code>，而这里<code>badmonkey师傅</code>给的也是预测<code>32bit</code>数的脚本，所以我们要想办法把<code>96bit</code>的数转换成<code>3</code>个<code>32bit</code>的数，观察如下测试代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.seed(<span class="number">1</span>)  <span class="comment">#掷随机数种子为1从而确保随机数产生的一致性</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(random.getrandbits(<span class="number">32</span>)))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(random.getrandbits(<span class="number">32</span>)))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(random.getrandbits(<span class="number">32</span>)))</span><br><span class="line">random.seed(<span class="number">1</span>)  <span class="comment">#重新掷随机数种子</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(random.getrandbits(<span class="number">96</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x2265b1f5</span></span><br><span class="line"><span class="comment"># 0x91b7584a</span></span><br><span class="line"><span class="comment"># 0xd8f16adf</span></span><br><span class="line"><span class="comment"># 0xd8f16adf91b7584a2265b1f5</span></span><br></pre></td></tr></table></figure>
<p>可以看到一个<code>96bit</code>随机数是由三个连续的<code>32bit</code>随机数拼接而成的，并且第三个随机数为高位，第一个随机数为低位，所以我们修改一下代码即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> randoms:</span><br><span class="line">    a = <span class="built_in">hex</span>(i)[<span class="number">2</span>:]</span><br><span class="line">    c.append(<span class="built_in">int</span>(a[<span class="built_in">len</span>(a) // <span class="number">3</span> * <span class="number">2</span>:], <span class="number">16</span>))</span><br><span class="line">    c.append(<span class="built_in">int</span>(a[<span class="built_in">len</span>(a)//<span class="number">3</span>:<span class="built_in">len</span>(a)//<span class="number">3</span>*<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line">    c.append(<span class="built_in">int</span>(a[:<span class="built_in">len</span>(a) // <span class="number">3</span>], <span class="number">16</span>))</span><br></pre></td></tr></table></figure>
<p><code>64bit</code>随机数同样如此，如下是预测随机数脚本（有点很奇怪，有次测试的时候预测结果错了，但其他的是正确的）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1 after number</span></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_right</span>(<span class="params">m,l,val=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">    length = <span class="number">32</span></span><br><span class="line">    mx = <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">if</span> val == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        val = mx</span><br><span class="line">    i,res = <span class="number">0</span>,<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i*l&lt;length:</span><br><span class="line">        mask = (mx&lt;&lt;(length-l)&amp;mx)&gt;&gt;i*l</span><br><span class="line">        tmp = m &amp; mask</span><br><span class="line">        m = m^tmp&gt;&gt;l&amp;val</span><br><span class="line">        res += tmp</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_left</span>(<span class="params">m,l,val</span>):</span><br><span class="line">    length = <span class="number">32</span></span><br><span class="line">    mx = <span class="number">0xffffffff</span></span><br><span class="line">    i,res = <span class="number">0</span>,<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i*l &lt; length:</span><br><span class="line">        mask = (mx&gt;&gt;(length-l)&amp;mx)&lt;&lt;i*l</span><br><span class="line">        tmp = m &amp; mask</span><br><span class="line">        m ^= tmp&lt;&lt;l&amp;val</span><br><span class="line">        res |= tmp</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_temper</span>(<span class="params">m</span>):</span><br><span class="line">    m = invert_right(m,<span class="number">18</span>)</span><br><span class="line">    m = invert_left(m,<span class="number">15</span>,<span class="number">4022730752</span>)</span><br><span class="line">    m = invert_left(m,<span class="number">7</span>,<span class="number">2636928640</span>)</span><br><span class="line">    m = invert_right(m,<span class="number">11</span>)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clone_mt</span>(<span class="params">record</span>):</span><br><span class="line">    state = [invert_temper(i) <span class="keyword">for</span> i <span class="keyword">in</span> record]</span><br><span class="line">    gen = Random()</span><br><span class="line">    gen.setstate((<span class="number">3</span>,<span class="built_in">tuple</span>(state+[<span class="number">0</span>]),<span class="literal">None</span>))</span><br><span class="line">    <span class="keyword">return</span> gen</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">randoms = [<span class="number">55015607074857799292945552290</span>, <span class="number">49368042755482977011736956173</span>, <span class="number">40475374240531115107595906636</span>, <span class="number">52147615048581670023735755450</span>, <span class="number">13432490767545507105189747763</span>, <span class="number">24440678017972777884814646255</span>, <span class="number">32822903152999092153407655597</span>, <span class="number">8563483583446603233686286354</span>, <span class="number">75732019275746461853540401495</span>, <span class="number">36842332206659125653150736486</span>, <span class="number">76786413054424156228987909265</span>, <span class="number">78728868918063155711331208027</span>, <span class="number">68111503649325447384558973315</span>, <span class="number">50046539350414059782746722603</span>, <span class="number">33122956341131312047186478550</span>, <span class="number">47134379833914353599100802574</span>, <span class="number">14506941828436962820850816482</span>, <span class="number">16254006011206386851511190777</span>, <span class="number">53774746810651233261166083709</span>, <span class="number">57317412206054586514985875280</span>, <span class="number">43011044274622942766585189176</span>, <span class="number">21510983328491776879720475647</span>, <span class="number">68805188235988349436606490157</span>, <span class="number">68293687378252177576750854213</span>, <span class="number">64020092712881170155616652147</span>, <span class="number">58788852915482172394398327520</span>, <span class="number">20534731592145885333097885636</span>, <span class="number">71497885157511490073528334436</span>, <span class="number">50079126675284942137464435871</span>, <span class="number">16433905363688130336892639414</span>, <span class="number">10833644831894048938957163773</span>, <span class="number">61837597918870726435017132850</span>, <span class="number">50007378472767284514600652443</span>, <span class="number">13242758280359098364681702807</span>, <span class="number">48040447462883040840110279722</span>, <span class="number">48653833299736009023667402599</span>, <span class="number">61877052829753339768672826777</span>, <span class="number">55104138447302791542841950167</span>, <span class="number">59956782054709979669719351421</span>, <span class="number">33622933736356173639796248572</span>, <span class="number">70720508316358691710097244967</span>, <span class="number">26438465850133558815351580879</span>, <span class="number">12121649600344247919530245458</span>, <span class="number">59429702128155774929559418436</span>, <span class="number">8461855977540480946850517835</span>, <span class="number">35371049050859796434557316156</span>, <span class="number">74900517442122255478113670139</span>, <span class="number">56015804116725775644082181473</span>, <span class="number">54019918704797178896937181953</span>, <span class="number">46449490759360975867530830160</span>, <span class="number">21716938523285444592131111037</span>, <span class="number">4075915261354769937217394891</span>, <span class="number">71101712150556394609286976122</span>, <span class="number">77514446308635805069858161218</span>, <span class="number">30443551680738939325710619401</span>, <span class="number">51330659874633330020137362887</span>, <span class="number">16870162608087608659692436972</span>, <span class="number">36332661698483296611490764287</span>, <span class="number">38912147134106871206560383319</span>, <span class="number">66798268847122499800706103042</span>, <span class="number">241691625661529797405764102</span>, <span class="number">9680620382995429570437419894</span>, <span class="number">54281462677774536994926184946</span>, <span class="number">49156921844074280073449443668</span>, <span class="number">47003617901112210542122896375</span>, <span class="number">20630134319865926707841141605</span>, <span class="number">38539127713936043329828502512</span>, <span class="number">37765649689660950654295018296</span>, <span class="number">27519165366018178520157118526</span>, <span class="number">47311700897513991864703815914</span>, <span class="number">14844131572803548743566512704</span>, <span class="number">72315716735652440986087523229</span>, <span class="number">46411344686639197025534075618</span>, <span class="number">13959184897278020398348948659</span>, <span class="number">2079854302954576073339089565</span>, <span class="number">39428786840574943257095970633</span>, <span class="number">33458396202396229906230251418</span>, <span class="number">69814672396568547483000493475</span>, <span class="number">28451062576030293943028542769</span>, <span class="number">3150653107998963723272095718</span>, <span class="number">20792548261825482531270352147</span>, <span class="number">69131192563757378564191442243</span>, <span class="number">73581103283131546986544846269</span>, <span class="number">32168289412017414311931877308</span>, <span class="number">55734763237596421172118618970</span>, <span class="number">37808961718727478136990696303</span>, <span class="number">22904874676153031620664377715</span>, <span class="number">9794575345156074603503087671</span>, <span class="number">22456694023771898844190118878</span>, <span class="number">49901970266243771395136385496</span>, <span class="number">63113371794658901555756959046</span>, <span class="number">68738124366682093927457951250</span>, <span class="number">23306235486349427954282639191</span>, <span class="number">43594485853233707551383467628</span>, <span class="number">50747180681744235554964992870</span>, <span class="number">49862479356739272497472347214</span>, <span class="number">38434690316151369964072773399</span>, <span class="number">71467050353277898958372067109</span>, <span class="number">55346669078871118497310884600</span>, <span class="number">46017420217054938248863989011</span>, <span class="number">75363033386622698885356870859</span>, <span class="number">10369764848153462639554152052</span>, <span class="number">75890142526899080264345852084</span>, <span class="number">9535759402085584783757952808</span>, <span class="number">43522044721852245514275493334</span>, <span class="number">12464589274296723227328792626</span>, <span class="number">78676543113595295732206638118</span>, <span class="number">60116759495604753189426160756</span>, <span class="number">69969854635185954403204801589</span>, <span class="number">15244509737688480815229679004</span>, <span class="number">36868877814286665666603704724</span>, <span class="number">25296352719228197917967642599</span>, <span class="number">27714369660917369969714529637</span>, <span class="number">7673110772037676634707790378</span>, <span class="number">66678444104365177982652169620</span>, <span class="number">46842636677378560041798283187</span>, <span class="number">10144943294980146082555306558</span>, <span class="number">28284306659807251586984133000</span>, <span class="number">33490472759408013029651749585</span>, <span class="number">77977414783931140205233073617</span>, <span class="number">69530485613806297267022583522</span>, <span class="number">76520003652664840680181807019</span>, <span class="number">46932273878708136776868709933</span>, <span class="number">55587849334378587663972698777</span>, <span class="number">288744469797385122841458086</span>, <span class="number">41277555669463912046072519012</span>, <span class="number">4464200409916053651301885032</span>, <span class="number">40054592246599648525169317693</span>, <span class="number">19475356311294822865721674381</span>, <span class="number">78967801470334524961687238739</span>, <span class="number">75822644069771873149506932458</span>, <span class="number">43938875242093048649223251016</span>, <span class="number">38961281929520042194905361090</span>, <span class="number">21610082723530059512385550253</span>, <span class="number">57418757224608120261793422587</span>, <span class="number">72515591359993311229453026924</span>, <span class="number">53301906528555214119355718384</span>, <span class="number">62399938403321209620318734938</span>, <span class="number">29562948809863356281824237526</span>, <span class="number">64690511731475499536620402074</span>, <span class="number">61422219087048013104282624678</span>, <span class="number">20023299367896362817857259034</span>, <span class="number">1531978217124909227300934212</span>, <span class="number">8362602216400318325888882470</span>, <span class="number">75999045381397120509496119808</span>, <span class="number">24819648371744754442222408890</span>, <span class="number">75932237139374495603284677727</span>, <span class="number">11591629473858684168400446684</span>, <span class="number">75483926784518263475169289687</span>, <span class="number">55768847294454228602227998151</span>, <span class="number">35105596201056028460562538709</span>, <span class="number">48075470868361149890782793466</span>, <span class="number">68011918805791011054681166147</span>, <span class="number">71379711286148023971490418355</span>, <span class="number">5119093941579935754141497093</span>, <span class="number">53547827525583375748301266038</span>, <span class="number">8537501347007365109158293206</span>, <span class="number">49644668676789081527660032954</span>, <span class="number">22515713345276622847996100404</span>, <span class="number">55307392324473859445909519983</span>, <span class="number">10994480124121534718832780851</span>, <span class="number">65533932078012255426667262659</span>, <span class="number">43392581419477495155490691253</span>, <span class="number">6149858215235626580350564774</span>, <span class="number">11427015895083257860925651246</span>, <span class="number">1213227811506969183950341669</span>, <span class="number">35938550903795041826608209051</span>, <span class="number">73091816395793401072374399076</span>, <span class="number">12197443447940928492569868668</span>, <span class="number">25301621853357018223709312786</span>, <span class="number">5689796934241659738266713001</span>, <span class="number">2613230292238434599188292344</span>, <span class="number">42124474617992669523056747325</span>, <span class="number">35194954579809956401055788693</span>, <span class="number">50290306214852192605264941404</span>, <span class="number">11584578367073737286597097637</span>, <span class="number">23330546567461178065917588032</span>, <span class="number">31343688234160714794757165377</span>, <span class="number">63918823993048504659024692114</span>, <span class="number">27365510636493497037417818163</span>, <span class="number">30638666912149387553328229778</span>, <span class="number">54531935194478667388418879230</span>, <span class="number">41072843969336419779445369322</span>, <span class="number">60930376536086388437175835196</span>, <span class="number">55947262970830901337865668896</span>, <span class="number">44515932960074495211895851717</span>, <span class="number">14252286294934938035868124826</span>, <span class="number">35800368864810336116694682268</span>, <span class="number">70076466250975352052336380744</span>, <span class="number">3518883683220809834826882516</span>, <span class="number">21235446402566298534375767444</span>, <span class="number">35231908696746966244552935642</span>, <span class="number">14398535620050895095986981975</span>, <span class="number">19103988715582383425140328987</span>, <span class="number">14062642498531815460021440383</span>, <span class="number">77110266168617581807736354811</span>, <span class="number">54409146707444728728561076439</span>, <span class="number">64253672045037421891482500882</span>, <span class="number">36181743183047944158650802993</span>, <span class="number">26890907171354385267615627636</span>, <span class="number">45223610791479728329076327440</span>, <span class="number">16690474955515435722262505229</span>, <span class="number">2814228033061481589868246822</span>, <span class="number">77863107456708086832326043708</span>, <span class="number">1351886029839065156773853534</span>, <span class="number">65968244564445520569592572140</span>, <span class="number">35354808513582870523085136830</span>, <span class="number">52007148783750186143061130576</span>]</span><br><span class="line"></span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> randoms:</span><br><span class="line">    a = <span class="built_in">hex</span>(i)[<span class="number">2</span>:]</span><br><span class="line">    c.append(<span class="built_in">int</span>(a[<span class="built_in">len</span>(a) // <span class="number">3</span> * <span class="number">2</span>:], <span class="number">16</span>))</span><br><span class="line">    c.append(<span class="built_in">int</span>(a[<span class="built_in">len</span>(a)//<span class="number">3</span>:<span class="built_in">len</span>(a)//<span class="number">3</span>*<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line">    c.append(<span class="built_in">int</span>(a[:<span class="built_in">len</span>(a) // <span class="number">3</span>], <span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">g = clone_mt(c)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">208</span>):</span><br><span class="line">    g.getrandbits(<span class="number">96</span>)</span><br><span class="line"></span><br><span class="line">after = g.getrandbits(<span class="number">96</span>)</span><br><span class="line"><span class="built_in">print</span>(after)</span><br><span class="line"><span class="comment"># 73177359307009435987099712513</span></span><br></pre></td></tr></table></figure>
<h3 id="回溯pre-number"><a href="#回溯pre-number" class="headerlink" title="回溯pre number"></a>回溯pre number</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_2</span>():</span><br><span class="line">    number = <span class="built_in">str</span>(random.getrandbits(<span class="number">96</span>))</span><br><span class="line">    randoms = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">627</span>):</span><br><span class="line">        randoms.append(random.getrandbits(<span class="number">32</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;randoms = &quot;</span>+<span class="built_in">str</span>(randoms))</span><br><span class="line">    guess = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess pre number:&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>这里我倒是把<code>state = backtrace([0]*4+partS)[:624]</code> 调成了<code>[1:625]</code>，不知道是啥原因结果就正确了，做题时倒是可以尝试多调试一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2 pre number</span></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"><span class="comment"># right shift inverse</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_right</span>(<span class="params">res,shift,bits=<span class="number">32</span></span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits//shift):</span><br><span class="line">        tmp = res ^ tmp &gt;&gt; shift</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># left shift with mask inverse</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_left_values</span>(<span class="params">res,shift,mask,bits=<span class="number">32</span></span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits//shift):</span><br><span class="line">        tmp = res ^ tmp &lt;&lt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backtrace</span>(<span class="params">cur</span>):</span><br><span class="line">    high = <span class="number">0x80000000</span></span><br><span class="line">    low = <span class="number">0x7fffffff</span></span><br><span class="line">    mask = <span class="number">0x9908b0df</span></span><br><span class="line">    state = cur</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        tmp = state[i+<span class="number">624</span>]^state[i+<span class="number">397</span>]</span><br><span class="line">        <span class="comment"># recover Y,tmp = Y</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        <span class="comment"># recover the highest bit</span></span><br><span class="line">        res = tmp&amp;high</span><br><span class="line">        <span class="comment"># recover other 31 bits,when i =0,it just use the method again it so beautiful!!!!</span></span><br><span class="line">        tmp = state[i-<span class="number">1</span>+<span class="number">624</span>]^state[i+<span class="number">396</span>]</span><br><span class="line">        <span class="comment"># recover Y,tmp = Y</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        res |= (tmp)&amp;low</span><br><span class="line">        state[i] = res</span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover_state</span>(<span class="params">out</span>):</span><br><span class="line">    state = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> out:</span><br><span class="line">        i = inverse_right(i,<span class="number">18</span>)</span><br><span class="line">        i = inverse_left_values(i,<span class="number">15</span>,<span class="number">0xefc60000</span>)</span><br><span class="line">        i = inverse_left_values(i,<span class="number">7</span>,<span class="number">0x9d2c5680</span>)</span><br><span class="line">        i = inverse_right(i,<span class="number">11</span>)</span><br><span class="line">        state.append(i)</span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line">randoms = [<span class="number">3131844436</span>, <span class="number">1710395493</span>, <span class="number">2040128529</span>, <span class="number">484345499</span>, <span class="number">2462793287</span>, <span class="number">3676280954</span>, <span class="number">1262783325</span>, <span class="number">2668249231</span>, <span class="number">1577554939</span>, <span class="number">1094686367</span>, <span class="number">3249775482</span>, <span class="number">2535455373</span>, <span class="number">1580873401</span>, <span class="number">3668020441</span>, <span class="number">600047797</span>, <span class="number">2368372766</span>, <span class="number">4131413888</span>, <span class="number">3881611699</span>, <span class="number">1654375267</span>, <span class="number">1363668945</span>, <span class="number">789513452</span>, <span class="number">3762247007</span>, <span class="number">953812596</span>, <span class="number">1506373208</span>, <span class="number">3472069184</span>, <span class="number">2545441793</span>, <span class="number">2826549707</span>, <span class="number">575091032</span>, <span class="number">1773264197</span>, <span class="number">192501172</span>, <span class="number">721152596</span>, <span class="number">2765035108</span>, <span class="number">1254008657</span>, <span class="number">2817100002</span>, <span class="number">3970642288</span>, <span class="number">1818378227</span>, <span class="number">1140978336</span>, <span class="number">3485195271</span>, <span class="number">386023852</span>, <span class="number">3403435021</span>, <span class="number">1144997183</span>, <span class="number">3945241205</span>, <span class="number">1211988218</span>, <span class="number">3434015373</span>, <span class="number">2046254427</span>, <span class="number">620893433</span>, <span class="number">3293410181</span>, <span class="number">3112865039</span>, <span class="number">1171882312</span>, <span class="number">1264231357</span>, <span class="number">2966804259</span>, <span class="number">43998805</span>, <span class="number">3637672398</span>, <span class="number">2681960565</span>, <span class="number">2709103871</span>, <span class="number">1456705725</span>, <span class="number">1660473171</span>, <span class="number">3820308210</span>, <span class="number">916345361</span>, <span class="number">66696421</span>, <span class="number">1234084934</span>, <span class="number">2260115865</span>, <span class="number">4103495816</span>, <span class="number">1445850634</span>, <span class="number">1688161812</span>, <span class="number">3904081009</span>, <span class="number">2933234077</span>, <span class="number">3523756803</span>, <span class="number">490871410</span>, <span class="number">2644412567</span>, <span class="number">648761244</span>, <span class="number">3530982511</span>, <span class="number">1024884722</span>, <span class="number">383286216</span>, <span class="number">2204575995</span>, <span class="number">3268537218</span>, <span class="number">2908281468</span>, <span class="number">749867101</span>, <span class="number">1077132488</span>, <span class="number">3270723079</span>, <span class="number">3585247012</span>, <span class="number">1269156557</span>, <span class="number">3096777547</span>, <span class="number">1366205746</span>, <span class="number">2642565074</span>, <span class="number">1356154486</span>, <span class="number">2371705450</span>, <span class="number">3277675427</span>, <span class="number">1949359019</span>, <span class="number">3911342223</span>, <span class="number">2302199881</span>, <span class="number">1787074024</span>, <span class="number">1176483441</span>, <span class="number">3382524643</span>, <span class="number">1726938894</span>, <span class="number">3732701826</span>, <span class="number">3873136097</span>, <span class="number">648865101</span>, <span class="number">1373666656</span>, <span class="number">1977863320</span>, <span class="number">2275109604</span>, <span class="number">1452217785</span>, <span class="number">2796416538</span>, <span class="number">4169530804</span>, <span class="number">903377449</span>, <span class="number">1230239737</span>, <span class="number">1392065473</span>, <span class="number">3204364427</span>, <span class="number">334317583</span>, <span class="number">2956184008</span>, <span class="number">2411445068</span>, <span class="number">41487849</span>, <span class="number">721765697</span>, <span class="number">1443541315</span>, <span class="number">2093099003</span>, <span class="number">893095099</span>, <span class="number">4074956390</span>, <span class="number">3098600401</span>, <span class="number">314246690</span>, <span class="number">1836298915</span>, <span class="number">651584091</span>, <span class="number">1915188462</span>, <span class="number">2767672465</span>, <span class="number">2165385064</span>, <span class="number">1519266519</span>, <span class="number">4022389379</span>, <span class="number">1728592657</span>, <span class="number">4225918363</span>, <span class="number">1086688090</span>, <span class="number">2667629859</span>, <span class="number">2236562855</span>, <span class="number">397758955</span>, <span class="number">3266197863</span>, <span class="number">1547047859</span>, <span class="number">1769483950</span>, <span class="number">1054690627</span>, <span class="number">3821081636</span>, <span class="number">4243049300</span>, <span class="number">2113976324</span>, <span class="number">3465256288</span>, <span class="number">3394237832</span>, <span class="number">1447852828</span>, <span class="number">3375689141</span>, <span class="number">3469852507</span>, <span class="number">108642640</span>, <span class="number">1417582614</span>, <span class="number">2226381889</span>, <span class="number">1108355161</span>, <span class="number">1107879584</span>, <span class="number">994843797</span>, <span class="number">3134161877</span>, <span class="number">1827259162</span>, <span class="number">2541380730</span>, <span class="number">1414991982</span>, <span class="number">66563096</span>, <span class="number">17558729</span>, <span class="number">2523246427</span>, <span class="number">2306870077</span>, <span class="number">4229357864</span>, <span class="number">1794849582</span>, <span class="number">342768726</span>, <span class="number">2537134735</span>, <span class="number">3992316097</span>, <span class="number">2390770768</span>, <span class="number">58919292</span>, <span class="number">3299454886</span>, <span class="number">47094719</span>, <span class="number">192273779</span>, <span class="number">576620652</span>, <span class="number">2653473543</span>, <span class="number">732566086</span>, <span class="number">3494470827</span>, <span class="number">375184426</span>, <span class="number">3046525929</span>, <span class="number">1917007196</span>, <span class="number">437621599</span>, <span class="number">226187925</span>, <span class="number">279460746</span>, <span class="number">2504991047</span>, <span class="number">2720647095</span>, <span class="number">1726214839</span>, <span class="number">2662580336</span>, <span class="number">310633501</span>, <span class="number">4201239133</span>, <span class="number">1411404284</span>, <span class="number">2797124852</span>, <span class="number">1009997203</span>, <span class="number">1619452767</span>, <span class="number">542751538</span>, <span class="number">2044343202</span>, <span class="number">634443864</span>, <span class="number">779388116</span>, <span class="number">1029257449</span>, <span class="number">214975482</span>, <span class="number">3625137656</span>, <span class="number">70328808</span>, <span class="number">3310617589</span>, <span class="number">1031353996</span>, <span class="number">3450854594</span>, <span class="number">679561624</span>, <span class="number">2983441457</span>, <span class="number">2349421851</span>, <span class="number">2795342193</span>, <span class="number">1652530355</span>, <span class="number">677860488</span>, <span class="number">1518458320</span>, <span class="number">3142116487</span>, <span class="number">1973355550</span>, <span class="number">3385226917</span>, <span class="number">823024989</span>, <span class="number">2787730966</span>, <span class="number">2961286907</span>, <span class="number">1903136206</span>, <span class="number">875506150</span>, <span class="number">4174650755</span>, <span class="number">3561996691</span>, <span class="number">1002531559</span>, <span class="number">4128921823</span>, <span class="number">1282902829</span>, <span class="number">1020680621</span>, <span class="number">3136992997</span>, <span class="number">1708678754</span>, <span class="number">1181634294</span>, <span class="number">3235211337</span>, <span class="number">660397562</span>, <span class="number">3060688465</span>, <span class="number">3934130449</span>, <span class="number">608548952</span>, <span class="number">1854108908</span>, <span class="number">4127434065</span>, <span class="number">1301263785</span>, <span class="number">980156946</span>, <span class="number">1702117699</span>, <span class="number">3806397832</span>, <span class="number">4159471046</span>, <span class="number">2458928134</span>, <span class="number">3866388551</span>, <span class="number">3053272844</span>, <span class="number">2378284756</span>, <span class="number">2054070916</span>, <span class="number">3825976364</span>, <span class="number">2336292623</span>, <span class="number">122801644</span>, <span class="number">3993151514</span>, <span class="number">4096144143</span>, <span class="number">3814616160</span>, <span class="number">3994433936</span>, <span class="number">3462289286</span>, <span class="number">4243017170</span>, <span class="number">3426172061</span>, <span class="number">2583801103</span>, <span class="number">212067227</span>, <span class="number">3534029236</span>, <span class="number">36875405</span>, <span class="number">4045543218</span>, <span class="number">187217458</span>, <span class="number">557973024</span>, <span class="number">444948938</span>, <span class="number">4077939216</span>, <span class="number">3268643877</span>, <span class="number">2993470198</span>, <span class="number">1493479975</span>, <span class="number">2130068040</span>, <span class="number">2299545462</span>, <span class="number">830879239</span>, <span class="number">1365763854</span>, <span class="number">478049374</span>, <span class="number">2074554524</span>, <span class="number">1821969699</span>, <span class="number">3959885144</span>, <span class="number">3646002934</span>, <span class="number">2672029263</span>, <span class="number">2753142311</span>, <span class="number">2688990434</span>, <span class="number">1863524787</span>, <span class="number">1040793750</span>, <span class="number">3125785761</span>, <span class="number">3638172148</span>, <span class="number">3540865755</span>, <span class="number">3757848958</span>, <span class="number">1414800242</span>, <span class="number">2928259859</span>, <span class="number">1861735245</span>, <span class="number">4235431182</span>, <span class="number">2862287091</span>, <span class="number">3428851640</span>, <span class="number">486857161</span>, <span class="number">1352945718</span>, <span class="number">3486730778</span>, <span class="number">883640701</span>, <span class="number">1296225663</span>, <span class="number">3655133993</span>, <span class="number">3830695918</span>, <span class="number">4200683490</span>, <span class="number">1115097527</span>, <span class="number">530632520</span>, <span class="number">2536734545</span>, <span class="number">3330209702</span>, <span class="number">692913861</span>, <span class="number">4173632848</span>, <span class="number">4182050947</span>, <span class="number">4099357993</span>, <span class="number">1992990649</span>, <span class="number">2689587606</span>, <span class="number">1397545631</span>, <span class="number">4049403842</span>, <span class="number">4198228871</span>, <span class="number">3313893404</span>, <span class="number">1356111161</span>, <span class="number">2718318666</span>, <span class="number">358872243</span>, <span class="number">1175402713</span>, <span class="number">1456360316</span>, <span class="number">1921597330</span>, <span class="number">1812196593</span>, <span class="number">1076515795</span>, <span class="number">2119895733</span>, <span class="number">3900210292</span>, <span class="number">3619512492</span>, <span class="number">2837094060</span>, <span class="number">167935</span>, <span class="number">2181313587</span>, <span class="number">2341488060</span>, <span class="number">2373964485</span>, <span class="number">952568298</span>, <span class="number">1842854296</span>, <span class="number">4045471217</span>, <span class="number">1939489272</span>, <span class="number">1473031514</span>, <span class="number">3060284468</span>, <span class="number">2661841551</span>, <span class="number">3031889599</span>, <span class="number">2907382437</span>, <span class="number">4286947591</span>, <span class="number">3584889180</span>, <span class="number">3005106221</span>, <span class="number">2727316663</span>, <span class="number">3931261841</span>, <span class="number">3490523908</span>, <span class="number">3780389181</span>, <span class="number">3743857672</span>, <span class="number">765390813</span>, <span class="number">1987225828</span>, <span class="number">2723892340</span>, <span class="number">1163275304</span>, <span class="number">3062347486</span>, <span class="number">2349224851</span>, <span class="number">787739531</span>, <span class="number">378052259</span>, <span class="number">2055505948</span>, <span class="number">3607986110</span>, <span class="number">3432516938</span>, <span class="number">1221088847</span>, <span class="number">3101819143</span>, <span class="number">3556683912</span>, <span class="number">4073221057</span>, <span class="number">577365487</span>, <span class="number">1860652081</span>, <span class="number">711563646</span>, <span class="number">1039004198</span>, <span class="number">2112807179</span>, <span class="number">809098012</span>, <span class="number">2811893098</span>, <span class="number">766665936</span>, <span class="number">2107894153</span>, <span class="number">3205397082</span>, <span class="number">1062442066</span>, <span class="number">3003811473</span>, <span class="number">2495630660</span>, <span class="number">681813468</span>, <span class="number">1247402813</span>, <span class="number">3015978207</span>, <span class="number">1908481948</span>, <span class="number">402536178</span>, <span class="number">1017534355</span>, <span class="number">3137699610</span>, <span class="number">1243214519</span>, <span class="number">2002971476</span>, <span class="number">2751738083</span>, <span class="number">4202633831</span>, <span class="number">2149611209</span>, <span class="number">2901851985</span>, <span class="number">3441366308</span>, <span class="number">1306405097</span>, <span class="number">1436920351</span>, <span class="number">3206822252</span>, <span class="number">3135875087</span>, <span class="number">3112772405</span>, <span class="number">2155012041</span>, <span class="number">4166786019</span>, <span class="number">2388412286</span>, <span class="number">3743595466</span>, <span class="number">1504277877</span>, <span class="number">2570252102</span>, <span class="number">1525324343</span>, <span class="number">3988357159</span>, <span class="number">2041485802</span>, <span class="number">3706379242</span>, <span class="number">1567644399</span>, <span class="number">3629389711</span>, <span class="number">3521760489</span>, <span class="number">2606285630</span>, <span class="number">2378614660</span>, <span class="number">2278092070</span>, <span class="number">3134112923</span>, <span class="number">1103492149</span>, <span class="number">2544530864</span>, <span class="number">1658255844</span>, <span class="number">1898801584</span>, <span class="number">904222527</span>, <span class="number">2957105662</span>, <span class="number">3389876719</span>, <span class="number">2456986124</span>, <span class="number">2695204025</span>, <span class="number">646113342</span>, <span class="number">4091650903</span>, <span class="number">2199478453</span>, <span class="number">3706005283</span>, <span class="number">612268437</span>, <span class="number">2484284336</span>, <span class="number">2662191700</span>, <span class="number">1940190622</span>, <span class="number">233733292</span>, <span class="number">4012212083</span>, <span class="number">2500822436</span>, <span class="number">541451268</span>, <span class="number">643453712</span>, <span class="number">3232122867</span>, <span class="number">3584484460</span>, <span class="number">648833258</span>, <span class="number">1768628917</span>, <span class="number">3984796041</span>, <span class="number">1411122343</span>, <span class="number">2111633947</span>, <span class="number">4054603898</span>, <span class="number">3486423013</span>, <span class="number">1936378246</span>, <span class="number">2642145436</span>, <span class="number">3750457204</span>, <span class="number">4014965456</span>, <span class="number">1555132787</span>, <span class="number">1596915262</span>, <span class="number">3543904379</span>, <span class="number">221214936</span>, <span class="number">3568886655</span>, <span class="number">509377956</span>, <span class="number">2735720233</span>, <span class="number">2280845785</span>, <span class="number">2244193115</span>, <span class="number">2491466696</span>, <span class="number">2899402863</span>, <span class="number">3409575433</span>, <span class="number">4090467960</span>, <span class="number">2298184706</span>, <span class="number">3445239101</span>, <span class="number">3543853500</span>, <span class="number">3002886346</span>, <span class="number">1957091440</span>, <span class="number">2232700177</span>, <span class="number">1214082317</span>, <span class="number">3253617000</span>, <span class="number">612662508</span>, <span class="number">1967176113</span>, <span class="number">1477788048</span>, <span class="number">2598998495</span>, <span class="number">3732580449</span>, <span class="number">3526698478</span>, <span class="number">3205961233</span>, <span class="number">1596289512</span>, <span class="number">3563960905</span>, <span class="number">701926946</span>, <span class="number">2091717748</span>, <span class="number">497084240</span>, <span class="number">1431153592</span>, <span class="number">2121887464</span>, <span class="number">2717201053</span>, <span class="number">1708163770</span>, <span class="number">2288780659</span>, <span class="number">695843074</span>, <span class="number">1804583145</span>, <span class="number">3549082991</span>, <span class="number">2132631780</span>, <span class="number">1404284920</span>, <span class="number">1812914597</span>, <span class="number">3786808737</span>, <span class="number">1238178729</span>, <span class="number">144709682</span>, <span class="number">2720425065</span>, <span class="number">2567630528</span>, <span class="number">3687426833</span>, <span class="number">921498776</span>, <span class="number">3846928815</span>, <span class="number">3992245405</span>, <span class="number">1523301292</span>, <span class="number">2975368564</span>, <span class="number">2794392842</span>, <span class="number">3915184151</span>, <span class="number">2374520221</span>, <span class="number">3570983257</span>, <span class="number">576777516</span>, <span class="number">434172278</span>, <span class="number">3432585614</span>, <span class="number">2488328901</span>, <span class="number">3502901745</span>, <span class="number">2189466832</span>, <span class="number">3258959396</span>, <span class="number">3652453078</span>, <span class="number">2646058339</span>, <span class="number">1487691505</span>, <span class="number">3489122606</span>, <span class="number">2095120777</span>, <span class="number">3444908045</span>, <span class="number">2169560914</span>, <span class="number">1142429299</span>, <span class="number">3290048052</span>, <span class="number">2989735964</span>, <span class="number">3394182052</span>, <span class="number">629348441</span>, <span class="number">3819996826</span>, <span class="number">45644271</span>, <span class="number">490572833</span>, <span class="number">497254234</span>, <span class="number">454033500</span>, <span class="number">4139957703</span>, <span class="number">1469582655</span>, <span class="number">1871913285</span>, <span class="number">3541204007</span>, <span class="number">1168363870</span>, <span class="number">887995922</span>, <span class="number">2876697335</span>, <span class="number">183207833</span>, <span class="number">3610125137</span>, <span class="number">3750324442</span>, <span class="number">1492867425</span>, <span class="number">3047407108</span>, <span class="number">3149823622</span>, <span class="number">3473939398</span>, <span class="number">3602043139</span>, <span class="number">823675959</span>, <span class="number">844582032</span>, <span class="number">3998968330</span>, <span class="number">2393470080</span>, <span class="number">2512238135</span>, <span class="number">67167808</span>, <span class="number">1611487897</span>, <span class="number">2830420861</span>, <span class="number">4112505264</span>, <span class="number">1473571356</span>, <span class="number">2312858766</span>, <span class="number">871689440</span>, <span class="number">556193926</span>, <span class="number">1001003215</span>, <span class="number">1273007741</span>, <span class="number">762017629</span>, <span class="number">2038148387</span>, <span class="number">4279168802</span>, <span class="number">2408310663</span>, <span class="number">2054122309</span>, <span class="number">42020314</span>, <span class="number">1396677628</span>, <span class="number">3773376680</span>, <span class="number">1932770810</span>, <span class="number">2471957404</span>, <span class="number">2226052083</span>, <span class="number">2029396226</span>, <span class="number">3765862340</span>, <span class="number">1050629836</span>, <span class="number">3182006232</span>, <span class="number">2413024927</span>, <span class="number">4016684643</span>, <span class="number">2024438409</span>, <span class="number">4090205995</span>, <span class="number">3597880762</span>, <span class="number">2506376035</span>, <span class="number">3927261145</span>, <span class="number">4205690402</span>, <span class="number">2307681663</span>, <span class="number">3274838512</span>, <span class="number">3523789777</span>, <span class="number">359904705</span>, <span class="number">1651827754</span>, <span class="number">3293539170</span>, <span class="number">3181510821</span>, <span class="number">1493999036</span>, <span class="number">1649777650</span>, <span class="number">4154519231</span>, <span class="number">1329665122</span>, <span class="number">90822454</span>, <span class="number">999884567</span>, <span class="number">141607911</span>, <span class="number">3884251899</span>, <span class="number">2825791367</span>, <span class="number">1739573277</span>, <span class="number">3234181642</span>, <span class="number">933041054</span>, <span class="number">186550284</span>, <span class="number">4092869914</span>, <span class="number">1043976374</span>, <span class="number">413839654</span>, <span class="number">4146441955</span>, <span class="number">2162431794</span>, <span class="number">1528203403</span>, <span class="number">3113434991</span>, <span class="number">1963838396</span>, <span class="number">1914312708</span>, <span class="number">2228058801</span>, <span class="number">1066392891</span>, <span class="number">3709434263</span>, <span class="number">3444101460</span>, <span class="number">822257454</span>, <span class="number">528906696</span>, <span class="number">2815319529</span>, <span class="number">1900590565</span>, <span class="number">1548596297</span>, <span class="number">2176062412</span>, <span class="number">2101521651</span>, <span class="number">4151077085</span>, <span class="number">2146296787</span>, <span class="number">837380469</span>, <span class="number">3104944571</span>, <span class="number">3846825052</span>, <span class="number">369339</span>, <span class="number">247134846</span>, <span class="number">3774886839</span>, <span class="number">2721198553</span>, <span class="number">3033768060</span>, <span class="number">4071240934</span>]</span><br><span class="line"></span><br><span class="line">partS = recover_state(randoms)</span><br><span class="line">state = backtrace([<span class="number">0</span>]*<span class="number">4</span>+partS)[<span class="number">1</span>:<span class="number">625</span>]</span><br><span class="line"></span><br><span class="line">prng = Random()</span><br><span class="line">prng.setstate((<span class="number">3</span>,<span class="built_in">tuple</span>(state+[<span class="number">0</span>]),<span class="literal">None</span>))</span><br><span class="line"><span class="built_in">print</span>(prng.getrandbits(<span class="number">96</span>))</span><br><span class="line"><span class="comment"># 32029162575545328566623624142</span></span><br></pre></td></tr></table></figure>
<p>此题的定位还是交互题，但由于没有复现环境，懒得搭（主要是还不会），就本地挨个测试了一下，最后也是成功输出了<code>flag</code>，不过没有写交互脚本以及统一的格式</p>
<blockquote>
<p>test：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_1</span>():</span><br><span class="line">    randoms = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">208</span>):</span><br><span class="line">        randoms.append(random.getrandbits(<span class="number">96</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;randoms = &quot;</span> + <span class="built_in">str</span>(randoms))</span><br><span class="line">    number = <span class="built_in">str</span>(random.getrandbits(<span class="number">96</span>))</span><br><span class="line">    guess = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess after number:&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_2</span>():</span><br><span class="line">    number = <span class="built_in">str</span>(random.getrandbits(<span class="number">96</span>))</span><br><span class="line">    randoms = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">627</span>):</span><br><span class="line">        randoms.append(random.getrandbits(<span class="number">32</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;randoms = &quot;</span> + <span class="built_in">str</span>(randoms))</span><br><span class="line">    guess = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess pre number:&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_3</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_int32</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(<span class="number">0xFFFFFFFF</span> &amp; x)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">init</span>(<span class="params">seed</span>):</span><br><span class="line">        mt = [<span class="number">0</span>] * <span class="number">624</span></span><br><span class="line">        mt[<span class="number">0</span>] = seed</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">624</span>):</span><br><span class="line">            mt[i] = _int32(<span class="number">1812433253</span> * (mt[i - <span class="number">1</span>] ^ mt[i - <span class="number">1</span>] &gt;&gt; <span class="number">30</span>) + i)</span><br><span class="line">        <span class="keyword">return</span> mt[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    number = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;last number = &quot;</span> + <span class="built_in">str</span>(init(number)))</span><br><span class="line">    guess = <span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess seed number:&quot;</span>)))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_4</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_number</span>(<span class="params">y</span>):</span><br><span class="line">        y = y ^ y &gt;&gt; <span class="number">11</span></span><br><span class="line">        y = y ^ y &lt;&lt; <span class="number">7</span> &amp; <span class="number">2636928640</span></span><br><span class="line">        y = y ^ y &lt;&lt; <span class="number">15</span> &amp; <span class="number">4022730752</span></span><br><span class="line">        y = y ^ y &gt;&gt; <span class="number">18</span></span><br><span class="line">        <span class="keyword">return</span> y &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">    number = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;extract number = &quot;</span> + <span class="built_in">str</span>(extract_number(number)))</span><br><span class="line">    guess = <span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess be extracted number:&quot;</span>)))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the Mersenne Twister basic challenge. Please try to solve 20 challenges in 60 seconds.&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Round: &quot;</span> + <span class="built_in">str</span>(i + <span class="number">1</span>))</span><br><span class="line">    random.choice([guess_number_1, guess_number_2, guess_number_3, guess_number_4])()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Good job!&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>).read()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Congratulations on passing the challenge. This is your flag: &quot;</span> + <span class="built_in">str</span>(flag))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<p>前面说到预测和回溯都稍微会遇到一点问题，所以总是会有大佬站出来，上传了有很多相关的<code>python</code>库，我这里选择的是 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL05vbnVwbGVCcm9rZW4vRXh0ZW5kTVQxOTkzN1ByZWRpY3Rvcg==">ExtendMT19937Predictor<i class="fa fa-external-link-alt"></i></span></p>
<p>可以根据<strong><code>Predict</code></strong>、<strong><code>Backtrack</code></strong>的使用示例来进行预测和回溯，如下是exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">attack1</span>(<span class="params">list1</span>):</span><br><span class="line">    predictor = ExtendMT19937Predictor()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">208</span>):</span><br><span class="line">        predictor.setrandbits(list1[i], <span class="number">96</span>)    <span class="comment"># 是将已有的随机数填入，从而预测或回溯随机数</span></span><br><span class="line">    <span class="keyword">return</span> predictor.predict_getrandbits(<span class="number">96</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack2</span>(<span class="params">list1</span>):</span><br><span class="line">    predictor = ExtendMT19937Predictor()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">627</span>):</span><br><span class="line">        predictor.setrandbits(list1[i], <span class="number">32</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">627</span>):</span><br><span class="line">        predictor.backtrack_getrandbits(<span class="number">32</span>)</span><br><span class="line">    x = predictor.backtrack_getrandbits(<span class="number">96</span>)</span><br><span class="line">    <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure>
<h2 id="NKCTF2023-fake-MT"><a href="#NKCTF2023-fake-MT" class="headerlink" title="[NKCTF2023]fake_MT"></a>[NKCTF2023]fake_MT</h2><p>题目源码不说和<code>real_MT</code>长得像，简直是一模一样，一说这题是<code>python2</code>的环境</p>
<p>题解如上，和<code>real_MT</code>一样</p>
<hr>
<hr>
<h2 id="补充："><a href="#补充：" class="headerlink" title="补充："></a>补充：</h2><blockquote>
<p>2024-7-18</p>
</blockquote>
<p>一直被忽略的第五个题型，这里面的扩展题型里，低于32字节的MT19937，例题给的是高位的 1 bit</p>
<h2 id="easy-random"><a href="#easy-random" class="headerlink" title="easy_random"></a>easy_random</h2><blockquote>
<p>WKCTF 2024</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;WKCTF&#123;&#125;&#x27;</span></span><br><span class="line">pad_flag = pad(flag,<span class="number">16</span>)</span><br><span class="line">key = random.randbytes(<span class="number">16</span>)</span><br><span class="line">cipher = AES.new(key,AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(cipher.encrypt(pad_flag))</span><br><span class="line"><span class="comment"># b&#x27;a\x93\xdc\xc3\x90\x0cK\xfa\xfb\x1c\x05$y\x16:\xfc\xf3+\xf8+%\xfe\xf9\x86\xa3\x17i+ab\xca\xb6\xcd\r\xa5\x94\xeaVM\xdeo\xa7\xdf\xa9D\n\x02\xa3&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;random.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2496</span>):</span><br><span class="line">        f.write(<span class="built_in">str</span>(random.getrandbits(<span class="number">8</span>))+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>（附件就不给了，可以自己生成测试）</p>
<hr>
<p>上面讲了 32bit 以上的随机数是拼接而来的，而32bit 以下则不行，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">random.seed(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(random.getrandbits(<span class="number">8</span>)))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(random.getrandbits(<span class="number">8</span>)))</span><br><span class="line"></span><br><span class="line">random.seed(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(random.getrandbits(<span class="number">32</span>)))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(random.getrandbits(<span class="number">32</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x22</span></span><br><span class="line"><span class="comment"># 0x91</span></span><br><span class="line"><span class="comment"># 0x2265b1f5</span></span><br><span class="line"><span class="comment"># 0x91b7584a</span></span><br><span class="line"><span class="comment"># 22464</span></span><br><span class="line"></span><br><span class="line">random.seed(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(random.getrandbits(<span class="number">16</span>)))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(random.getrandbits(<span class="number">16</span>)))</span><br><span class="line"></span><br><span class="line">random.seed(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(random.getrandbits(<span class="number">32</span>)))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(random.getrandbits(<span class="number">32</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x2265</span></span><br><span class="line"><span class="comment"># 0x91b7</span></span><br><span class="line"><span class="comment"># 0x2265b1f5</span></span><br><span class="line"><span class="comment"># 0x91b7584a</span></span><br></pre></td></tr></table></figure>
<p>按顺序来讲，得到的每一个 8bit 是对应 32bit 的前八位，如何得来？也就是先生成 一个32bit的，再右移24bit，得到 8 bit</p>
<p>所以32 bit 以下的随机数不能进行拼接</p>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">random.seed(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(random.randbytes(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(random.randbytes(<span class="number">4</span>))</span><br><span class="line">random.seed(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(random.randbytes(<span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">random.seed(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bytes_to_long(random.randbytes(<span class="number">8</span>)))[<span class="number">2</span>:])</span><br><span class="line">random.seed(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(random.getrandbits(<span class="number">64</span>))[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">random.seed(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(random.getrandbits(<span class="number">32</span>)))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(random.getrandbits(<span class="number">32</span>)))</span><br><span class="line">random.seed(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(random.getrandbits(<span class="number">64</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;\xf5\xb1e&quot;&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;JX\xb7\x91&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;\xf5\xb1e&quot;JX\xb7\x91&#x27;</span></span><br><span class="line"><span class="comment"># f5b165224a58b791</span></span><br><span class="line"><span class="comment"># 91b7584a2265b1f5</span></span><br><span class="line"><span class="comment"># b&#x27;&quot;e\xb1\xf5&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;\x91\xb7XJ&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;\x91\xb7XJ&quot;e\xb1\xf5&#x27;</span></span><br></pre></td></tr></table></figure>
<p>可以看到 生成随机字节 和随机数的拼接方式不一样，</p>
<p>后者后面生成的随机数在高位，先生成的随机数在低位</p>
<p>前者则相反，</p>
<p>所以按照上面我们的拼接方法再逆序即可得到 key</p>
<p>或者看到 生成的 4字节和 32 bit 的关系是逆序的，这种低字节在高位的情况称为 <font color='orange'>小端序</font> ，也可这样处理 key</p>
<hr>
<h3 id="题解：-1"><a href="#题解：-1" class="headerlink" title="题解："></a>题解：</h3><p>通过 <code>badmonkey</code> 佬的方法，黑盒测试，在<code>GF(2)</code>上，有</p>
<p>$X·T = Z\Longrightarrow X=Z·T^{-1}$ </p>
<p>其中X,Z为1 x 19968 的向量，T为19968 x 19968 的矩阵</p>
<p>我们可以令 X = (1,0,0…,0)，此时得到 Z 的结果 为 T 的第一行，再令 X = (0,1,0…,0)，以此类推得到全部 T</p>
<p><strong>我们需要注意的是</strong>，文中说明了我们构造的T不是满秩的，求出的第一个32bit的随机数不够准确，我们还需要去还原第一个state，再来进行预测得到完整的32bit随机数</p>
<p>exp：</p>
<p>例题是 1 bit 的，这里是 8 bit 的，据此微改脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line">prng = Random()</span><br><span class="line">length = <span class="number">19968</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">myState</span>():</span><br><span class="line">    state = [<span class="number">0</span>]*<span class="number">624</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i&lt;length:</span><br><span class="line">        ind = i//<span class="number">32</span></span><br><span class="line">        expont = i%<span class="number">32</span></span><br><span class="line">        state[ind] = <span class="number">1</span>&lt;&lt;(<span class="number">31</span>-expont)</span><br><span class="line">        s = (<span class="number">3</span>,<span class="built_in">tuple</span>(state+[<span class="number">0</span>]),<span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">yield</span> s</span><br><span class="line">        state[ind] = <span class="number">0</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getRow</span>():</span><br><span class="line">    rng = Random()</span><br><span class="line">    gs = myState()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        s = <span class="built_in">next</span>(gs)</span><br><span class="line">        rng.setstate(s)</span><br><span class="line"><span class="comment">#         print(s[1][0])</span></span><br><span class="line">        data=[]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length // <span class="number">8</span>):</span><br><span class="line">            data.extend(<span class="built_in">list</span>(<span class="built_in">bin</span>(rng.getrandbits(<span class="number">8</span>))[<span class="number">2</span>:].zfill(<span class="number">8</span>)))</span><br><span class="line">        data=[<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> data] <span class="comment"># 只有1行，还是length长度</span></span><br><span class="line">        row = vector(GF(<span class="number">2</span>),data)</span><br><span class="line">        <span class="keyword">yield</span> row</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">buildBox</span>():</span><br><span class="line">    b = matrix(GF(<span class="number">2</span>),length,length)</span><br><span class="line">    rg = getRow()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(length)):</span><br><span class="line">        b[i] = <span class="built_in">next</span>(rg)</span><br><span class="line">    <span class="keyword">return</span> b <span class="comment"># length * length</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># X = Z*(T^-1)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recoverState</span>(<span class="params">T,leak</span>):</span><br><span class="line">    x = T.solve_left(leak)</span><br><span class="line">    x = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> x.<span class="built_in">list</span>()])</span><br><span class="line">    state = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        tmp = <span class="built_in">int</span>(x[i * <span class="number">32</span>:(i + <span class="number">1</span>) * <span class="number">32</span>], <span class="number">2</span>)</span><br><span class="line">        state.append(tmp)</span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据题型2,还原state,有两种可能,这时候可以用暴破</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backfirst</span>(<span class="params">state</span>):</span><br><span class="line">    high = <span class="number">0x80000000</span></span><br><span class="line">    low = <span class="number">0x7fffffff</span></span><br><span class="line">    mask = <span class="number">0x9908b0df</span></span><br><span class="line">    tmp = state[<span class="number">623</span>] ^ state[<span class="number">396</span>]</span><br><span class="line">    <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">        tmp ^= mask</span><br><span class="line">        tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">        tmp |= <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="number">1</span> &lt;&lt; <span class="number">32</span> - <span class="number">1</span>) | tmp &amp; low, tmp &amp; low</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">readrandom</span>():</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;random.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> f.read().split():</span><br><span class="line">            c.append(<span class="built_in">int</span>(i))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pwn</span>(<span class="params">leak,state,guess1,guess2</span>):</span><br><span class="line">    prng = Random()</span><br><span class="line">    originState = prng.getstate()</span><br><span class="line">    state[<span class="number">0</span>] = guess1</span><br><span class="line">    s = state</span><br><span class="line">    prng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(s + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;first&quot;</span>)</span><br><span class="line">        prng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(s + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">        now =  [prng.getrandbits(<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2496</span>)]</span><br><span class="line">        <span class="keyword">if</span> now == leak:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;true&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(state)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    state[<span class="number">0</span>] = guess2</span><br><span class="line">    s = state</span><br><span class="line">    prng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(s + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;second&quot;</span>)</span><br><span class="line">        prng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(s + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">        now =  [prng.getrandbits(<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2496</span>)]</span><br><span class="line">        <span class="keyword">if</span> now == leak:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;true&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(state)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    T = buildBox()</span><br><span class="line"></span><br><span class="line">    leak = readrandom()</span><br><span class="line">    leak1=[<span class="built_in">int</span>(j) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">&quot;&quot;</span>.join([<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> leak[:<span class="number">19968</span>//<span class="number">8</span>]])]</span><br><span class="line">    leak1 = matrix(GF(<span class="number">2</span>), leak1)</span><br><span class="line">    <span class="comment"># 恢复state</span></span><br><span class="line">    state = recoverState(T,leak1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;state恢复完成&quot;</span>)</span><br><span class="line">    <span class="comment"># 两种可能</span></span><br><span class="line">    guess1, guess2 = backfirst(state)</span><br><span class="line">    <span class="built_in">print</span>(guess1, guess2)</span><br><span class="line">    pwn(leak,state,guess1,guess2)</span><br><span class="line">    </span><br><span class="line">main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>我们用这个得到 state去 还原题目当时的 state（seed？😅），进行预测 624个32bit的随机数用以回溯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> extend_mt19937_predictor <span class="keyword">import</span> ExtendMT19937Predictor</span><br><span class="line"></span><br><span class="line">prng = Random()</span><br><span class="line">state = [<span class="number">2922114156</span>, <span class="number">2886276701</span>, <span class="number">1168768544</span>, <span class="number">2339187170</span>, <span class="number">3551087255</span>, <span class="number">117510054</span>, <span class="number">4232565172</span>, <span class="number">1076139110</span>, <span class="number">3366831833</span>, <span class="number">1734453078</span>, <span class="number">4105913658</span>, <span class="number">1066792668</span>, <span class="number">2395352043</span>, <span class="number">785096749</span>, <span class="number">3707690263</span>, <span class="number">2430171307</span>, <span class="number">2064716469</span>, <span class="number">1119720065</span>, <span class="number">1112222395</span>, <span class="number">2136656989</span>, <span class="number">2232844740</span>, <span class="number">388978998</span>, <span class="number">1363102788</span>, <span class="number">67899517</span>, <span class="number">457789137</span>, <span class="number">3527002829</span>, <span class="number">1187847099</span>, <span class="number">1188611575</span>, <span class="number">3830294635</span>, <span class="number">3760337941</span>, <span class="number">297081839</span>, <span class="number">3230408812</span>, <span class="number">2906355860</span>, <span class="number">279725084</span>, <span class="number">3056220997</span>, <span class="number">1053068885</span>, <span class="number">3252084646</span>, <span class="number">2818726015</span>, <span class="number">3615795115</span>, <span class="number">2751222655</span>, <span class="number">74688614</span>, <span class="number">1452880497</span>, <span class="number">426221319</span>, <span class="number">1680367484</span>, <span class="number">4211465923</span>, <span class="number">908441837</span>, <span class="number">2290937869</span>, <span class="number">526329269</span>, <span class="number">3225608663</span>, <span class="number">350552485</span>, <span class="number">885538125</span>, <span class="number">3496826412</span>, <span class="number">3347875222</span>, <span class="number">2730243675</span>, <span class="number">1823616219</span>, <span class="number">1474037291</span>, <span class="number">2474670592</span>, <span class="number">1175091387</span>, <span class="number">1527449390</span>, <span class="number">2024565653</span>, <span class="number">2185945759</span>, <span class="number">902338428</span>, <span class="number">3571876882</span>, <span class="number">632524934</span>, <span class="number">1235569406</span>, <span class="number">3612682285</span>, <span class="number">2727233684</span>, <span class="number">2085380963</span>, <span class="number">1570339017</span>, <span class="number">3839696585</span>, <span class="number">1482742582</span>, <span class="number">646051896</span>, <span class="number">3804319832</span>, <span class="number">2113555238</span>, <span class="number">4150326517</span>, <span class="number">2606046640</span>, <span class="number">1454130831</span>, <span class="number">1919843931</span>, <span class="number">1018624146</span>, <span class="number">1956310311</span>, <span class="number">1162868231</span>, <span class="number">1118548906</span>, <span class="number">974692065</span>, <span class="number">3020424226</span>, <span class="number">2996838388</span>, <span class="number">1724936385</span>, <span class="number">1668410782</span>, <span class="number">3044755338</span>, <span class="number">3710133971</span>, <span class="number">1043581839</span>, <span class="number">362583150</span>, <span class="number">3880481779</span>, <span class="number">114234888</span>, <span class="number">1724135673</span>, <span class="number">1280834309</span>, <span class="number">2958310395</span>, <span class="number">3502226151</span>, <span class="number">620064160</span>, <span class="number">3244210820</span>, <span class="number">3839287479</span>, <span class="number">2283659292</span>, <span class="number">405764632</span>, <span class="number">29535149</span>, <span class="number">2759062778</span>, <span class="number">1662916252</span>, <span class="number">2374319319</span>, <span class="number">3359789079</span>, <span class="number">1896011543</span>, <span class="number">1991740933</span>, <span class="number">2041947596</span>, <span class="number">3393060496</span>, <span class="number">996086198</span>, <span class="number">193135800</span>, <span class="number">1184463268</span>, <span class="number">819767446</span>, <span class="number">410330102</span>, <span class="number">569788256</span>, <span class="number">3880255000</span>, <span class="number">340523190</span>, <span class="number">885031563</span>, <span class="number">2752345656</span>, <span class="number">4116368372</span>, <span class="number">1738848623</span>, <span class="number">1895472503</span>, <span class="number">85502529</span>, <span class="number">334873925</span>, <span class="number">3543996685</span>, <span class="number">3082948803</span>, <span class="number">3195880838</span>, <span class="number">1458851187</span>, <span class="number">2843458392</span>, <span class="number">20236078</span>, <span class="number">3136689072</span>, <span class="number">2121777470</span>, <span class="number">3543587943</span>, <span class="number">3590933177</span>, <span class="number">4057799526</span>, <span class="number">1241162800</span>, <span class="number">1014541188</span>, <span class="number">1031410742</span>, <span class="number">267989518</span>, <span class="number">92604561</span>, <span class="number">2190353015</span>, <span class="number">87786611</span>, <span class="number">435741463</span>, <span class="number">3800398555</span>, <span class="number">1860727248</span>, <span class="number">2608606593</span>, <span class="number">287619193</span>, <span class="number">768990059</span>, <span class="number">1686137462</span>, <span class="number">3255556540</span>, <span class="number">3234299857</span>, <span class="number">2087562050</span>, <span class="number">1575350832</span>, <span class="number">1982640551</span>, <span class="number">1476745138</span>, <span class="number">2757668599</span>, <span class="number">108958643</span>, <span class="number">337813164</span>, <span class="number">273001595</span>, <span class="number">3515727084</span>, <span class="number">2976758889</span>, <span class="number">2674818924</span>, <span class="number">2133197017</span>, <span class="number">3709052669</span>, <span class="number">1992118633</span>, <span class="number">2421927781</span>, <span class="number">174599786</span>, <span class="number">3608298365</span>, <span class="number">1708985493</span>, <span class="number">3925831183</span>, <span class="number">3063611093</span>, <span class="number">3852984733</span>, <span class="number">540242111</span>, <span class="number">1623482619</span>, <span class="number">1874921843</span>, <span class="number">1317809124</span>, <span class="number">2774735715</span>, <span class="number">3828180102</span>, <span class="number">1997343223</span>, <span class="number">1516869708</span>, <span class="number">941992323</span>, <span class="number">307089973</span>, <span class="number">368181535</span>, <span class="number">163007409</span>, <span class="number">596938343</span>, <span class="number">1686397275</span>, <span class="number">52708329</span>, <span class="number">230996593</span>, <span class="number">3597201983</span>, <span class="number">378926364</span>, <span class="number">3618422671</span>, <span class="number">2062721049</span>, <span class="number">3659976071</span>, <span class="number">546629459</span>, <span class="number">3976307656</span>, <span class="number">1509609055</span>, <span class="number">3677736141</span>, <span class="number">1613243397</span>, <span class="number">1378877471</span>, <span class="number">531534610</span>, <span class="number">2602178644</span>, <span class="number">4099876535</span>, <span class="number">1394187732</span>, <span class="number">1706260244</span>, <span class="number">1842911215</span>, <span class="number">3381571710</span>, <span class="number">456693813</span>, <span class="number">1667668257</span>, <span class="number">792813840</span>, <span class="number">4044011316</span>, <span class="number">1391972141</span>, <span class="number">1677638507</span>, <span class="number">1467741933</span>, <span class="number">2542725716</span>, <span class="number">3261642613</span>, <span class="number">1122181516</span>, <span class="number">1726857655</span>, <span class="number">2765884383</span>, <span class="number">2563231823</span>, <span class="number">1890137479</span>, <span class="number">3462591813</span>, <span class="number">290505918</span>, <span class="number">3480784421</span>, <span class="number">4146013364</span>, <span class="number">906268950</span>, <span class="number">1460571462</span>, <span class="number">625398701</span>, <span class="number">1868955581</span>, <span class="number">2562420879</span>, <span class="number">3524561573</span>, <span class="number">2480663847</span>, <span class="number">424010572</span>, <span class="number">3760440358</span>, <span class="number">506451740</span>, <span class="number">2616205788</span>, <span class="number">3835513223</span>, <span class="number">2698078113</span>, <span class="number">933669512</span>, <span class="number">2259175222</span>, <span class="number">1766445936</span>, <span class="number">3062774434</span>, <span class="number">3383207496</span>, <span class="number">165724374</span>, <span class="number">717679250</span>, <span class="number">872303977</span>, <span class="number">1054921507</span>, <span class="number">1640987195</span>, <span class="number">2398705310</span>, <span class="number">744526846</span>, <span class="number">2142916476</span>, <span class="number">3769314780</span>, <span class="number">3643489144</span>, <span class="number">906983325</span>, <span class="number">1001096018</span>, <span class="number">1522376663</span>, <span class="number">3516789445</span>, <span class="number">425379249</span>, <span class="number">1807654888</span>, <span class="number">1584889396</span>, <span class="number">996500676</span>, <span class="number">2138028000</span>, <span class="number">1877118731</span>, <span class="number">2780715755</span>, <span class="number">56317932</span>, <span class="number">994780643</span>, <span class="number">231703463</span>, <span class="number">1590924826</span>, <span class="number">449553992</span>, <span class="number">1970334362</span>, <span class="number">3631415563</span>, <span class="number">2378887069</span>, <span class="number">2645995105</span>, <span class="number">604040985</span>, <span class="number">766274135</span>, <span class="number">2897107084</span>, <span class="number">3122401328</span>, <span class="number">604584226</span>, <span class="number">3514594183</span>, <span class="number">3159592392</span>, <span class="number">539086862</span>, <span class="number">1966827756</span>, <span class="number">1548312674</span>, <span class="number">2223920152</span>, <span class="number">4193868755</span>, <span class="number">2604831097</span>, <span class="number">2301554299</span>, <span class="number">2919432501</span>, <span class="number">3445772747</span>, <span class="number">221908018</span>, <span class="number">1919849944</span>, <span class="number">1707243688</span>, <span class="number">1311680342</span>, <span class="number">1132835813</span>, <span class="number">824121832</span>, <span class="number">2623654824</span>, <span class="number">4245764621</span>, <span class="number">1669541543</span>, <span class="number">793028119</span>, <span class="number">1400611299</span>, <span class="number">2330555992</span>, <span class="number">1295319061</span>, <span class="number">2376883177</span>, <span class="number">3054784982</span>, <span class="number">1534527889</span>, <span class="number">3381065612</span>, <span class="number">431181624</span>, <span class="number">2520679460</span>, <span class="number">1612115175</span>, <span class="number">3417053178</span>, <span class="number">3202101207</span>, <span class="number">4112825474</span>, <span class="number">209873225</span>, <span class="number">3982289256</span>, <span class="number">3175605361</span>, <span class="number">1007754107</span>, <span class="number">1533969733</span>, <span class="number">3657972615</span>, <span class="number">1233249703</span>, <span class="number">1775877579</span>, <span class="number">2812100730</span>, <span class="number">3215107528</span>, <span class="number">1781386145</span>, <span class="number">3025989255</span>, <span class="number">3066346118</span>, <span class="number">3283795978</span>, <span class="number">1197222174</span>, <span class="number">2936543382</span>, <span class="number">3503535134</span>, <span class="number">2892598771</span>, <span class="number">2621962168</span>, <span class="number">931511531</span>, <span class="number">2231087188</span>, <span class="number">4146539078</span>, <span class="number">4002087507</span>, <span class="number">2491835423</span>, <span class="number">4060649251</span>, <span class="number">4048333160</span>, <span class="number">2444738719</span>, <span class="number">2691519303</span>, <span class="number">1556526141</span>, <span class="number">3615497232</span>, <span class="number">4050826531</span>, <span class="number">500299044</span>, <span class="number">717467546</span>, <span class="number">2206683369</span>, <span class="number">861398548</span>, <span class="number">3151369905</span>, <span class="number">4029791836</span>, <span class="number">3416545629</span>, <span class="number">4120104600</span>, <span class="number">1465267912</span>, <span class="number">483234533</span>, <span class="number">3035820989</span>, <span class="number">3832933168</span>, <span class="number">3568690105</span>, <span class="number">96174302</span>, <span class="number">2545526712</span>, <span class="number">1102861924</span>, <span class="number">1074783639</span>, <span class="number">4182941480</span>, <span class="number">1533353222</span>, <span class="number">1488829617</span>, <span class="number">1503690984</span>, <span class="number">185887778</span>, <span class="number">4211993208</span>, <span class="number">2290188486</span>, <span class="number">1146083769</span>, <span class="number">2041769341</span>, <span class="number">2684027677</span>, <span class="number">3176900642</span>, <span class="number">1387338494</span>, <span class="number">946259368</span>, <span class="number">1066487432</span>, <span class="number">795876682</span>, <span class="number">3861793354</span>, <span class="number">1668825820</span>, <span class="number">216618949</span>, <span class="number">2896083408</span>, <span class="number">3851619025</span>, <span class="number">442276681</span>, <span class="number">206355214</span>, <span class="number">270139248</span>, <span class="number">347366931</span>, <span class="number">1910792165</span>, <span class="number">3953458832</span>, <span class="number">2734158556</span>, <span class="number">2811136264</span>, <span class="number">1920172269</span>, <span class="number">1837836373</span>, <span class="number">3778467275</span>, <span class="number">3779230355</span>, <span class="number">3897121172</span>, <span class="number">2344011383</span>, <span class="number">1146522764</span>, <span class="number">2190434845</span>, <span class="number">609244986</span>, <span class="number">2013714652</span>, <span class="number">560173192</span>, <span class="number">2402932255</span>, <span class="number">1072869170</span>, <span class="number">1770725561</span>, <span class="number">952360909</span>, <span class="number">1412825165</span>, <span class="number">3696544236</span>, <span class="number">2306376326</span>, <span class="number">2830983153</span>, <span class="number">207976619</span>, <span class="number">4155556879</span>, <span class="number">3728896627</span>, <span class="number">2654370117</span>, <span class="number">3334033001</span>, <span class="number">1365410137</span>, <span class="number">1493856098</span>, <span class="number">1253593280</span>, <span class="number">1631830970</span>, <span class="number">5803336</span>, <span class="number">3918597809</span>, <span class="number">86127041</span>, <span class="number">333464839</span>, <span class="number">3604499396</span>, <span class="number">149662371</span>, <span class="number">2129288705</span>, <span class="number">1461710188</span>, <span class="number">3760680120</span>, <span class="number">3729872359</span>, <span class="number">2100765881</span>, <span class="number">3535556758</span>, <span class="number">444301423</span>, <span class="number">2716178967</span>, <span class="number">1126522126</span>, <span class="number">4087265377</span>, <span class="number">129975151</span>, <span class="number">3676574817</span>, <span class="number">946781552</span>, <span class="number">1144144314</span>, <span class="number">4160587561</span>, <span class="number">3992786314</span>, <span class="number">45372372</span>, <span class="number">2839307265</span>, <span class="number">3121990915</span>, <span class="number">2417091275</span>, <span class="number">2394722122</span>, <span class="number">2336989436</span>, <span class="number">3126674182</span>, <span class="number">3231554964</span>, <span class="number">3785353831</span>, <span class="number">3066121066</span>, <span class="number">4059908701</span>, <span class="number">3257600631</span>, <span class="number">3304564137</span>, <span class="number">976977941</span>, <span class="number">2994176851</span>, <span class="number">3509885563</span>, <span class="number">436168092</span>, <span class="number">2194926470</span>, <span class="number">572263581</span>, <span class="number">2964578564</span>, <span class="number">2577729800</span>, <span class="number">4257414592</span>, <span class="number">1074783671</span>, <span class="number">2629434251</span>, <span class="number">42822614</span>, <span class="number">1475322010</span>, <span class="number">3068645543</span>, <span class="number">3694724738</span>, <span class="number">3480058324</span>, <span class="number">4204711804</span>, <span class="number">3168448984</span>, <span class="number">2767935672</span>, <span class="number">3016152818</span>, <span class="number">4134435775</span>, <span class="number">2141315517</span>, <span class="number">2182008981</span>, <span class="number">2871864678</span>, <span class="number">2294299758</span>, <span class="number">1409773258</span>, <span class="number">3418660825</span>, <span class="number">3090287076</span>, <span class="number">3241139267</span>, <span class="number">2315623533</span>, <span class="number">2157788904</span>, <span class="number">334169841</span>, <span class="number">2062298350</span>, <span class="number">4075844652</span>, <span class="number">1672438569</span>, <span class="number">2994084656</span>, <span class="number">2204498767</span>, <span class="number">2430183901</span>, <span class="number">4179388667</span>, <span class="number">317027997</span>, <span class="number">2894184457</span>, <span class="number">3635887387</span>, <span class="number">1307832846</span>, <span class="number">3358657065</span>, <span class="number">734371454</span>, <span class="number">610520453</span>, <span class="number">3421706671</span>, <span class="number">3240587498</span>, <span class="number">3690351924</span>, <span class="number">935152653</span>, <span class="number">2737123774</span>, <span class="number">203357945</span>, <span class="number">1027962332</span>, <span class="number">3777141639</span>, <span class="number">743025036</span>, <span class="number">4046422672</span>, <span class="number">1085389282</span>, <span class="number">110265143</span>, <span class="number">320421926</span>, <span class="number">1931570193</span>, <span class="number">936595461</span>, <span class="number">2927488848</span>, <span class="number">2265674314</span>, <span class="number">3444945553</span>, <span class="number">786566925</span>, <span class="number">4133145648</span>, <span class="number">2879270131</span>, <span class="number">4165751769</span>, <span class="number">3985446237</span>, <span class="number">1971125873</span>, <span class="number">3724681025</span>, <span class="number">2661325531</span>, <span class="number">2441664181</span>, <span class="number">3290805620</span>, <span class="number">2459158763</span>, <span class="number">2102811157</span>, <span class="number">2881160687</span>, <span class="number">1153639082</span>, <span class="number">827213914</span>, <span class="number">3028527431</span>, <span class="number">2205345684</span>, <span class="number">3556675715</span>, <span class="number">1279123065</span>, <span class="number">4253124398</span>, <span class="number">3483559979</span>, <span class="number">4068430995</span>, <span class="number">4141206587</span>, <span class="number">2571521727</span>, <span class="number">2944439402</span>, <span class="number">443124686</span>, <span class="number">2268164570</span>, <span class="number">2235451426</span>, <span class="number">3679071975</span>, <span class="number">3129207272</span>, <span class="number">2516367556</span>, <span class="number">1468462786</span>, <span class="number">1881517367</span>, <span class="number">3491042253</span>, <span class="number">2913831047</span>, <span class="number">3164481275</span>, <span class="number">202602034</span>, <span class="number">3150723817</span>, <span class="number">1533130707</span>, <span class="number">1912730441</span>, <span class="number">2090267514</span>, <span class="number">3558123575</span>, <span class="number">1133228007</span>, <span class="number">3421482977</span>, <span class="number">2553693497</span>, <span class="number">3421969717</span>, <span class="number">2520271965</span>, <span class="number">2067324870</span>, <span class="number">1223636150</span>, <span class="number">2714495378</span>, <span class="number">3773685424</span>, <span class="number">2961634881</span>, <span class="number">88882886</span>, <span class="number">408668635</span>, <span class="number">904339271</span>, <span class="number">3187997208</span>, <span class="number">2883270961</span>, <span class="number">1911371885</span>, <span class="number">1111177434</span>, <span class="number">3677904221</span>, <span class="number">1424566197</span>, <span class="number">456428662</span>, <span class="number">3160502725</span>, <span class="number">2571618126</span>, <span class="number">1931038165</span>, <span class="number">1229862345</span>, <span class="number">885692642</span>, <span class="number">928907436</span>, <span class="number">281108918</span>, <span class="number">2025639202</span>, <span class="number">4098934983</span>, <span class="number">245166619</span>, <span class="number">3978368942</span>, <span class="number">2335134348</span>, <span class="number">2663736265</span>, <span class="number">3483476476</span>, <span class="number">1019177183</span>, <span class="number">1076843627</span>, <span class="number">2150626843</span>, <span class="number">3549898506</span>, <span class="number">497411044</span>, <span class="number">2948681730</span>, <span class="number">1293862520</span>, <span class="number">3364439483</span>, <span class="number">200913955</span>, <span class="number">876046583</span>, <span class="number">2810673955</span>, <span class="number">2828391839</span>, <span class="number">1905062360</span>, <span class="number">3783182365</span>, <span class="number">2472665728</span>, <span class="number">1439731349</span>, <span class="number">2736703148</span>, <span class="number">3316496080</span>, <span class="number">2996051367</span>, <span class="number">448455111</span>, <span class="number">3808598160</span>, <span class="number">2313472828</span>, <span class="number">1619655346</span>, <span class="number">1198200314</span>, <span class="number">3744504057</span>, <span class="number">1680713197</span>, <span class="number">2474661491</span>, <span class="number">3214410863</span>, <span class="number">1662774943</span>, <span class="number">3537885099</span>, <span class="number">3365412658</span>, <span class="number">3583677483</span>]</span><br><span class="line"></span><br><span class="line">prng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(state + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">D = [prng.getrandbits(<span class="number">32</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>)]</span><br><span class="line"><span class="built_in">print</span>(D)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[3086615663, 3771906507, 1933791567, 874400704, 4000928288, 1101512046, 3757205682, 895930285, 2975657910, 1590250704, 227397937, 3163700038, 1702493296, 86408336, 1317214060, 355017934, 4281601498, 2958424486, 3248821687, 1977038961, 75767861, 1848107476, 1201089736, 1669521311, 3079560731, 753259725, 2783047520, 1792692953, 1335325755, 4118154638, 221587457, 3931660158, 2105971738, 205787269, 3306213190, 3047766446, 757659831, 70863674, 2054184739, 418281550, 2654142751, 3195128907, 3920550815, 273337573, 856860348, 2332777112, 1144893468, 4097373151, 2348453877, 3391728911, 1909111864, 1167657184, 1690201897, 3037596190, 2683689827, 2591985588, 483396539, 583852871, 4213595783, 3297463098, 3940471284, 3167491933, 3836764654, 385184073, 4089593895, 2435556034, 2689611721, 3009515703, 2557788155, 742759035, 2911234764, 2747466359, 1658388676, 77325257, 1282826102, 833518584, 258773596, 1252680510, 2161330425, 1505524757, 1106189058, 2479195181, 4059279758, 4087261637, 2802856115, 215936888, 385734300, 3976823712, 2155716808, 166878602, 2958581226, 2153643018, 3459229793, 166654981, 1135752470, 2999716815, 102870168, 3592405002, 143561712, 3332529987, 3320611547, 176304087, 3809410875, 956905158, 3283895217, 1267764884, 1781613649, 2648889013, 4023857409, 2805378741, 2649655508, 2608225929, 2196639843, 2844902511, 1947381383, 133311662, 3189375534, 3360781939, 2598704112, 449730728, 1660136746, 2120362421, 4282918442, 553031705, 2359175283, 1820194402, 3326941501, 2079373053, 3848840564, 674418166, 2099289575, 3503720323, 71654499, 1153326313, 560391397, 987219237, 3519108661, 343772283, 2206155982, 1710469128, 4284016382, 1099544658, 2385903806, 435889661, 1754514095, 1654595795, 2611465271, 2924309399, 3849122741, 2771388572, 132443906, 639488960, 1702455392, 1197499823, 3431742381, 1162507747, 1956793904, 2882150352, 1024607141, 573195509, 4026654414, 2622992078, 3350586931, 3799382718, 189653578, 2030853706, 2360599919, 1447670146, 3029293260, 449492231, 794537698, 2013929440, 2521582617, 3662902133, 2988382934, 1101429406, 2204422539, 2884223003, 4160719615, 378925199, 321253023, 713869660, 1722066591, 4190495614, 3241838993, 3156104799, 3976107465, 690141471, 2565083608, 629627271, 3367902606, 3025623735, 1771459709, 2325207656, 29331249, 1631496960, 1272596234, 677116176, 36223230, 1894006200, 1868323656, 147662067, 3018282350, 847618418, 473803624, 303813116, 1222076488, 2857631548, 1620440323, 3028453586, 3771115277, 974948581, 2805463577, 3012869721, 1677541868, 873746956, 3206333732, 3540196648, 4222297189, 3955666095, 3723668809, 3383181896, 1572023031, 3593767211, 4139994756, 2493637240, 1055398974, 3491895839, 2158774748, 4074778554, 2265454243, 3123246270, 3737495019, 3584208536, 505004504, 711346815, 2265659930, 44813444, 762261590, 2345302575, 3635851795, 2255282129, 3598634106, 921749760, 1418440684, 3784150188, 2393915660, 2720478000, 1612782044, 4147046015, 2561634247, 586916363, 1606384598, 1299844033, 4047608483, 3431257347, 781242816, 3127114595, 1484369015, 483654543, 678493767, 2757899632, 3276695749, 1363370762, 1578035875, 555054787, 3093962781, 2222987767, 2130200534, 2053306276, 3948690640, 3249023873, 2343777324, 2833997966, 44199340, 1950451402, 1448991312, 1055067146, 3980624341, 1812874122, 2512418377, 3541037815, 714180005, 987816438, 3414079245, 1619142872, 4122595525, 3638144912, 3337941608, 2664929972, 1577036940, 206102296, 2850863132, 3729200403, 644729416, 844182047, 2261919397, 1040614315, 1776485562, 677708826, 223842114, 2591956969, 3141458682, 4271489476, 4253854271, 3973860423, 2805984925, 2908508806, 2328769351, 3865140, 4170270812, 1373888554, 1702101960, 3761095439, 3848481069, 812779025, 2073985983, 239315333, 1585392927, 2233774162, 2308108952, 3393306946, 2891660426, 1059096016, 2448311649, 2662483261, 422228248, 2356192519, 4004741305, 432651290, 2419877069, 3136967672, 329338548, 510605497, 2753410852, 2256462380, 3602678268, 2558451886, 324326056, 3822050324, 944965241, 4107093336, 1023337388, 564298141, 2977064774, 1802025909, 2329346614, 1460784428, 2510641562, 593994802, 4034614216, 4154528137, 3061249939, 487067285, 2856327155, 1909407614, 1782934804, 947220403, 2311402749, 3528590202, 2841893555, 3179384475, 3485733076, 87074890, 753396673, 790057962, 378850528, 3789224576, 3983502105, 1166116, 1854075229, 965611444, 3399039227, 3301304385, 3499808775, 1553588463, 2562124078, 3702675704, 1456114141, 768418804, 2227423616, 3711148950, 2738970313, 4033988307, 1184409529, 3461105405, 2986057969, 2112332635, 615658869, 2858394250, 2819269426, 499315937, 1714425168, 3816439521, 4188657733, 1226314395, 773286132, 1257824142, 2439511774, 1412431345, 451028253, 102711904, 3272107935, 1915128127, 674941443, 1907183006, 4205826365, 2592631544, 2001660887, 1793337902, 336832953, 1676534641, 439197643, 2175306211, 1969440247, 4084563735, 564896680, 1293717918, 1136684128, 4289259757, 2368216261, 3167549822, 1998645278, 2908859410, 2014400533, 1482521794, 3082876093, 2742987778, 3273667028, 1654313273, 3551772744, 1923315597, 1063687791, 1907747434, 3323400678, 3445870975, 316314436, 3905619499, 853586576, 456263058, 3213830894, 3603099146, 1478599807, 344267130, 1085971878, 2416474796, 247701271, 2926294528, 1981779524, 3809025846, 2106937971, 1596271124, 1289668306, 1824884242, 543613169, 2698011204, 1632632104, 179981234, 1091171130, 608067622, 4034608897, 2707671187, 2261524231, 2177175178, 1649366013, 733151281, 2783115482, 389580085, 495962438, 512715565, 1917819840, 1993385884, 2910358830, 3223741704, 3302008571, 857474180, 143995596, 3194737469, 2792999636, 111369357, 2665449999, 3481184513, 21965724, 172308864, 3373225896, 3941204120, 1487487599, 2697473345, 4173199839, 1988623177, 3567610975, 2393053467, 2231132558, 3798877543, 4275987399, 3626515970, 3957758644, 3196139612, 1577858639, 4145376193, 3982712357, 1316354617, 2476570111, 2796635786, 3673095113, 317782376, 38302891, 2729549772, 3124741082, 779634809, 480059945, 1764557943, 1905762442, 2439926326, 3398546304, 1275206055, 3578388510, 4286589961, 2284154687, 1547652572, 211218778, 4019993609, 1035325551, 47385212, 1413260320, 1895132671, 2144191841, 976730195, 880818479, 2944522030, 3051883625, 941172532, 1956827360, 604038865, 1490554868, 2014326554, 3585424155, 1705580179, 1484996770, 3145161387, 2410763156, 1196196268, 4125882510, 1569631240, 3635487118, 3743075539, 53348120, 3549050110, 2179975673, 1455493727, 909517499, 2034744814, 1815931219, 2625466993, 2328144852, 3083176966, 4185591290, 4232725936, 233807337, 987553443, 25498384, 1577858645, 3349985471, 222166290, 1566719496, 4025597331, 454410574, 4172717618, 3397690720, 1563985388, 1294197484, 454917824, 250364909, 1076318659, 3751354075, 3324840413, 2834288682, 1309780963, 3789459740, 1605544538, 1448439145, 1158482892, 407656226, 3589982226, 2670402128, 2795218845, 4079499284, 2736737218, 468906864, 347349067, 3541605667, 1532233501, 1192558327, 3650037602, 1570092544, 3596826230, 2768927258, 1775543901, 1324819997, 3401066173, 4078892370, 3373389918, 3360817112, 3261261117, 2443241006, 847292772, 3862028592, 4086319712, 1837673494, 3577160747, 2636413549, 4021668342, 573747407, 3546255858, 2787607684, 403421850, 3477281082, 4133820736, 332805644, 3663845239, 80993494, 344033777, 1187319040, 1547969768]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack2</span>(<span class="params">list1</span>):</span><br><span class="line">    predictor = ExtendMT19937Predictor()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        predictor.setrandbits(list1[i], <span class="number">32</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        predictor.backtrack_getrandbits(<span class="number">32</span>)</span><br><span class="line">    x = predictor.backtrack_getrandbits(<span class="number">128</span>)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">key = attack2(D)</span><br><span class="line"></span><br><span class="line">key = <span class="built_in">bytes</span>(<span class="built_in">list</span>(<span class="built_in">reversed</span>(<span class="built_in">list</span>(long_to_bytes(key)))))</span><br><span class="line"><span class="comment"># key = key.to_bytes(16, &#x27;little&#x27;)</span></span><br><span class="line"></span><br><span class="line">c =  <span class="string">b&#x27;a\x93\xdc\xc3\x90\x0cK\xfa\xfb\x1c\x05$y\x16:\xfc\xf3+\xf8+%\xfe\xf9\x86\xa3\x17i+ab\xca\xb6\xcd\r\xa5\x94\xeaVM\xdeo\xa7\xdf\xa9D\n\x02\xa3&#x27;</span></span><br><span class="line"></span><br><span class="line">cipher = AES.new(key,AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(cipher.decrypt(c))</span><br><span class="line"></span><br><span class="line"><span class="comment"># WKCTF&#123;3f2af637b773613c18d27694f20d98fd&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="官方解"><a href="#官方解" class="headerlink" title="官方解"></a>官方解</h3><p>利用 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0p1bGlhUG9vL01UMTk5MzctU3ltYm9saWMtRXhlY3V0aW9uLWFuZC1Tb2x2ZXI=">https://github.com/JuliaPoo/MT19937-Symbolic-Execution-and-Solver<i class="fa fa-external-link-alt"></i></span></p>
<p>这个项目上的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Only [<span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">28</span>, <span class="number">32</span>] are supported</span><br></pre></td></tr></table></figure>
<p>有个限制，就是只能解 如上八种大小的随机数</p>
<p>详细使用方法见 <code>Demo of Features.ipynb</code> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rng_clone = MT19937(state_from_data=(rand, <span class="number">4</span>))</span><br></pre></td></tr></table></figure>
<p>无论随机数是4bit 还是 8bit，抑或其他几种，只需修改这个</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line">sys.path.append(<span class="string">&#x27;D:\Desktop\CTF\CTF工具\Sagemath\MT19937-Symbolic-Execution-and-Solver-master\source&#x27;</span>)</span><br><span class="line"><span class="keyword">from</span> MT19937 <span class="keyword">import</span> MT19937</span><br><span class="line"></span><br><span class="line">c = <span class="string">b&#x27;\x90\xddz\xbf@\xa2$a\xacGB\xe5\x1b\x1c\xa6\xc7&#x27;</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;random.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">rand = f.read().split(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">rand = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> rand]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Clone rng&#x27;s current state</span></span><br><span class="line">rng_clone = MT19937(state_from_data=(rand, <span class="number">4</span>))  <span class="comment"># Only [4, 8, 12, 16, 20, 24, 28, 32] are supported</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Reverse state by 4</span></span><br><span class="line">rng_clone.reverse_states(<span class="number">4</span>)</span><br><span class="line">reverse_states = [rng_clone() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"><span class="comment"># 先生成的32比特放在低位</span></span><br><span class="line">k = reverse_states[<span class="number">0</span>] + reverse_states[<span class="number">1</span>]*<span class="number">2</span>**<span class="number">32</span> + reverse_states[<span class="number">2</span>]*<span class="number">2</span>**<span class="number">64</span> + reverse_states[<span class="number">3</span>]*<span class="number">2</span>**<span class="number">96</span></span><br><span class="line">key = k.to_bytes(<span class="number">16</span>, <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">cipher = AES.new(key,AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(unpad(cipher.decrypt(c),<span class="number">16</span>).decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># WKCTF&#123;3f2af637b773613c18d27694f20d98fd&#125;</span></span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">to_bytes(length, byteorder):</span><br><span class="line">length：结果字节对象的长度（字节数）。这里是 <span class="number">16</span>，意味着结果将是一个 <span class="number">16</span> 字节长的字节对象。</span><br><span class="line">byteorder：字节序，可以是 ‘big’ 或 ‘little’。</span><br><span class="line">‘big’：大端序（big -endian），高位字节在前。</span><br><span class="line">‘little’：小端序（little -endian），低位字节在前。</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="赣育杯2024-Random-dlp"><a href="#赣育杯2024-Random-dlp" class="headerlink" title="赣育杯2024-Random-dlp"></a>赣育杯2024-Random-dlp</h2><blockquote>
<p>2024-10-27</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = getrandbits(<span class="number">128</span>)</span><br><span class="line">flag = <span class="string">b&#x27;Sangfor&#123;&#x27;</span>+<span class="built_in">str</span>(m).encode()+<span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line">big_bits = <span class="number">992</span></span><br><span class="line"></span><br><span class="line">x = getrandbits(<span class="number">32</span>)</span><br><span class="line">g = getrandbits(<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prime_number</span>(<span class="params">big_bits</span>):</span><br><span class="line">    number = getrandbits(big_bits)</span><br><span class="line">    number = number &lt;&lt; <span class="number">32</span></span><br><span class="line">    <span class="keyword">return</span> next_prime(number)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">g, x, p</span>):</span><br><span class="line">    c = <span class="built_in">pow</span>(g, x, p)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">c = encrypt(g, x, p)</span><br><span class="line">random_list1 = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    random_num1 = prime_number(big_bits)</span><br><span class="line">    random_num2 = prime_number(big_bits)</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">        Composite_number = random_num1 * random_num2</span><br><span class="line">        xor_prime = random_num1 ^ random_num2</span><br><span class="line">        random_list1.append(<span class="built_in">int</span>(Composite_number))</span><br><span class="line">        random_list1.append(<span class="built_in">int</span>(xor_prime))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        random_list1.append(<span class="built_in">int</span>(random_num1))</span><br><span class="line">        random_list1.append(<span class="built_in">int</span>(random_num2))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(<span class="built_in">str</span>(p)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    file.write(<span class="built_in">str</span>(g)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    file.write(<span class="built_in">str</span>(c)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    file.write(<span class="built_in">str</span>(random_list1)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    file.close()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Composite_number = random_num1 * random_num2</span><br><span class="line">xor_prime = random_num1 ^ random_num2</span><br></pre></td></tr></table></figure>
<p>给定p与q的异或求n的分解，剪枝</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">number = number &lt;&lt; <span class="number">32</span></span><br><span class="line"><span class="keyword">return</span> next_prime(number)</span><br></pre></td></tr></table></figure>
<p>因为 <code>&lt;&lt; 32</code>所以我们需要 <code>&gt;&gt; 32</code>，<code>next_prime</code> 就毫无影响</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g = getrandbits(<span class="number">128</span>)</span><br></pre></td></tr></table></figure>
<p>再加上g，数据足够用于回溯了，</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> extend_mt19937_predictor <span class="keyword">import</span> ExtendMT19937Predictor</span><br><span class="line"></span><br><span class="line">sys.setrecursionlimit(<span class="number">1500</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># part1,剪枝</span></span><br><span class="line">a1= <span class="number">99955815136124674505677363553135840917216692678315165208714645876521277179009541555218693763972124093311337930953461092973753294192953068017272222852126250530936095477001144686822657131226982048667251579944854755923118519999180605689190568796547900773861811522756528982895318342111571405051796393985533019048</span></span><br><span class="line">b1= <span class="number">5065809221397249795914513089532241535418102663843841350285885091820845924268184747393712704066864872817411880187138570682343431633457955483256879427452674941369291914713556216448497708811437937958937996112215942003348660775545739352648178349311820872326958487644664192024604484132973905940652831298817064882948766270012275390175132095666103160877771192023394295841216195145461506875974150379337178597242564194005887140459925415651634648423371399820338191237184941903484527013807399340034262032276649742513332545447037957047893203075544536859894680877963124739172891482242764504898102716242397187522857902572172473057</span></span><br><span class="line"></span><br><span class="line">a1 = <span class="built_in">str</span>(<span class="built_in">bin</span>(a1)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">p, q</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(p)</span><br><span class="line">    tmp0 = p + (<span class="number">1024</span> - l) * <span class="string">&quot;0&quot;</span></span><br><span class="line">    tmp1 = p + (<span class="number">1024</span> - l) * <span class="string">&quot;1&quot;</span></span><br><span class="line">    tmq0 = q + (<span class="number">1024</span> - l) * <span class="string">&quot;0&quot;</span></span><br><span class="line">    tmq1 = q + (<span class="number">1024</span> - l) * <span class="string">&quot;1&quot;</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">int</span>(tmp0, <span class="number">2</span>) &lt; <span class="built_in">int</span>(tmq0, <span class="number">2</span>)):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">int</span>(tmp0, <span class="number">2</span>) * <span class="built_in">int</span>(tmq0, <span class="number">2</span>) &gt; b1):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">elif</span> (<span class="built_in">int</span>(tmp1, <span class="number">2</span>) * <span class="built_in">int</span>(tmq1, <span class="number">2</span>) &lt; b1):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (l == <span class="number">1024</span>):</span><br><span class="line">        pp = <span class="built_in">int</span>(tmp0, <span class="number">2</span>)</span><br><span class="line">        qq = <span class="built_in">int</span>(tmq0, <span class="number">2</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;num1=&#x27;</span>,pp)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;num1=&#x27;</span>,qq)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> (a1[l] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">            find(p + <span class="string">&quot;1&quot;</span>, q + <span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p + <span class="string">&quot;0&quot;</span>, q + <span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            find(p + <span class="string">&quot;0&quot;</span>, q + <span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p + <span class="string">&quot;1&quot;</span>, q + <span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line">tempp = <span class="string">&quot;&quot;</span></span><br><span class="line">tempq = <span class="string">&quot;&quot;</span></span><br><span class="line">find(tempp, tempq)</span><br><span class="line"></span><br><span class="line">num1= <span class="number">127954378905954473979599580543506133734470934402921187567126328044915399136783613004594347893231249786782113863929878799565038392492182148282608301947643527866047185811106214065159313666530775740342170598378474744062316856449855121227117986037506212272472581097517909639356259473022026193056598279705883312493</span></span><br><span class="line">num2= <span class="number">39590745269613494512251071983478757508814280272882049594849029032543594900913069786771939178626302619505593605829896534613681707527396968070583148545044036306348014204000427687094161885558852315374684881011665955520787218713536145424007912730740353898075406161865607017294126568950247058934097741037059441349</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f = f.read()</span><br><span class="line">    p = <span class="built_in">eval</span>(f.decode().split(<span class="string">&#x27;\r\n&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">    g = <span class="built_in">eval</span>(f.decode().split(<span class="string">&#x27;\r\n&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">    c = <span class="built_in">eval</span>(f.decode().split(<span class="string">&#x27;\r\n&#x27;</span>)[<span class="number">2</span>])</span><br><span class="line">    random_list1 = <span class="built_in">eval</span>(f.decode().split(<span class="string">&#x27;\r\n&#x27;</span>)[-<span class="number">2</span>])</span><br><span class="line">    random_list1[<span class="number">0</span>] = num1</span><br><span class="line">    random_list1[<span class="number">1</span>] = num2</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(random_list1)):</span><br><span class="line">        random_list1[i] = random_list1[i]&gt;&gt;<span class="number">32</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack2</span>(<span class="params">list1</span>):</span><br><span class="line">    predictor = ExtendMT19937Predictor()</span><br><span class="line">    predictor.setrandbits(g, <span class="number">128</span>)		<span class="comment"># 这个位置注意一下</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        predictor.setrandbits(list1[i], <span class="number">992</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        predictor.backtrack_getrandbits(<span class="number">992</span>)</span><br><span class="line">    predictor.backtrack_getrandbits(<span class="number">128</span>)</span><br><span class="line">    predictor.backtrack_getrandbits(<span class="number">32</span>)</span><br><span class="line">    x = predictor.backtrack_getrandbits(<span class="number">128</span>)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">x = attack2(random_list1)</span><br><span class="line">flag = <span class="string">b&#x27;Sangfor&#123;&#x27;</span>+<span class="built_in">str</span>(x).encode()+<span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sangfor&#123;332419641733214815865048217860135168997&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h1><p><span class="exturl" data-url="aHR0cHM6Ly9iYWRtb25rZXkuc2l0ZS9hcmNoaXZlcy9tdDE5OTM3">浅析MT19937伪随机数生成算法 - badmonkey<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNTU3MTE1L2FydGljbGUvZGV0YWlscy8xMjgyMjgyMDE=">[CTF/randcrack]python随机数预测模块分析及改进方案_random.getrandbits(32)-CSDN博客<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL05vbnVwbGVCcm9rZW4vRXh0ZW5kTVQxOTkzN1ByZWRpY3Rvcg==">ExtendMT19937Predictor<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1hpb25nU2lxaV9ibG9nL2FydGljbGUvZGV0YWlscy8xNDA0MzI4Njc=">[WKCTF 2024] Crypto (random)_wkctf2024-CSDN博客<i class="fa fa-external-link-alt"></i></span></p>

    </div>

    
    
    
<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------　　　　本文结束　<i class="fa fa-flag"></i>　感谢阅读　　　　-------------</div>
    
</div>


        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Wbuildings
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://wbuildings.github.io/Crypto/MT19937%E5%AE%9E%E6%88%98/" title="MT19937实战">https://wbuildings.github.io/Crypto/MT19937实战/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/MT19937/" rel="tag"><i class="fa fa-tag"></i> MT19937</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/Crypto/2024%E7%AC%AC%E4%B8%80%E5%B1%8AVCTF%E7%BA%B3%E6%96%B0%E8%B5%9B/" rel="prev" title="2024第一届VCTF纳新赛">
      <i class="fa fa-chevron-left"></i> 2024第一届VCTF纳新赛
    </a></div>
      <div class="post-nav-item">
    <a href="/Crypto/%E8%83%8C%E5%8C%85%E5%AF%86%E7%A0%81/" rel="next" title="背包密码">
      背包密码 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98%EF%BC%9A"><span class="nav-number">2.</span> <span class="nav-text">例题：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#NKCTF2023-real-MT"><span class="nav-number">2.1.</span> <span class="nav-text">[NKCTF2023]real_MT</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A"><span class="nav-number">2.1.1.</span> <span class="nav-text">题解：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%82seed"><span class="nav-number">2.1.2.</span> <span class="nav-text">求seed</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%82extracted"><span class="nav-number">2.1.3.</span> <span class="nav-text">求extracted</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%84%E6%B5%8B%E9%9A%8F%E6%9C%BA%E6%95%B0"><span class="nav-number">2.1.4.</span> <span class="nav-text">预测随机数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9E%E6%BA%AFpre-number"><span class="nav-number">2.1.5.</span> <span class="nav-text">回溯pre number</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NKCTF2023-fake-MT"><span class="nav-number">2.2.</span> <span class="nav-text">[NKCTF2023]fake_MT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A5%E5%85%85%EF%BC%9A"><span class="nav-number">2.3.</span> <span class="nav-text">补充：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easy-random"><span class="nav-number">2.4.</span> <span class="nav-text">easy_random</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-1"><span class="nav-number">2.4.1.</span> <span class="nav-text">题解：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%98%E6%96%B9%E8%A7%A3"><span class="nav-number">2.4.2.</span> <span class="nav-text">官方解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B5%A3%E8%82%B2%E6%9D%AF2024-Random-dlp"><span class="nav-number">2.5.</span> <span class="nav-text">赣育杯2024-Random-dlp</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reference%EF%BC%9A"><span class="nav-number">3.</span> <span class="nav-text">Reference：</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Wbuildings"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Wbuildings</p>
  <div class="site-description" itemprop="description">须知少年凌云志，曾许人间第一流</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span>
  </div>


<!-- recent posts -->

      </div>

      
      <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
      <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
      <div class="widget-wrap">
          <h3 class="widget-title">Tag Cloud</h3>
          <div id="myCanvasContainer" class="widget tagcloud">
              <canvas width="250" height="250" id="resCanvas" style="width=100%">
                  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AES/" rel="tag">AES</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DSA/" rel="tag">DSA</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dual-RSA/" rel="tag">Dual RSA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ECRSA/" rel="tag">ECRSA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HNP/" rel="tag">HNP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LFSR/" rel="tag">LFSR</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LWE/" rel="tag">LWE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lattice/" rel="tag">Lattice</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MITM/" rel="tag">MITM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MT19937/" rel="tag">MT19937</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RSA/" rel="tag">RSA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Schmidt-Samoa/" rel="tag">Schmidt-Samoa</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shamir/" rel="tag">Shamir</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sylvester/" rel="tag">Sylvester</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Wp/" rel="tag">Wp</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sage/" rel="tag">sage</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E5%85%83copper/" rel="tag">二元copper</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/" rel="tag">古典密码</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E7%9F%A5%E8%AF%86/" rel="tag">密码知识</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9B%B2%E7%BA%BF/" rel="tag">曲线</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E8%AE%B0/" rel="tag">杂记</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%B4%A0%E6%95%B0/" rel="tag">素数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%83%8C%E5%8C%85%E5%AF%86%E7%A0%81/" rel="tag">背包密码</a><span class="tag-list-count">2</span></li></ul>
              </canvas>
          </div>
      </div>
      


    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wbuildings</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">1m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">15:50</span>
</div>

  <script>
    var OriginTitle = document.title;
    var titleTime;
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        document.title = '(*^▽^*)我藏好了哦~' + OriginTitle;
        clearTimeout(titleTime);
      } else {
        document.title = 'q(≧▽≦q)被你发现啦~' + OriginTitle;
        titleTime = setTimeout(function() {
          document.title = OriginTitle;
        }, 2000);
      }
    });
  </script>


<script color="24,24,24" opacity="0.5" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  
  <script data-pjax>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













    <div id="pjax">
  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://wbuildings.github.io/Crypto/MT19937%E5%AE%9E%E6%88%98/',]
      });
      });
  </script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'apuSRwmMMe8HwB5WcdQuox47-gzGzoHsz',
      appKey     : 'MS1uA9PBT4L62Jbrjbh0UEHT',
      placeholder: "在这里写下你的评论吧！",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>


  <script async src="/js/love.min.js"></script>





    </div>
<script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>