<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <link rel="stylesheet" href="https://npm.elemecdn.com/font-awesome/css/font-awesome.min.css"/ media="defer" onload="this.media='all'">
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/avatar.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/avatar.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wbuildings.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="新年都未有芳华，二月初惊见草芽。">
<meta property="og:type" content="article">
<meta property="og:title" content="SICTF Round#3">
<meta property="og:url" content="https://wbuildings.github.io/Crypto/SICTF-Round-3/index.html">
<meta property="og:site_name" content="W&#39;Blog">
<meta property="og:description" content="新年都未有芳华，二月初惊见草芽。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Wbuildings/hexoimage/imagesimage-20240226033237586.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Wbuildings/hexoimage/imagesimage-20240226033053986.png">
<meta property="article:published_time" content="2024-02-21T13:05:12.000Z">
<meta property="article:modified_time" content="2024-06-03T07:05:01.707Z">
<meta property="article:author" content="Wbuildings">
<meta property="article:tag" content="Wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Wbuildings/hexoimage/imagesimage-20240226033237586.png">

<link rel="canonical" href="https://wbuildings.github.io/Crypto/SICTF-Round-3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>SICTF Round#3 | W'Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <script defer src="/live2d-widget/autoload.js"></script>
  
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">W'Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Wbuildings的自勉小屋</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">23</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">2</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">30</span></a>

  </li>
        <li class="menu-item menu-item-links">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL1didWlsZGluZ3M=" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wbuildings.github.io/Crypto/SICTF-Round-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Wbuildings">
      <meta itemprop="description" content="须知少年凌云志，曾许人间第一流">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="W'Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SICTF Round#3
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-02-21 21:05:12" itemprop="dateCreated datePublished" datetime="2024-02-21T21:05:12+08:00">2024-02-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Crypto/" itemprop="url" rel="index"><span itemprop="name">Crypto</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/Crypto/SICTF-Round-3/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/Crypto/SICTF-Round-3/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>44k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>40 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>新年都未有芳华，二月初惊见草芽。</p>
<span id="more"></span>
<h2 id="签到-Vigenere"><a href="#签到-Vigenere" class="headerlink" title="[签到]Vigenere"></a>[签到]Vigenere</h2><blockquote>
<p>出题人：树木</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Gn taj xirly gf Fxgjuakd, oe igywnd mt tegbs mnrxxlrivywd sngearbsw wakksre. Bs kpimj gf tank, it bx gur bslenmngn th jfdetagur mt ceei yze Ugnled Lystel tx Amxwaca gjmtrtq.</span><br><span class="line"></span><br><span class="line">An taj wvegy gf tank nom xmccxjvinz, bw prhugse ts sllbffce hs lhe ytdlopnfg btxas wbyz Meqnuo: Tafl we lmsll ffce wtw logxyzer tsv madj heavj logxyzer. Pj khaeq yivLNUTF&#123;4695vft9-fd68-<span class="number">4684</span>-uj81-u6c1avg6uaft&#125;j yenxwgus ynfanvnsl snuhorm, ffd ag zfdekxlanwnfg og tmr ptwl thty Eexbhg <span class="keyword">is</span> mt jechsiuek yze lhxl tekwatokd an Nxb Eexbhg, Teqfk, anw Fjizhss. Thx iwtabqk of ljltlxrwnt tww leyy lo yhz.</span><br><span class="line"></span><br><span class="line">Qou tww inlyjucmjv to bsxorf yze Pkjkidxsl [of Fjpich] tx thx ftovx nf thx ljeamjkt chsxidxsue al xgon tx at il hwrttnf thty lhekj oile gw an hzlbrxfc of pfj wimm lhe Nsatew Xlatxx snd lzygely lham yze Pkjkidxsl, on ank owg nfitbflivx, nfvimj Bapts lo ifrwdityw adajjenvj oita yzis iqsn; am yze strw tifj, gffxw lo mxiaatx gwtwxjf Jaiff anw tmrsxqnes.</span><br><span class="line"></span><br><span class="line">Iqwasx hsll mt lhe tylenmngn oy yze Pkjkidxsl thty lhe kzlhlxxk emiqgymxsl of hzj suursrigjk nop txfekx lhe iwgspxhl of vtepeeqang Xsylagi lo mtpw pethw <span class="keyword">in</span> t kww mhslhs.</span><br></pre></td></tr></table></figure>
<p>常见的维吉尼亚在线爆破密钥</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZ3ViYWxsYS5kZS92aWdlbmVyZS1zb2x2ZXI=">https://www.guballa.de/vigenere-solver<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">On the first of February, we intend to begin unrestricted submarine warfare. In spite of this, it <span class="keyword">is</span> our intention to endeavour to keep the United States of America neutral.</span><br><span class="line"></span><br><span class="line">In the event of this <span class="keyword">not</span> succeeding, we propose an alliance on the following basis <span class="keyword">with</span> Mexico: That we shall make war together <span class="keyword">and</span> make peace together. We shall givSICTF&#123;4695cab9-fd68-<span class="number">4684</span>-be81-c6c1acb6cafa&#125;e generous financial support, <span class="keyword">and</span> an understanding on our part that Mexico <span class="keyword">is</span> to reconquer the lost territory <span class="keyword">in</span> New Mexico, Texas, <span class="keyword">and</span> Arizona. The details of settlement are left to you.</span><br><span class="line"></span><br><span class="line">You are instructed to inform the President [of Mexico] of the above <span class="keyword">in</span> the greatest confidence <span class="keyword">as</span> soon <span class="keyword">as</span> it <span class="keyword">is</span> certain that there will be an outbreak of war <span class="keyword">with</span> the United States <span class="keyword">and</span> suggest that the President, on his own initiative, invite Japan to immediate adherence <span class="keyword">with</span> this plan; at the same time, offer to mediate between Japan <span class="keyword">and</span> ourselves.</span><br><span class="line"></span><br><span class="line">Please call to the attention of the President that the ruthless employment of our submarines now offers the prospect of compelling England to make peace <span class="keyword">in</span> a few months.</span><br><span class="line"></span><br><span class="line"><span class="comment"># SICTF&#123;4695cab9-fd68-4684-be81-c6c1acb6cafa&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="签到，确信！"><a href="#签到，确信！" class="headerlink" title="签到，确信！"></a>签到，确信！</h2><blockquote>
<p>出题人：3tefanie</p>
</blockquote>
<p>附件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_keys</span>(<span class="params">bits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        p = getPrime(bits)</span><br><span class="line">        q = <span class="built_in">sum</span>([p**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>)])</span><br><span class="line">        <span class="keyword">if</span> isPrime(q):</span><br><span class="line">            r = getPrime(<span class="number">1024</span>)</span><br><span class="line">            n = p*q*r</span><br><span class="line">            <span class="keyword">return</span> p,n</span><br><span class="line">p,n = gen_keys(<span class="number">512</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 8361361624563191168612863710516449028280757632934603412143152925186847721821552879338608951120157631182699762833743097837368740526055736516080136520584848113137087581886426335191207688807063024096128001406698217998816782335655663803544853496060418931569545571397849643826584234431049002394772877263603049736723071392989824939202362631409164434715938662038795641314189628730614978217987868150651491343161526447894569241770090377633602058561239329450046036247193745885174295365633411482121644408648089046016960479100220850953009927778950304754339013541019536413880264074456433907671670049288317945540495496615531150916647050158936010095037412334662561046016163777575736952349827380039938526168715655649566952708788485104126900723003264019513888897942175890007711026288941687256962012799264387545892832762304320287592575602683673845399984039272350929803217492617502601005613778976109701842829008365226259492848134417818535629827769342262020775115695472218876430557026471282526042545195944063078523279341459199475911203966762751381334277716236740637021416311325243028569997303341317394525345879188523948991698489667794912052436245063998637376874151553809424581376068719814532246179297851206862505952437301253313660876231136285877214949094995458997630235764635059528016149006613720287102941868517244509854875672887445099733909912598895743707420454623997740143407206090319567531144126090072331</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 990174418341944658163682355081485155265287928299806085314916265580657672513493698560580484907432207730887132062242640756706695937403268682912083148568866147011247510439837340945334451110125182595397920602074775022416454918954623612449584637584716343806255917090525904201284852578834232447821716829253065610989317909188784426328951520866152936279891872183954439348449359491526360671152193735260099077198986264364568046834399064514350538329990985131052947670063605611113730246128926850242471820709957158609175376867993700411738314237400038584470826914946434498322430741797570259936266226325667814521838420733061335969071245580657187544161772619889518845348639672820212709030227999963744593715194928502606910452777687735614033404646237092067644786266390652682476817862879933305687452549301456541574678459748029511685529779653056108795644495442515066731075232130730326258404497646551885443146629498236191794065050199535063169471112533284663197357635908054343683637354352034115772227442563180462771041527246803861110504563589660801224223152060573760388045791699221007556911597792387829416892037414283131499832672222157450742460666013331962249415807439258417736128976044272555922344342725850924271905056434303543500959556998454661274520986141613977331669376614647269667276594163516040422089616099849315644424644920145900066426839607058422686565517159251903275091124418838917480242517812783383</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>随机多项式中找到n的因子</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">k = <span class="number">7</span></span><br><span class="line">n=<span class="number">8361361624563191168612863710516449028280757632934603412143152925186847721821552879338608951120157631182699762833743097837368740526055736516080136520584848113137087581886426335191207688807063024096128001406698217998816782335655663803544853496060418931569545571397849643826584234431049002394772877263603049736723071392989824939202362631409164434715938662038795641314189628730614978217987868150651491343161526447894569241770090377633602058561239329450046036247193745885174295365633411482121644408648089046016960479100220850953009927778950304754339013541019536413880264074456433907671670049288317945540495496615531150916647050158936010095037412334662561046016163777575736952349827380039938526168715655649566952708788485104126900723003264019513888897942175890007711026288941687256962012799264387545892832762304320287592575602683673845399984039272350929803217492617502601005613778976109701842829008365226259492848134417818535629827769342262020775115695472218876430557026471282526042545195944063078523279341459199475911203966762751381334277716236740637021416311325243028569997303341317394525345879188523948991698489667794912052436245063998637376874151553809424581376068719814532246179297851206862505952437301253313660876231136285877214949094995458997630235764635059528016149006613720287102941868517244509854875672887445099733909912598895743707420454623997740143407206090319567531144126090072331</span></span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="number">990174418341944658163682355081485155265287928299806085314916265580657672513493698560580484907432207730887132062242640756706695937403268682912083148568866147011247510439837340945334451110125182595397920602074775022416454918954623612449584637584716343806255917090525904201284852578834232447821716829253065610989317909188784426328951520866152936279891872183954439348449359491526360671152193735260099077198986264364568046834399064514350538329990985131052947670063605611113730246128926850242471820709957158609175376867993700411738314237400038584470826914946434498322430741797570259936266226325667814521838420733061335969071245580657187544161772619889518845348639672820212709030227999963744593715194928502606910452777687735614033404646237092067644786266390652682476817862879933305687452549301456541574678459748029511685529779653056108795644495442515066731075232130730326258404497646551885443146629498236191794065050199535063169471112533284663197357635908054343683637354352034115772227442563180462771041527246803861110504563589660801224223152060573760388045791699221007556911597792387829416892037414283131499832672222157450742460666013331962249415807439258417736128976044272555922344342725850924271905056434303543500959556998454661274520986141613977331669376614647269667276594163516040422089616099849315644424644920145900066426839607058422686565517159251903275091124418838917480242517812783383</span></span><br><span class="line"></span><br><span class="line">R = Zmod(n)[<span class="string">&quot;x&quot;</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    Q = R.quo(R.random_element(k))</span><br><span class="line">    pp1 = gcd(ZZ(<span class="built_in">list</span>(Q.random_element() ^ n)[<span class="number">1</span>]), n)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> pp1 != <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(pp1)</span><br><span class="line">        qq = <span class="built_in">sum</span>([pp1**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k)])</span><br><span class="line">        rr = n // (pp1 * qq)</span><br><span class="line">        <span class="keyword">assert</span> n == pp1 * qq * rr</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">phi = (pp1 - <span class="number">1</span>) * (qq - <span class="number">1</span>) * (rr - <span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># SICTF&#123;d9428fc7-fa3a-4096-8ec9-191c0a4562ff&#125;</span></span><br></pre></td></tr></table></figure>
<ol>
<li><code>R = Zmod(n)[&quot;x&quot;]</code>：创建了一个环<code>R</code>，它是整数模n（即Z/nZ）上的多项式环，变量为<code>x</code>。这样我们可以进行多项式运算。</li>
<li><code>Q = R.quo(R.random_element(k))</code>：创建了一个多项式<code>Q</code>，<code>R.random_element(k)</code>生成一个随机多项式。 即 <script type="math/tex">Z_n[x]/f(x)</script></li>
</ol>
<p>抽象代数，商环？推理具体看</p>
<p><span class="exturl" data-url="aHR0cHM6Ly90YW5nY3V4aWFvamlrdWFpLnh5ei9wb3N0L2VhNDQ1MzM1Lmh0bWw=">Crypto趣题-RSA(一)<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="easyLattice"><a href="#easyLattice" class="headerlink" title="easyLattice"></a>easyLattice</h2><blockquote>
<p>出题人：DexterJie</p>
</blockquote>
<p>附件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">47</span></span><br><span class="line"></span><br><span class="line">f = bytes_to_long(flag)  </span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">g = getPrime(<span class="number">128</span>)</span><br><span class="line">h = gmpy2.invert(f, p) * g % p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;h =&#x27;</span>, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>, p)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">h = 9848463356094730516607732957888686710609147955724620108704251779566910519170690198684628685762596232124613115691882688827918489297122319416081019121038443</span></span><br><span class="line"><span class="string">p = 11403618200995593428747663693860532026261161211931726381922677499906885834766955987247477478421850280928508004160386000301268285541073474589048412962888947     </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>一道格的入门题</p>
<font color='orange'>格（Lattice）</font>

<p>给定一组线性无关的基向量<script type="math/tex">v_1,v_2,···,v_n</script>,那么这些基向量的所有整系数线性组合：<script type="math/tex">a_1v_1+a_2v_2+···+a_nv_n</script></p>
<p>所形成的集合，就称作<strong>格（Lattice）</strong></p>
<font color='cornflowerblue'>线性组合：</font>

<p>两个数乘向量的和，被称为这两个向量的线性组合</p>
<font color='cornflowerblue'>线性无关：</font>

<p>所有向量都给张成的空间增添了新的维度</p>
<font color='cornflowerblue'>张成的空间：</font>

<p>所有可以表示为给定向量线性组合的向量的集合</p>
<script type="math/tex; mode=display">f*h=g \bmod p</script><p>=&gt;<script type="math/tex">f*h-k*p=g</script></p>
<p>我们尝试构造一个SVP问题，构造一个矩阵M（由两个线性无关的基构成），我们希望<code>(f,g)</code></p>
<p>是<code>M</code>张成的格上的最短向量，这样我们或许可以求出未知的<code>(f,g)</code></p>
<p>增加一个式子 <script type="math/tex">f*1+k*0=f</script>  ，即构造一个矩阵 <script type="math/tex">M=\begin{bmatrix} 1 & h\\ 0 & p \end{bmatrix}</script></p>
<p>可以发现 <script type="math/tex">(f,-k)\begin{bmatrix} 1 & h\\ 0 & p \end{bmatrix}=(f*1-k*0,f*h-k*p)=(f，g）</script></p>
<p>也就是说，<code>(f,g)</code>可以用两组向量基 <code>M</code>的某种整系数线性组合<code>(f,−u)</code>来表示，因此<code>(f,g)</code>确实在这个<strong>格</strong>上</p>
<ul>
<li>SVP(最短向量问题，Shortest Vector Problem)：给定lattice和基向量，找到lattice中的一个长度最短的非零向量。低维可以利用LLL算法求解</li>
</ul>
<p>最短向量<script type="math/tex">||(f,g)||=\sqrt{f_{bit}^2+g_{bit}^2}\approx 2^{376}</script>, p为512位，可能 f 稍大了，没有直接求出flag来</p>
<p>因为 搞出来的f和g与原f和g存在倍数关系</p>
<p>f 376位，g 128 位，差距 248位</p>
<p><img data-src="https://cdn.jsdelivr.net/gh/Wbuildings/hexoimage/imagesimage-20240226033237586.png" alt="image-20240226033237586"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">h = <span class="number">9848463356094730516607732957888686710609147955724620108704251779566910519170690198684628685762596232124613115691882688827918489297122319416081019121038443</span></span><br><span class="line">p = <span class="number">11403618200995593428747663693860532026261161211931726381922677499906885834766955987247477478421850280928508004160386000301268285541073474589048412962888947</span>     </span><br><span class="line">T = <span class="number">2</span>^<span class="number">248</span></span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[[T*h,<span class="number">1</span>],[T*p,<span class="number">0</span>]])</span><br><span class="line"><span class="built_in">print</span>(Ge.LLL())</span><br><span class="line">g,f = Ge.LLL()[<span class="number">0</span>]</span><br><span class="line">g,f = <span class="built_in">abs</span>(g),<span class="built_in">abs</span>(f)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(f)))</span><br><span class="line"><span class="comment"># SICTF&#123;e3fea01c-18f3-4638-9544-9201393940a9&#125;</span></span><br></pre></td></tr></table></figure>
<p>还需要注意一点的是 <strong>最短向量的上界：</strong><script type="math/tex">||\overrightarrow{v}||\le \sqrt{\frac{n}{2\pi e}}\det(L)^{\frac{1}{n}}=\sigma (L)</script>     (应该是)</p>
<p>于是换了连分数来求解</p>
<script type="math/tex; mode=display">f*h-k*p=g \Rightarrow   \frac{h}{p}逼近于\frac{k}{f}</script><p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">h = <span class="number">9848463356094730516607732957888686710609147955724620108704251779566910519170690198684628685762596232124613115691882688827918489297122319416081019121038443</span></span><br><span class="line">q = <span class="number">11403618200995593428747663693860532026261161211931726381922677499906885834766955987247477478421850280928508004160386000301268285541073474589048412962888947</span>     </span><br><span class="line"></span><br><span class="line"><span class="comment"># Construct lattice.</span></span><br><span class="line"></span><br><span class="line">N = <span class="number">20000</span></span><br><span class="line">fra = (h/q).n(N).exact_rational().continued_fraction()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(fra)):</span><br><span class="line">    k = fra.numerator(i)</span><br><span class="line">    f = fra.denominator(i)</span><br><span class="line">    m = libnum.n2s(<span class="built_in">int</span>(<span class="built_in">abs</span>(f)))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;SICTF&#x27;</span> <span class="keyword">in</span> m:</span><br><span class="line">        <span class="built_in">print</span>(f)</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># SICTF&#123;e3fea01c-18f3-4638-9544-9201393940a9&#125;</span></span><br></pre></td></tr></table></figure>
<p><span class="exturl" data-url="aHR0cHM6Ly90b3Zlci54eXovcC93aWVuZXJzLWxhdHRpY2VzLWVxdWF0aW9ucy8j5YmN6KiA">Wiener’s v.s Lattices —— Ax≡y(mod P)的方程解法笔记 | Tover’ Blog<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vc0NoM24vcC8xNTkxNzM4OC5odG1s">NTRU格密码 - 上辰 - 博客园 (cnblogs.com)<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hlYXJ0YmV3aXRoL2FydGljbGUvZGV0YWlscy8xMjY0NTc1OTI=">格密码（Lattice）与NTRUEncrypt介绍_getrandomnbitinteger-CSDN博客<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9kZXh0ZXJqaWUuZ2l0aHViLmlvLzIwMjMvMDcvMjgv5Yid6K+G5qC8Lz9oaWdobGlnaHQ95qC8I+WFpemXqOmimA==">初识格 | DexterJie’Blog<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="SuperbRSA"><a href="#SuperbRSA" class="headerlink" title="SuperbRSA"></a>SuperbRSA</h2><blockquote>
<p>出题人：Kicky_Mu</p>
</blockquote>
<p>附件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#user:mumu666</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e1=<span class="number">55</span></span><br><span class="line">e2=<span class="number">200</span></span><br><span class="line">m=bytes_to_long(<span class="string">&quot;flag&quot;</span>)</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">pow</span>(m,<span class="number">5</span>) &lt; n)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m, e1, n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m, e2, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1=&quot;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2=&quot;</span>,c2)</span><br><span class="line"></span><br><span class="line">n= <span class="number">19006830358118902392432453595802675566730850352890246995920642811967821259388009049803513102750594524106471709641202019832682438027312468849299985832675191795417160553379580813410722359089872519372049229233732405993062464286888889084640878784209014165871696882564834896322508054231777967011195636564463806270998326936161449009988434249178477100127347406759932149010712091376183710135615375272671888541233275415737155953323133439644529709898791881795186775830217884663044495979067807418758455237701315019683802437323177125493076113419739827430282311018083976114158159925450746712064639569301925672742186294237113199023</span></span><br><span class="line">c1= <span class="number">276245243658976720066605903875366763552720328374098965164676247771817997950424168480909517684516498439306387133611184795758628248588201187138612090081389226321683486308199743311842513053259894661221013008371261704678716150646764446208833447643781574516045641493770778735363586857160147826684394417412837449465273160781074676966630398315417741542529612480836572205781076576325382832502694868883931680720558621770570349864399879523171995953720198118660355479626037129047327185224203109006251809257919143284157354935005710902589809259500117996982503679601132486140677013625335552533104471327456798955341220640782369529</span></span><br><span class="line">c2= <span class="number">11734019659226247713821792108026989060106712358397514827024912309860741729438494689480531875833287268454669859568719053896346471360750027952226633173559594064466850413737504267807599435679616522026241111887294138123201104718849744300769676961585732810579953221056338076885840743126397063074940281522137794340822594577352361616598702143477379145284687427705913831885493512616944504612474278405909277188118896882441812469679494459216431405139478548192152811441169176134750079073317011232934250365454908280676079801770043968006983848495835089055956722848080915898151352242215210071011331098761828031786300276771001839021</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>共模攻击 e1,e2不互素</p>
<p>这里公约数为5，较小，直接开根</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">n= <span class="number">19006830358118902392432453595802675566730850352890246995920642811967821259388009049803513102750594524106471709641202019832682438027312468849299985832675191795417160553379580813410722359089872519372049229233732405993062464286888889084640878784209014165871696882564834896322508054231777967011195636564463806270998326936161449009988434249178477100127347406759932149010712091376183710135615375272671888541233275415737155953323133439644529709898791881795186775830217884663044495979067807418758455237701315019683802437323177125493076113419739827430282311018083976114158159925450746712064639569301925672742186294237113199023</span></span><br><span class="line">c1= <span class="number">276245243658976720066605903875366763552720328374098965164676247771817997950424168480909517684516498439306387133611184795758628248588201187138612090081389226321683486308199743311842513053259894661221013008371261704678716150646764446208833447643781574516045641493770778735363586857160147826684394417412837449465273160781074676966630398315417741542529612480836572205781076576325382832502694868883931680720558621770570349864399879523171995953720198118660355479626037129047327185224203109006251809257919143284157354935005710902589809259500117996982503679601132486140677013625335552533104471327456798955341220640782369529</span></span><br><span class="line">c2= <span class="number">11734019659226247713821792108026989060106712358397514827024912309860741729438494689480531875833287268454669859568719053896346471360750027952226633173559594064466850413737504267807599435679616522026241111887294138123201104718849744300769676961585732810579953221056338076885840743126397063074940281522137794340822594577352361616598702143477379145284687427705913831885493512616944504612474278405909277188118896882441812469679494459216431405139478548192152811441169176134750079073317011232934250365454908280676079801770043968006983848495835089055956722848080915898151352242215210071011331098761828031786300276771001839021</span></span><br><span class="line">e1=<span class="number">55</span></span><br><span class="line">e2=<span class="number">200</span></span><br><span class="line">s,s1,s2 = gmpy2.gcdext(e1,e2)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">m = <span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n)%n</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(libnum.nroot(m,s))))</span><br><span class="line"><span class="comment"># SICTF&#123;S0_Great_RSA_Have_Y0u_Learned?&#125;</span></span><br></pre></td></tr></table></figure>
<p>如果 e1,e2存在极大的公约数，且有e3</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e1e2,s1,s2 = gmpy2.gcdext(e1,e2)</span><br><span class="line">c12 = <span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n)%n</span><br><span class="line"></span><br><span class="line">e2e3,s2,s3 = gmpy2.gcdext(e1,e2)</span><br><span class="line">c23 = <span class="built_in">pow</span>(c2,s2,n)*<span class="built_in">pow</span>(c3,s3,n)%n</span><br><span class="line"></span><br><span class="line">s12,s23,gcd = gmpy2.gcdext(e1e2,e2e3)</span><br><span class="line">m = <span class="built_in">pow</span>(c12,s12,n)*<span class="built_in">pow</span>(c23,s23,n1)%n</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure>
<h2 id="gggcccddd"><a href="#gggcccddd" class="headerlink" title="gggcccddd"></a>gggcccddd</h2><blockquote>
<p>出题人：3tefanie</p>
</blockquote>
<p>附件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(<span class="number">233</span>*m+<span class="number">9527</span>,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;c1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 71451784354488078832557440841067139887532820867160946146462765529262021756492415597759437645000198746438846066445835108438656317936511838198860210224738728502558420706947533544863428802654736970469313030584334133519644746498781461927762736769115933249195917207059297145965502955615599481575507738939188415191</span></span><br><span class="line"><span class="string">c1 = 60237305053182363686066000860755970543119549460585763366760183023969060529797821398451174145816154329258405143693872729068255155086734217883658806494371105889752598709446068159151166250635558774937924668506271624373871952982906459509904548833567117402267826477728367928385137857800256270428537882088110496684</span></span><br><span class="line"><span class="string">c2 = 20563562448902136824882636468952895180253983449339226954738399163341332272571882209784996486250189912121870946577915881638415484043534161071782387358993712918678787398065688999810734189213904693514519594955522460151769479515323049821940285408228055771349670919587560952548876796252634104926367078177733076253</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>一眼 Franklin-Reiter（太慢了）</p>
<p>所以我用half gcd</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> shared.polynomial <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">71451784354488078832557440841067139887532820867160946146462765529262021756492415597759437645000198746438846066445835108438656317936511838198860210224738728502558420706947533544863428802654736970469313030584334133519644746498781461927762736769115933249195917207059297145965502955615599481575507738939188415191</span></span><br><span class="line">c1 = <span class="number">60237305053182363686066000860755970543119549460585763366760183023969060529797821398451174145816154329258405143693872729068255155086734217883658806494371105889752598709446068159151166250635558774937924668506271624373871952982906459509904548833567117402267826477728367928385137857800256270428537882088110496684</span></span><br><span class="line">c2 = <span class="number">20563562448902136824882636468952895180253983449339226954738399163341332272571882209784996486250189912121870946577915881638415484043534161071782387358993712918678787398065688999810734189213904693514519594955522460151769479515323049821940285408228055771349670919587560952548876796252634104926367078177733076253</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">P = Zmod(n)[<span class="string">&quot;x&quot;</span>]</span><br><span class="line">x = P.gen()</span><br><span class="line">f = x**e - c1</span><br><span class="line">g = (<span class="number">233</span>*x+<span class="number">9527</span>) ** e - c2</span><br><span class="line">h = fast_polynomial_gcd(f, g)</span><br><span class="line">m = -h[<span class="number">0</span>] // h[<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># SICTF&#123;45115fb2-84d6-4369-88c2-c8c3d72b4c55&#125;</span></span><br></pre></td></tr></table></figure>
<p>或者这个脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HGCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">2</span> * b.degree() &lt;= a.degree() <span class="keyword">or</span> a.degree() == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    m = a.degree() // <span class="number">2</span></span><br><span class="line">    a_top, a_bot = a.quo_rem(x^m)</span><br><span class="line">    b_top, b_bot = b.quo_rem(x^m)</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a_top, b_top)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    q, e = c.quo_rem(d)</span><br><span class="line">    d_top, d_bot = d.quo_rem(x^(m // <span class="number">2</span>))</span><br><span class="line">    e_top, e_bot = e.quo_rem(x^(m // <span class="number">2</span>))</span><br><span class="line">    S00, S01, S10, S11 = HGCD(d_top, e_top)</span><br><span class="line">    RET00 = S01 * R00 + (S00 - q * S01) * R10</span><br><span class="line">    RET01 = S01 * R01 + (S00 - q * S01) * R11</span><br><span class="line">    RET10 = S11 * R00 + (S10 - q * S11) * R10</span><br><span class="line">    RET11 = S11 * R01 + (S10 - q * S11) * R11</span><br><span class="line">    <span class="keyword">return</span> RET00, RET01, RET10, RET11</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="built_in">print</span>(a.degree(), b.degree())</span><br><span class="line">    q, r = a.quo_rem(b)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a, b)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    <span class="keyword">if</span> d == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> c.monic()</span><br><span class="line">    q, r = c.quo_rem(d)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> GCD(d, r)</span><br><span class="line"></span><br><span class="line">sys.setrecursionlimit(<span class="number">500000</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">71451784354488078832557440841067139887532820867160946146462765529262021756492415597759437645000198746438846066445835108438656317936511838198860210224738728502558420706947533544863428802654736970469313030584334133519644746498781461927762736769115933249195917207059297145965502955615599481575507738939188415191</span></span><br><span class="line">c1 = <span class="number">60237305053182363686066000860755970543119549460585763366760183023969060529797821398451174145816154329258405143693872729068255155086734217883658806494371105889752598709446068159151166250635558774937924668506271624373871952982906459509904548833567117402267826477728367928385137857800256270428537882088110496684</span></span><br><span class="line">c2 = <span class="number">20563562448902136824882636468952895180253983449339226954738399163341332272571882209784996486250189912121870946577915881638415484043534161071782387358993712918678787398065688999810734189213904693514519594955522460151769479515323049821940285408228055771349670919587560952548876796252634104926367078177733076253</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x^e - c1</span><br><span class="line">g = (<span class="number">233</span>*x+<span class="number">9527</span>)^e - c2</span><br><span class="line"></span><br><span class="line">res = GCD(f,g)</span><br><span class="line"></span><br><span class="line">m = -res.monic().coefficients()[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># SICTF&#123;45115fb2-84d6-4369-88c2-c8c3d72b4c55&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="铜匠"><a href="#铜匠" class="headerlink" title="*铜匠"></a>*铜匠</h2><blockquote>
<p>出题人：3tefanie</p>
</blockquote>
<p>附件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Decimal_conversion</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    digits = []</span><br><span class="line">    <span class="keyword">while</span> num:</span><br><span class="line">        digits.append(<span class="built_in">str</span>(num % <span class="number">5</span>))</span><br><span class="line">        num //= <span class="number">5</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">reversed</span>(digits))</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;leak = <span class="subst">&#123;Decimal_conversion(p)[:<span class="number">112</span>]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">leak = 2011133132443111302000224204142244403203442000141102312242343143241244243020003333022112141220422134444214010012</span></span><br><span class="line"><span class="string">n = 85988668134257353631742597258304937106964673395852009846703777410474172989069717247424903079500594820235304351355706519069516847244761609583338251489134035212061654870087550317540291994559481862615812258493738064606592165529948648774081655902831715928483206013332330998262897765489820121129058926463847702821</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 64708526479058278743788046708923650158905888858865427385501446781738669889375403360886995849554813207230509920789341593771929287415439407977283018525484281064769128358863513387658744063469874845446480637925790150835186431234289848506337341595817156444941964510251032210939739594241869190746437858135599624562</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<hr>
<p>爆不出来，只能写一下思路了</p>
<p>p转5进制给出前112位，经过测试，可以补零得到高位</p>
<p>猜测进位差，舍弃三到四位，爆破八到九位就可解，实际没出来，</p>
<p>最后猜测可能要五进制的形式解这题，不会写脚本，g</p>
<hr>
<p>以五进制的形式爆破：</p>
<p>求解未知bit的理论上界</p>
<p>$p_{未知位数}&lt;n^{\frac{\beta^2}{d}-\epsilon}$   </p>
<p>$epsilon = \epsilon $ </p>
<p>d 是造的多项式的度，这个多项式x是变量，度为1</p>
<p>n就是大数 n</p>
<p>$beta=\beta$ </p>
<p>beta是指copper理想的模数大于实际模数的多少次幂</p>
<p>如此题，理想模数是p，实际模数是 n， $p&gt;n^{0.49}$ </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">t = <span class="number">0.5</span>*getPrime(<span class="number">1024</span>)**(<span class="number">0.49</span>**<span class="number">2</span>-<span class="number">0.01</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Decimal_conversion</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    digits = []</span><br><span class="line">    <span class="keyword">while</span> num:</span><br><span class="line">        digits.append(<span class="built_in">str</span>(num % <span class="number">5</span>))</span><br><span class="line">        num //= <span class="number">5</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">reversed</span>(digits))</span><br><span class="line"></span><br><span class="line">cc = Decimal_conversion(<span class="built_in">int</span>(t))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(cc))</span><br><span class="line"><span class="comment"># 102</span></span><br></pre></td></tr></table></figure>
<p>可以看到未知位数的理论上界是102，而我们未知位数有109位，理论上要爆破7位</p>
<p>不过copper一般界会松散一点，从低位开始试试</p>
<p>这里爆破两位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">leak = <span class="string">&quot;2011133132443111302000224204142244403203442000141102312242343143241244243020003333022112141220422134444214010012&quot;</span></span><br><span class="line">n = <span class="number">85988668134257353631742597258304937106964673395852009846703777410474172989069717247424903079500594820235304351355706519069516847244761609583338251489134035212061654870087550317540291994559481862615812258493738064606592165529948648774081655902831715928483206013332330998262897765489820121129058926463847702821</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">64708526479058278743788046708923650158905888858865427385501446781738669889375403360886995849554813207230509920789341593771929287415439407977283018525484281064769128358863513387658744063469874845446480637925790150835186431234289848506337341595817156444941964510251032210939739594241869190746437858135599624562</span></span><br><span class="line"></span><br><span class="line">ph = <span class="built_in">int</span>(leak+(<span class="number">221</span>-<span class="number">112</span>)*<span class="string">&quot;0&quot;</span>,<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">5</span>^<span class="number">2</span>):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f = ph + <span class="number">5</span>^<span class="number">2</span>*x + i</span><br><span class="line">    f = f.monic()</span><br><span class="line">    res = f.small_roots(beta = <span class="number">0.49</span>,X = <span class="number">5</span>^(<span class="number">109</span>-<span class="number">2</span>),epsilon = <span class="number">0.01</span>)</span><br><span class="line">    <span class="keyword">if</span> res:</span><br><span class="line">        p = ph + <span class="number">5</span>^<span class="number">2</span>*res[<span class="number">0</span>] + i</span><br><span class="line">        <span class="built_in">print</span>(p)</span><br><span class="line">p = <span class="number">12170789707638469557363249767228204966074269830454332436369564884472290413677820876733675261757160662428920138919536054003455470370040518528641001253487453</span></span><br><span class="line">q = n // p</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(m)	</span><br><span class="line">	</span><br><span class="line"><span class="comment">#SICTF&#123;1d213ffc-d5dc-42d0-b206-e9a0c1a3cb69&#125;</span></span><br></pre></td></tr></table></figure>
<hr>
<p>最开始以十进制的形式爆破没出可能是因为5进制转成十进制出了问题</p>
<p>5进制转成十进制：$temp =\sum_{i}^{n}x*5^i $ </p>
<p>抹3位，也就是从109位开始 ，即 i=109</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">leak = <span class="string">&quot;2011133132443111302000224204142244403203442000141102312242343143241244243020003333022112141220422134444214010012&quot;</span></span><br><span class="line">n = <span class="number">85988668134257353631742597258304937106964673395852009846703777410474172989069717247424903079500594820235304351355706519069516847244761609583338251489134035212061654870087550317540291994559481862615812258493738064606592165529948648774081655902831715928483206013332330998262897765489820121129058926463847702821</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">64708526479058278743788046708923650158905888858865427385501446781738669889375403360886995849554813207230509920789341593771929287415439407977283018525484281064769128358863513387658744063469874845446480637925790150835186431234289848506337341595817156444941964510251032210939739594241869190746437858135599624562</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">five_to_ten</span>(<span class="params">num</span>):</span><br><span class="line">    temp = <span class="number">0</span></span><br><span class="line">    i = <span class="number">109</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">reversed</span>(num):</span><br><span class="line">        temp += <span class="built_in">int</span>(j) * <span class="number">5</span>**i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> temp</span><br><span class="line"></span><br><span class="line">leak = five_to_ten(leak)</span><br><span class="line">gift = leak &gt;&gt; <span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>^<span class="number">8</span>):</span><br><span class="line">    ph = gift &lt;&lt; <span class="number">8</span></span><br><span class="line">    phigh = ph + i</span><br><span class="line">    phigh = phigh &lt;&lt; <span class="number">248</span></span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f = phigh + x</span><br><span class="line">    res = f.small_roots(X=<span class="number">2</span>^<span class="number">248</span>, beta=<span class="number">0.4</span>, epsilon=<span class="number">0.01</span>)</span><br><span class="line">    <span class="keyword">if</span> res != []:</span><br><span class="line">        p = phigh + <span class="built_in">int</span>(res[<span class="number">0</span>])</span><br><span class="line">        q = n // p</span><br><span class="line">        d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;i = <span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># SICTF&#123;1d213ffc-d5dc-42d0-b206-e9a0c1a3cb69&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="BabyRSA"><a href="#BabyRSA" class="headerlink" title="*BabyRSA"></a>*BabyRSA</h2><blockquote>
<p>出题人：Kicky_Mu</p>
</blockquote>
<p>附件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">p = random_prime(<span class="number">1</span>&lt;&lt;<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;ffllaagg.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = <span class="built_in">int</span>.from_bytes(f.read().strip(), <span class="string">&quot;big&quot;</span>)</span><br><span class="line"><span class="keyword">assert</span> flag &lt; p</span><br><span class="line"></span><br><span class="line">a = randint(<span class="number">2</span>, p-<span class="number">1</span>)</span><br><span class="line">b = randint(<span class="number">2</span>, p-<span class="number">1</span>)</span><br><span class="line">x = randint(<span class="number">2</span>, p-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">h</span>():</span><br><span class="line">    <span class="keyword">global</span> a, b, x</span><br><span class="line">    x = (a*x + b) % p</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">PR.&lt;X&gt; = PolynomialRing(GF(p))</span><br><span class="line">f = h() + h()*X + h()*X**<span class="number">2</span> + h()*X**<span class="number">3</span> + h()*X**<span class="number">4</span> + h()*X**<span class="number">5</span></span><br><span class="line">v_me_50 = [(i, f(i)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">5</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(v_me_50)</span><br><span class="line"><span class="built_in">print</span>(f(flag))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">8432316544210923620966806031040552674652729976238765323782536889706914762471638598119051165931563126522925761119650997703305509546949570434637437942542827</span></span><br><span class="line">v_me_50 = [(<span class="number">1</span>, <span class="number">5237331460408741346823741966490617418367283531029963248255318507187035341590236835730694472064897540292182231844047116067936691956970631907605500080014355</span>), (<span class="number">2</span>, <span class="number">5798977431976767515500795413771120575460553181185728489626756434911307088093739452469315524092208822863785429164219547384598943937099787390543171055679780</span>), (<span class="number">3</span>, <span class="number">5030862375386942201139427367618716490378481408210696947331523552250206476805124204780313138835912303941204343248384742875319182761611109448446270069831113</span>), (<span class="number">4</span>, <span class="number">4705360705603328842229554954026497175574981026785287316439514185860486128679614980330307863925942038530792583274904352630757089631411920876914529907563209</span>)]</span><br><span class="line">f_flag = <span class="number">7251453750672416392395590357197330390627853878488142305852099080761477796591562813165554150640801022882531891827653530623183405183605476913024545431842867</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>给了四个lcg用来求a、b、x</p>
<p><img data-src="https://cdn.jsdelivr.net/gh/Wbuildings/hexoimage/imagesimage-20240226033053986.png" alt="image-20240226033053986"></p>
<p>以为给了四个式子来求六个未知数，因为是lcg，实际每个$x_i$ 都可以用a、b、x代替，也即 四个式子解三个未知数（都在 模 p下），所以用sage的groebner_basis 来求<br>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">8432316544210923620966806031040552674652729976238765323782536889706914762471638598119051165931563126522925761119650997703305509546949570434637437942542827</span></span><br><span class="line">c = [(<span class="number">1</span>, <span class="number">5237331460408741346823741966490617418367283531029963248255318507187035341590236835730694472064897540292182231844047116067936691956970631907605500080014355</span>), (<span class="number">2</span>, <span class="number">5798977431976767515500795413771120575460553181185728489626756434911307088093739452469315524092208822863785429164219547384598943937099787390543171055679780</span>), (<span class="number">3</span>, <span class="number">5030862375386942201139427367618716490378481408210696947331523552250206476805124204780313138835912303941204343248384742875319182761611109448446270069831113</span>), (<span class="number">4</span>, <span class="number">4705360705603328842229554954026497175574981026785287316439514185860486128679614980330307863925942038530792583274904352630757089631411920876914529907563209</span>)]</span><br><span class="line">enc_flag = <span class="number">7251453750672416392395590357197330390627853878488142305852099080761477796591562813165554150640801022882531891827653530623183405183605476913024545431842867</span></span><br><span class="line"></span><br><span class="line">PR.&lt;a,b,x&gt; = PolynomialRing(GF(p))</span><br><span class="line"></span><br><span class="line">L = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    x = a*x+b</span><br><span class="line">    L.append(x)</span><br><span class="line"></span><br><span class="line">f1 = L[<span class="number">0</span>]+L[<span class="number">1</span>]+L[<span class="number">2</span>]+L[<span class="number">3</span>]+L[<span class="number">4</span>]+L[<span class="number">5</span>]-c[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">f2 = L[<span class="number">0</span>]+L[<span class="number">1</span>]*<span class="number">2</span>+L[<span class="number">2</span>]*<span class="number">2</span>^<span class="number">2</span>+L[<span class="number">3</span>]*<span class="number">2</span>^<span class="number">3</span>+L[<span class="number">4</span>]*<span class="number">2</span>^<span class="number">4</span>+L[<span class="number">5</span>]*<span class="number">2</span>^<span class="number">5</span>-c[<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">f3 = L[<span class="number">0</span>]+L[<span class="number">1</span>]*<span class="number">3</span>+L[<span class="number">2</span>]*<span class="number">3</span>^<span class="number">2</span>+L[<span class="number">3</span>]*<span class="number">3</span>^<span class="number">3</span>+L[<span class="number">4</span>]*<span class="number">3</span>^<span class="number">4</span>+L[<span class="number">5</span>]*<span class="number">3</span>^<span class="number">5</span>-c[<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">f4 = L[<span class="number">0</span>]+L[<span class="number">1</span>]*<span class="number">4</span>+L[<span class="number">2</span>]*<span class="number">4</span>^<span class="number">2</span>+L[<span class="number">3</span>]*<span class="number">4</span>^<span class="number">3</span>+L[<span class="number">4</span>]*<span class="number">4</span>^<span class="number">4</span>+L[<span class="number">5</span>]*<span class="number">4</span>^<span class="number">5</span>-c[<span class="number">3</span>][<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">res = Ideal([f1,f2,f3,f4]).groebner_basis()</span><br><span class="line"></span><br><span class="line">a = -res[<span class="number">0</span>].coefficients()[<span class="number">1</span>]</span><br><span class="line">b = -res[<span class="number">1</span>].coefficients()[<span class="number">1</span>]</span><br><span class="line">x = -res[<span class="number">2</span>].coefficients()[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">L = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    x = a*x+b</span><br><span class="line">    L.append(x)</span><br><span class="line">    </span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(GF(p))</span><br><span class="line">f = L[<span class="number">0</span>]+L[<span class="number">1</span>]*x+L[<span class="number">2</span>]*x^<span class="number">2</span>+L[<span class="number">3</span>]*x^<span class="number">3</span>+L[<span class="number">4</span>]*x^<span class="number">4</span>+L[<span class="number">5</span>]*x^<span class="number">5</span>-enc_flag</span><br><span class="line">roots = f.roots()</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(roots[<span class="number">0</span>][<span class="number">0</span>])))</span><br><span class="line"><span class="comment"># SICTF&#123;Th3s_1s_a_high_l3vel_p0lyn0mial&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="进阶-easy-or-baby-RSA"><a href="#进阶-easy-or-baby-RSA" class="headerlink" title="*[进阶]easy_or_baby_RSA"></a>*[进阶]easy_or_baby_RSA</h2><blockquote>
<p>出题人：3tefanie</p>
<p>hint：论文地址：<span class="exturl" data-url="aHR0cHM6Ly93d3QubGFuem91dC5jb20vaTdsVTAxb215OHVm">https://wwt.lanzout.com/i7lU01omy8uf<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<p>附件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">q = getPrime(<span class="number">256</span>)</span><br><span class="line">n = (p**<span class="number">5</span>)*(q**<span class="number">3</span>)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*p**<span class="number">4</span> * q**<span class="number">2</span></span><br><span class="line">d = getPrime(<span class="number">1380</span>)</span><br><span class="line">e = gmpy2.invert(d,phi)</span><br><span class="line">p1 = gmpy2.next_prime(p)</span><br><span class="line">q1 = gmpy2.next_prime(q)</span><br><span class="line">c = <span class="built_in">pow</span>(m,<span class="number">65537</span>,p1*q1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 6027704939934795526809476320408984749353451163184148193613218899917989403800738729505135647560822568147775955030636790796412038749080589962404088890138</span></span><br><span class="line"><span class="string">n = 2345049742327685796181532105032554795628696111708534285951012187089560814230641663133312117797131139088986342455315166062482479446527815702735474197358418746066993291802284464812612727625991647573889402281825863578807474887341632160586307943897790827019291411639756252138594856687013363652094621849674259604512491449809337670874218320926522274379234396955495643125680407916326561528774056618181536326260093822819468635513422755218190798616168156924793527386350080400722536575372660262573683231490166520738579903818495107264328324326819989553511070207494208500239603511665056894947107356065440333537271115434438827753</span></span><br><span class="line"><span class="string">e = 1560967245790387854530279132085915310737094193704812456970549221459036227794862560384548159924112528879771688534015861357630951162558357151823378870345945435342412220708167081427844035498174919749839232806280901968067512188264340755833308035745702731211924571583963089915893479992177245815565483658484702813753029786985027579475059989141119719224961817402605977566829967197490932672021566512826377376988752959467389833419735737545201988916590880487156074463948048461415870071893002222885078350961871888123567241990517365430474025391208925638731208820904957752596249597885523540692851123131898267246576902438472358221</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>paper题</p>
<p>特点是 $n=p^rq^s$ ，可以根据 注释里的调参</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bound,r,s,N,m</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    small private d RSA with moduli N=p^r*q^s,that d &lt; 1-(3*r+s)/(r+s)^2 - eps</span></span><br><span class="line"><span class="string">    the eps is</span></span><br><span class="line"><span class="string">    ((15*s+1)*r^4-(2*s^2-10*s)*r^3-(s^3-6*s^2+8*s)*r^2+(2*s^3-12*s^2+6*s)*r+s^4-4*s^3+s^2)</span></span><br><span class="line"><span class="string">    /(4*m*(r-s)*(r+s)^3) in theory,by this we can choose the proper m which is lower than theory.</span></span><br><span class="line"><span class="string">    return : one factor of N.you can factor N by this</span></span><br><span class="line"><span class="string">    for example:</span></span><br><span class="line"><span class="string">    p,q : 256</span></span><br><span class="line"><span class="string">    r,s : 5,3</span></span><br><span class="line"><span class="string">    d : 1300,m = 9</span></span><br><span class="line"><span class="string">    d : 1350,m = 14</span></span><br><span class="line"><span class="string">    d : 1360,m = 20</span></span><br><span class="line"><span class="string">    d : 1370,m = 30</span></span><br><span class="line"><span class="string">    d &gt; 1370,m = 40 # spend long time to do this(2800s)</span></span><br><span class="line"><span class="string">    you can choose the larger m to approach the theory solution</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    t1 = <span class="built_in">int</span>((r*(r+s-<span class="number">2</span>))/((r-<span class="number">1</span>)*(r+s))*m)</span><br><span class="line">    t2 = m</span><br><span class="line">    bounds = [bound ,<span class="number">1</span>]</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    x = f.variables()[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(t2+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t2+<span class="number">1</span>-k):</span><br><span class="line">            d=<span class="built_in">max</span>([<span class="number">0</span>,ceil((r-<span class="number">1</span>)*(t1-k)/r),ceil((s-<span class="number">1</span>)*(t2-k)/s)])</span><br><span class="line">            base=N ^ d * f ^ k * x ^ i</span><br><span class="line">            G.append(base)</span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"><span class="comment">#     B = flatter(B)</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    another question is can&#x27;t use flatter because flatter not support </span></span><br><span class="line"><span class="string">    the matrix that its row far greater than its cols</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> h.coefficients():</span><br><span class="line">            <span class="keyword">if</span> gcd(i,N)!=<span class="number">1</span> <span class="keyword">and</span> gcd(i,N)!=N:</span><br><span class="line">                <span class="keyword">return</span> gcd(h.coefficients()[<span class="number">0</span>],N)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">6027704939934795526809476320408984749353451163184148193613218899917989403800738729505135647560822568147775955030636790796412038749080589962404088890138</span></span><br><span class="line">n = <span class="number">2345049742327685796181532105032554795628696111708534285951012187089560814230641663133312117797131139088986342455315166062482479446527815702735474197358418746066993291802284464812612727625991647573889402281825863578807474887341632160586307943897790827019291411639756252138594856687013363652094621849674259604512491449809337670874218320926522274379234396955495643125680407916326561528774056618181536326260093822819468635513422755218190798616168156924793527386350080400722536575372660262573683231490166520738579903818495107264328324326819989553511070207494208500239603511665056894947107356065440333537271115434438827753</span></span><br><span class="line">e = <span class="number">1560967245790387854530279132085915310737094193704812456970549221459036227794862560384548159924112528879771688534015861357630951162558357151823378870345945435342412220708167081427844035498174919749839232806280901968067512188264340755833308035745702731211924571583963089915893479992177245815565483658484702813753029786985027579475059989141119719224961817402605977566829967197490932672021566512826377376988752959467389833419735737545201988916590880487156074463948048461415870071893002222885078350961871888123567241990517365430474025391208925638731208820904957752596249597885523540692851123131898267246576902438472358221</span></span><br><span class="line"></span><br><span class="line">r,s=<span class="number">5</span>,<span class="number">3</span></span><br><span class="line">edge = <span class="number">1380</span></span><br><span class="line">a= -<span class="built_in">int</span>(inverse(e,n)) %n</span><br><span class="line">PR.&lt;x,y&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f=a-x</span><br><span class="line">m=<span class="number">40</span></span><br><span class="line">res=small_roots(f, <span class="number">2</span>^edge,r,s,n,m)</span><br><span class="line"><span class="built_in">print</span>(res) <span class="comment"># 3880841886154333953773650424963616396441043690868788265611642694520916610789745536631157643368280831495777902173955747450998897753151868119085453880516169</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这次求出的不是素数，拿去分解一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c = <span class="number">6027704939934795526809476320408984749353451163184148193613218899917989403800738729505135647560822568147775955030636790796412038749080589962404088890138</span></span><br><span class="line">n = <span class="number">2345049742327685796181532105032554795628696111708534285951012187089560814230641663133312117797131139088986342455315166062482479446527815702735474197358418746066993291802284464812612727625991647573889402281825863578807474887341632160586307943897790827019291411639756252138594856687013363652094621849674259604512491449809337670874218320926522274379234396955495643125680407916326561528774056618181536326260093822819468635513422755218190798616168156924793527386350080400722536575372660262573683231490166520738579903818495107264328324326819989553511070207494208500239603511665056894947107356065440333537271115434438827753</span></span><br><span class="line">e = <span class="number">1560967245790387854530279132085915310737094193704812456970549221459036227794862560384548159924112528879771688534015861357630951162558357151823378870345945435342412220708167081427844035498174919749839232806280901968067512188264340755833308035745702731211924571583963089915893479992177245815565483658484702813753029786985027579475059989141119719224961817402605977566829967197490932672021566512826377376988752959467389833419735737545201988916590880487156074463948048461415870071893002222885078350961871888123567241990517365430474025391208925638731208820904957752596249597885523540692851123131898267246576902438472358221</span></span><br><span class="line"></span><br><span class="line">q=<span class="number">62296403476880862016690545256535671712771160075146460730605631039440772133987</span></span><br><span class="line"></span><br><span class="line">p=<span class="built_in">int</span>(gmpy2.iroot(n//q**<span class="number">3</span>,<span class="number">5</span>)[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">assert</span> n==p**<span class="number">5</span>*q**<span class="number">3</span></span><br><span class="line">p1 = gmpy2.next_prime(p)</span><br><span class="line">q1 = gmpy2.next_prime(q)</span><br><span class="line">d=inverse(<span class="number">65537</span>,(p1-<span class="number">1</span>)*(q1-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,p1*q1)))</span><br><span class="line"><span class="comment"># SICTF&#123;4d41abf4-c48a-4b82-aefe-0e05d59933a0&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="进阶-2024-New-Setback"><a href="#进阶-2024-New-Setback" class="headerlink" title="*[进阶]2024_New_Setback"></a>*[进阶]2024_New_Setback</h2><blockquote>
<p>出题人：Kicky_Mu</p>
</blockquote>
<p>附件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#user:mumu666</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, Curve</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">happy</span>(<span class="params">C, P</span>):</span><br><span class="line">    c, d, p = C</span><br><span class="line">    u, v = P</span><br><span class="line">    <span class="keyword">return</span> (u**<span class="number">2</span> + v**<span class="number">2</span> - c**<span class="number">2</span> * (<span class="number">1</span> + d * u**<span class="number">2</span>*v**<span class="number">2</span>)) % p == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">C, P, Q</span>):</span><br><span class="line">    c, d, p = C</span><br><span class="line">    u1, v1 = P</span><br><span class="line">    u2, v2 = Q</span><br><span class="line">    <span class="keyword">assert</span> happy(C, P) <span class="keyword">and</span> happy(C, Q)</span><br><span class="line">    u3 = (u1 * v2 + v1 * u2) * inverse(c * (<span class="number">1</span> + d * u1 * u2 * v1 * v2), p) % p</span><br><span class="line">    v3 = (v1 * v2 - u1 * u2) * inverse(c * (<span class="number">1</span> - d * u1 * u2 * v1 * v2), p) % p</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">int</span>(u3), <span class="built_in">int</span>(v3))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">year</span>(<span class="params">C, P, m</span>):</span><br><span class="line">    <span class="keyword">assert</span> happy(C, P)</span><br><span class="line">    c, d, p = C</span><br><span class="line">    B = <span class="built_in">bin</span>(m)[<span class="number">2</span>:]</span><br><span class="line">    l = <span class="built_in">len</span>(B)</span><br><span class="line">    u, v = P</span><br><span class="line">    PP = (-u, v)</span><br><span class="line">    O = new(C, P, PP)</span><br><span class="line">    Q = O</span><br><span class="line">    <span class="keyword">if</span> m == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> O</span><br><span class="line">    <span class="keyword">elif</span> m == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> P</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l-<span class="number">1</span>):</span><br><span class="line">            P = new(C, P, P)</span><br><span class="line">        m = m - <span class="number">2</span>**(l-<span class="number">1</span>)</span><br><span class="line">        Q, P = P, (u, v)</span><br><span class="line">        <span class="keyword">return</span> new(C, Q, year(C, P, m))</span><br><span class="line"></span><br><span class="line">c, d, p = Curve</span><br><span class="line"></span><br><span class="line">flag = flag.lstrip(<span class="string">b&#x27;SICTF&#123;&#x27;</span>).rstrip(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">l = <span class="built_in">len</span>(flag)</span><br><span class="line">l_flag, r_flag = flag[:l // <span class="number">2</span>], flag[l // <span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">m1, m2 = bytes_to_long(l_flag), bytes_to_long(r_flag)</span><br><span class="line"><span class="keyword">assert</span> m1 &lt; p <span class="keyword">and</span> m2 &lt; p</span><br><span class="line"></span><br><span class="line">P = (<span class="number">398011447251267732058427934569710020713094</span>, <span class="number">548950454294712661054528329798266699762662</span>)</span><br><span class="line">Q = (<span class="number">139255151342889674616838168412769112246165</span>, <span class="number">649791718379009629228240558980851356197207</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;happy(C, P) = <span class="subst">&#123;happy(Curve, P)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;happy(C, Q) = <span class="subst">&#123;happy(Curve, Q)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;P = <span class="subst">&#123;P&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Q = <span class="subst">&#123;Q&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;m1 * P = <span class="subst">&#123;year(Curve, P, m1)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;m2 * Q = <span class="subst">&#123;year(Curve, Q, m2)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">happy(C, P) = True</span></span><br><span class="line"><span class="string">happy(C, Q) = True</span></span><br><span class="line"><span class="string">P = (398011447251267732058427934569710020713094, 548950454294712661054528329798266699762662)</span></span><br><span class="line"><span class="string">Q = (139255151342889674616838168412769112246165, 649791718379009629228240558980851356197207)</span></span><br><span class="line"><span class="string">m1 * P = (730393937659426993430595540476247076383331, 461597565155009635099537158476419433012710)</span></span><br><span class="line"><span class="string">m2 * Q = (500532897653416664117493978883484252869079, 620853965501593867437705135137758828401933) </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>这里先求曲线的参数<code>c，d，p</code> </p>
<p>同 BabyRSA ，四个点得到四个多项式方程，再次 groebner_basis </p>
<p>会出现问题，发现 <code>p</code> 有两个小因子，处理掉</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">P = (<span class="number">398011447251267732058427934569710020713094</span>, <span class="number">548950454294712661054528329798266699762662</span>)</span><br><span class="line">Q = (<span class="number">139255151342889674616838168412769112246165</span>, <span class="number">649791718379009629228240558980851356197207</span>)</span><br><span class="line">C1 = (<span class="number">730393937659426993430595540476247076383331</span>, <span class="number">461597565155009635099537158476419433012710</span>)</span><br><span class="line">C2 = (<span class="number">500532897653416664117493978883484252869079</span>, <span class="number">620853965501593867437705135137758828401933</span>) </span><br><span class="line"></span><br><span class="line">PR.&lt;c,d&gt; = PolynomialRing(ZZ)</span><br><span class="line">f1 = P[<span class="number">0</span>]**<span class="number">2</span> + P[<span class="number">1</span>]**<span class="number">2</span> - c**<span class="number">2</span> * (<span class="number">1</span> + d * P[<span class="number">0</span>]**<span class="number">2</span>*P[<span class="number">1</span>]**<span class="number">2</span>)</span><br><span class="line">f2 = Q[<span class="number">0</span>]**<span class="number">2</span> + Q[<span class="number">1</span>]**<span class="number">2</span> - c**<span class="number">2</span> * (<span class="number">1</span> + d * Q[<span class="number">0</span>]**<span class="number">2</span>*Q[<span class="number">1</span>]**<span class="number">2</span>)</span><br><span class="line">f3 = C1[<span class="number">0</span>]**<span class="number">2</span> + C1[<span class="number">1</span>]**<span class="number">2</span> - c**<span class="number">2</span> * (<span class="number">1</span> + d * C1[<span class="number">0</span>]**<span class="number">2</span>*C1[<span class="number">1</span>]**<span class="number">2</span>)</span><br><span class="line">f4 = C2[<span class="number">0</span>]**<span class="number">2</span> + C2[<span class="number">1</span>]**<span class="number">2</span> - c**<span class="number">2</span> * (<span class="number">1</span> + d * C2[<span class="number">0</span>]**<span class="number">2</span>*C2[<span class="number">1</span>]**<span class="number">2</span>)</span><br><span class="line">res = Ideal([f1,f2,f3,f4]).groebner_basis()</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line">p = <span class="number">18983346087633426019400112058348303476269889</span></span><br><span class="line">d = p-<span class="number">1267506405851766513801807982398420823635884</span></span><br><span class="line">c2 = p-<span class="number">11256226422403535024125759760236595858726933</span></span><br><span class="line">p = p//<span class="number">3</span>//<span class="number">7</span></span><br><span class="line">PR.&lt;cc&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = cc^<span class="number">2</span> - c2</span><br><span class="line">c = f.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>朴实无华而又细致无比的出题人的wp：<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vbXVtdWhoaC9wLzE4MDE5MjAw">2024 SICTF Round#3出题 crypto misc osint - Kicky_Mu - 博客园<i class="fa fa-external-link-alt"></i></span></p>
<p>看着复杂实则条理清晰的推理过程</p>
<p>一切准备工作(结论)都已做好的 <font color='orange'>La佬</font> ，直接拿来用即可  :<span class="exturl" data-url="aHR0cHM6Ly9sYXp6emFyby5naXRodWIuaW8vMjAyMS8wMS8yMC9jcnlwdG8t5puy57q/Lw==">曲线<i class="fa fa-external-link-alt"></i></span></p>
<hr>
<p>解题思路：</p>
<ul>
<li><p>将Edcurve通过换元映射，变换为常见的椭圆曲线的形式 (<strong>Edwards ——&gt; Montgomery ——&gt;Weierstrass </strong>)</p>
</li>
<li><p>求Dlp  <code>discrete_log</code> ，（在椭圆曲线中，<code>Q = nP</code> 存在两种意思，一种是标量积，一种是对数）</p>
</li>
</ul>
<hr>
<h3 id="Edwards-Curves-爱德华曲线"><a href="#Edwards-Curves-爱德华曲线" class="headerlink" title="Edwards  Curves(爱德华曲线)"></a>Edwards  Curves(爱德华曲线)</h3><p>一般方程：$x^2+y^2=c^2(1+dx^2y^2)$ </p>
<p>变换：$(\frac{x}{c})^2+(\frac{y}{c})^2=1+(dc^4(\frac{x}{c})^2(\frac{y}{c})^2)=&gt;X^2+Y^2=1+DX^2Y^2$ </p>
<p>其中：$X=\frac{x}{c},Y=\frac{y}{c},D = dc^4$</p>
<p>加法：$(x_1,y_1)+(x_2,y_2)=(\frac{x_1y_2+y_1x_2}{c(1+dx_1x_2y_1y_2)},\frac{y_1y_2-x_1x_2}{c(1-dx_1x_2y_1y_2)})$ </p>
<p>映射：$x^2+y^2=1+dx^2y^2\longmapsto Bv^2=u^3+Au^2+u$   (<strong>Edwards Curve ——&gt; Montgomery Curve</strong>)</p>
<p>其中：</p>
<p>$u=\frac{1+y}{1-y},v=\frac{2(1+y)}{x(1-y)}=\frac{2u}{x}$ </p>
<p>$A=\frac{4}{1-d}-2,B=\frac{1}{1-d}$ </p>
<h3 id="Montgomery-Curves-蒙哥马利曲线"><a href="#Montgomery-Curves-蒙哥马利曲线" class="headerlink" title="Montgomery  Curves(蒙哥马利曲线)"></a>Montgomery  Curves(蒙哥马利曲线)</h3><p>映射：$By^2=x^3+Ax^2+x \longmapsto v^2=u^3+au+b$   （<strong>Montgomery ——-&gt; Weierstrass</strong>)</p>
<p>其中：</p>
<p>$(x,y) \longmapsto (u,v)=(\frac{x}{B}+\frac{A}{3B},\frac{y}{B})$ </p>
<p>$a=\frac{3-A^2}{3B^2},b=\frac{2A^3-9A}{27B^3}$ </p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">P = (<span class="number">398011447251267732058427934569710020713094</span>, <span class="number">548950454294712661054528329798266699762662</span>)</span><br><span class="line">Q = (<span class="number">139255151342889674616838168412769112246165</span>, <span class="number">649791718379009629228240558980851356197207</span>)</span><br><span class="line">C1 = (<span class="number">730393937659426993430595540476247076383331</span>, <span class="number">461597565155009635099537158476419433012710</span>)</span><br><span class="line">C2 = (<span class="number">500532897653416664117493978883484252869079</span>, <span class="number">620853965501593867437705135137758828401933</span>) </span><br><span class="line"></span><br><span class="line">PR.&lt;c,d&gt; = PolynomialRing(ZZ)</span><br><span class="line">f1 = P[<span class="number">0</span>]**<span class="number">2</span> + P[<span class="number">1</span>]**<span class="number">2</span> - c**<span class="number">2</span> * (<span class="number">1</span> + d * P[<span class="number">0</span>]**<span class="number">2</span>*P[<span class="number">1</span>]**<span class="number">2</span>)</span><br><span class="line">f2 = Q[<span class="number">0</span>]**<span class="number">2</span> + Q[<span class="number">1</span>]**<span class="number">2</span> - c**<span class="number">2</span> * (<span class="number">1</span> + d * Q[<span class="number">0</span>]**<span class="number">2</span>*Q[<span class="number">1</span>]**<span class="number">2</span>)</span><br><span class="line">f3 = C1[<span class="number">0</span>]**<span class="number">2</span> + C1[<span class="number">1</span>]**<span class="number">2</span> - c**<span class="number">2</span> * (<span class="number">1</span> + d * C1[<span class="number">0</span>]**<span class="number">2</span>*C1[<span class="number">1</span>]**<span class="number">2</span>)</span><br><span class="line">f4 = C2[<span class="number">0</span>]**<span class="number">2</span> + C2[<span class="number">1</span>]**<span class="number">2</span> - c**<span class="number">2</span> * (<span class="number">1</span> + d * C2[<span class="number">0</span>]**<span class="number">2</span>*C2[<span class="number">1</span>]**<span class="number">2</span>)</span><br><span class="line">res = Ideal([f1,f2,f3,f4]).groebner_basis()</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line">p = <span class="number">18983346087633426019400112058348303476269889</span></span><br><span class="line">d = p-<span class="number">1267506405851766513801807982398420823635884</span></span><br><span class="line">c2 = p-<span class="number">11256226422403535024125759760236595858726933</span></span><br><span class="line">p = p//<span class="number">3</span>//<span class="number">7</span></span><br><span class="line">PR.&lt;cc&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = cc^<span class="number">2</span> - c2</span><br><span class="line">c = f.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">a = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">F = GF(p)</span><br><span class="line">dd = F(d*c^<span class="number">4</span>)</span><br><span class="line">A = F(<span class="number">2</span>) * F(a+dd) / F(a-dd)</span><br><span class="line">B = F(<span class="number">4</span>) / F(a-dd)</span><br><span class="line">a = F(<span class="number">3</span>-A^<span class="number">2</span>) / F(<span class="number">3</span>*B^<span class="number">2</span>)</span><br><span class="line">b = F(<span class="number">2</span>*A^<span class="number">3</span>-<span class="number">9</span>*A) / F(<span class="number">27</span>*B^<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edwards_to_ECC</span>(<span class="params">x,y</span>):</span><br><span class="line">    x1 = F(x) / F(c)</span><br><span class="line">    y1 = F(y) / F(c)</span><br><span class="line">    <span class="comment">#now curve is a*x^2+y^2 = 1+dd*x^2*y^2</span></span><br><span class="line"></span><br><span class="line">    x2 = F(<span class="number">1</span>+y1) / F(<span class="number">1</span>-y1)</span><br><span class="line">    y2 = F(x2) / F(x1)</span><br><span class="line">    <span class="comment">#now curve is By^2 = x^3 + Ax^2 + x</span></span><br><span class="line"></span><br><span class="line">    x3 = (F(<span class="number">3</span>*x2) + F(A)) / F(<span class="number">3</span>*B)</span><br><span class="line">    y3 = F(y2) / F(B)</span><br><span class="line">    <span class="comment">#now curve is y^2 = x^3 + ax + b</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (x3,y3)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ECC_to_edwards</span>(<span class="params">x,y</span>):</span><br><span class="line">    x2 = (F(x) * F(<span class="number">3</span>*B) - F(A)) / F(<span class="number">3</span>)</span><br><span class="line">    y2 = F(y) * F(B)</span><br><span class="line">    <span class="comment">#now curve is By^2 = x^3 + Ax^2 + x</span></span><br><span class="line"></span><br><span class="line">    x1 = F(x2) / F(y2)</span><br><span class="line">    y1 = F(<span class="number">1</span>) - (F(<span class="number">2</span>) / F(x2+<span class="number">1</span>))</span><br><span class="line">    <span class="comment">#now curve is a*x^2+y^2 = 1+dd*x^2*y^2</span></span><br><span class="line"></span><br><span class="line">    x_ = F(x1) * F(c)</span><br><span class="line">    y_ = F(y1) * F(c)</span><br><span class="line">    <span class="comment">#now curve is a*x^2+y^2 = c^2(1+d*x^2*y^2)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (x_,y_)</span><br><span class="line"> </span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">P = E(edwards_to_ECC(P[<span class="number">0</span>],P[<span class="number">1</span>]))</span><br><span class="line">Q = E(edwards_to_ECC(Q[<span class="number">0</span>],Q[<span class="number">1</span>]))</span><br><span class="line">C1 = E(edwards_to_ECC(C1[<span class="number">0</span>],C1[<span class="number">1</span>]))</span><br><span class="line">C2 = E(edwards_to_ECC(C2[<span class="number">0</span>],C2[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">int</span>(P.discrete_log(C1))</span><br><span class="line">m2 = <span class="built_in">int</span>(Q.discrete_log(C2))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m1)+long_to_bytes(m2))</span><br><span class="line"><span class="comment"># #SICTF&#123;nOt_50_3a5Y_Edw4rDs_3LlipT!c_CURv3&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="常见形式的椭圆曲线-Weierstrass-求法：eG-e-G-gx-gy-gx即为flag"><a href="#常见形式的椭圆曲线-Weierstrass-求法：eG-e-G-gx-gy-gx即为flag" class="headerlink" title="常见形式的椭圆曲线(Weierstrass)求法：eG = e*G(gx,gy) (gx即为flag)"></a>常见形式的椭圆曲线(Weierstrass)求法：<code>eG = e*G(gx,gy)</code> (gx即为flag)</h3><p>给出<code>eG、e</code></p>
<p>步骤：</p>
<ul>
<li>用sage中的order()函数求解出该椭圆曲线的阶n</li>
<li>求出e关于阶n的逆元，记为t</li>
<li>求倍点<code>G=t*(eG)</code> ，横坐标即为所求</li>
</ul>
<p>参考：</p>
<p><span class="exturl" data-url="aHR0cHM6Ly90YW5nY3V4aWFvamlrdWFpLnh5ei9wb3N0LzY3OGQ1ZWMuaHRtbA==">2024-SICTF-#Round3-wp-crypto<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9kZXh0ZXJqaWUuZ2l0aHViLmlvLzIwMjQvMDIvMTYv6LWb6aKY5aSN546wL1NJQ1RGcm91bmQzLyPpk5zljKA=">SICTFround3<i class="fa fa-external-link-alt"></i></span></p>

    </div>

    
    
    
<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------　　　　本文结束　<i class="fa fa-flag"></i>　感谢阅读　　　　-------------</div>
    
</div>


        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Wbuildings
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://wbuildings.github.io/Crypto/SICTF-Round-3/" title="SICTF Round#3">https://wbuildings.github.io/Crypto/SICTF-Round-3/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/Wp/" rel="tag"><i class="fa fa-tag"></i> Wp</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/Crypto/ctfshow%E5%85%83%E6%97%A6%E6%B0%B4%E5%8F%8B%E8%8A%82/" rel="prev" title="ctfshow元旦水友节">
      <i class="fa fa-chevron-left"></i> ctfshow元旦水友节
    </a></div>
      <div class="post-nav-item">
    <a href="/%E6%9D%82%E8%AE%B0/Linux-%E9%87%8C%E9%81%87%E5%88%B0%E7%9A%84sage%E9%97%AE%E9%A2%98/" rel="next" title="Linux 里遇到的sage问题">
      Linux 里遇到的sage问题 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0-Vigenere"><span class="nav-number">1.</span> <span class="nav-text">[签到]Vigenere</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0%EF%BC%8C%E7%A1%AE%E4%BF%A1%EF%BC%81"><span class="nav-number">2.</span> <span class="nav-text">签到，确信！</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easyLattice"><span class="nav-number">3.</span> <span class="nav-text">easyLattice</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SuperbRSA"><span class="nav-number">4.</span> <span class="nav-text">SuperbRSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#gggcccddd"><span class="nav-number">5.</span> <span class="nav-text">gggcccddd</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%93%9C%E5%8C%A0"><span class="nav-number">6.</span> <span class="nav-text">*铜匠</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BabyRSA"><span class="nav-number">7.</span> <span class="nav-text">*BabyRSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9B%E9%98%B6-easy-or-baby-RSA"><span class="nav-number">8.</span> <span class="nav-text">*[进阶]easy_or_baby_RSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9B%E9%98%B6-2024-New-Setback"><span class="nav-number">9.</span> <span class="nav-text">*[进阶]2024_New_Setback</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Edwards-Curves-%E7%88%B1%E5%BE%B7%E5%8D%8E%E6%9B%B2%E7%BA%BF"><span class="nav-number">9.1.</span> <span class="nav-text">Edwards  Curves(爱德华曲线)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Montgomery-Curves-%E8%92%99%E5%93%A5%E9%A9%AC%E5%88%A9%E6%9B%B2%E7%BA%BF"><span class="nav-number">9.2.</span> <span class="nav-text">Montgomery  Curves(蒙哥马利曲线)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E5%BD%A2%E5%BC%8F%E7%9A%84%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF-Weierstrass-%E6%B1%82%E6%B3%95%EF%BC%9AeG-e-G-gx-gy-gx%E5%8D%B3%E4%B8%BAflag"><span class="nav-number">9.3.</span> <span class="nav-text">常见形式的椭圆曲线(Weierstrass)求法：eG &#x3D; e*G(gx,gy) (gx即为flag)</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Wbuildings"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Wbuildings</p>
  <div class="site-description" itemprop="description">须知少年凌云志，曾许人间第一流</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span>
  </div>


<!-- recent posts -->

      </div>

      
      <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
      <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
      <div class="widget-wrap">
          <h3 class="widget-title">Tag Cloud</h3>
          <div id="myCanvasContainer" class="widget tagcloud">
              <canvas width="250" height="250" id="resCanvas" style="width=100%">
                  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AES/" rel="tag">AES</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DSA/" rel="tag">DSA</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dual-RSA/" rel="tag">Dual RSA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ECRSA/" rel="tag">ECRSA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HNP/" rel="tag">HNP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LFSR/" rel="tag">LFSR</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LWE/" rel="tag">LWE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lattice/" rel="tag">Lattice</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MITM/" rel="tag">MITM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MT19937/" rel="tag">MT19937</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RSA/" rel="tag">RSA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Schmidt-Samoa/" rel="tag">Schmidt-Samoa</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shamir/" rel="tag">Shamir</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sylvester/" rel="tag">Sylvester</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Wp/" rel="tag">Wp</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sage/" rel="tag">sage</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E5%85%83copper/" rel="tag">二元copper</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/" rel="tag">古典密码</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E7%9F%A5%E8%AF%86/" rel="tag">密码知识</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9B%B2%E7%BA%BF/" rel="tag">曲线</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E8%AE%B0/" rel="tag">杂记</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%B4%A0%E6%95%B0/" rel="tag">素数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%83%8C%E5%8C%85%E5%AF%86%E7%A0%81/" rel="tag">背包密码</a><span class="tag-list-count">2</span></li></ul>
              </canvas>
          </div>
      </div>
      


    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wbuildings</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">1m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">15:51</span>
</div>

  <script>
    var OriginTitle = document.title;
    var titleTime;
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        document.title = '(*^▽^*)我藏好了哦~' + OriginTitle;
        clearTimeout(titleTime);
      } else {
        document.title = 'q(≧▽≦q)被你发现啦~' + OriginTitle;
        titleTime = setTimeout(function() {
          document.title = OriginTitle;
        }, 2000);
      }
    });
  </script>


<script color="24,24,24" opacity="0.5" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  
  <script data-pjax>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













    <div id="pjax">
  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://wbuildings.github.io/Crypto/SICTF-Round-3/',]
      });
      });
  </script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'apuSRwmMMe8HwB5WcdQuox47-gzGzoHsz',
      appKey     : 'MS1uA9PBT4L62Jbrjbh0UEHT',
      placeholder: "在这里写下你的评论吧！",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>


  <script async src="/js/love.min.js"></script>





    </div>
<script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>