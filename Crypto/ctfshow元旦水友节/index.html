<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <link rel="stylesheet" href="https://npm.elemecdn.com/font-awesome/css/font-awesome.min.css"/ media="defer" onload="this.media='all'">
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/avatar.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/avatar.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wbuildings.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="昨夜今朝争几许，共惊年去年来。">
<meta property="og:type" content="article">
<meta property="og:title" content="ctfshow元旦水友节">
<meta property="og:url" content="https://wbuildings.github.io/Crypto/ctfshow%E5%85%83%E6%97%A6%E6%B0%B4%E5%8F%8B%E8%8A%82/index.html">
<meta property="og:site_name" content="W&#39;Blog">
<meta property="og:description" content="昨夜今朝争几许，共惊年去年来。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Wbuildings/hexoimage/imagesdfcc5932fe6f653d3aecf06bf68c422.png">
<meta property="article:published_time" content="2024-02-20T13:09:53.000Z">
<meta property="article:modified_time" content="2024-03-01T12:48:13.465Z">
<meta property="article:author" content="Wbuildings">
<meta property="article:tag" content="Wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Wbuildings/hexoimage/imagesdfcc5932fe6f653d3aecf06bf68c422.png">

<link rel="canonical" href="https://wbuildings.github.io/Crypto/ctfshow%E5%85%83%E6%97%A6%E6%B0%B4%E5%8F%8B%E8%8A%82/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>ctfshow元旦水友节 | W'Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <script defer src="/live2d-widget/autoload.js"></script>
  
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">W'Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Wbuildings的自勉小屋</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">23</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">2</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">30</span></a>

  </li>
        <li class="menu-item menu-item-links">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL1didWlsZGluZ3M=" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wbuildings.github.io/Crypto/ctfshow%E5%85%83%E6%97%A6%E6%B0%B4%E5%8F%8B%E8%8A%82/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Wbuildings">
      <meta itemprop="description" content="须知少年凌云志，曾许人间第一流">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="W'Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ctfshow元旦水友节
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-02-20 21:09:53" itemprop="dateCreated datePublished" datetime="2024-02-20T21:09:53+08:00">2024-02-20</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Crypto/" itemprop="url" rel="index"><span itemprop="name">Crypto</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/Crypto/ctfshow%E5%85%83%E6%97%A6%E6%B0%B4%E5%8F%8B%E8%8A%82/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/Crypto/ctfshow%E5%85%83%E6%97%A6%E6%B0%B4%E5%8F%8B%E8%8A%82/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>50k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>45 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>昨夜今朝争几许，共惊年去年来。</p>
<span id="more"></span>
<h3 id="月月的爱情故事"><a href="#月月的爱情故事" class="headerlink" title="月月的爱情故事"></a>月月的爱情故事</h3><p>题目作者：<strong>mumu666</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">你知道吗。月月今天遇到了一个让他心动的女孩，她的名字叫做小雨，太幸运了。小雨是一个活泼可爱的女孩！她的笑容如同春天里的阳光。温暖了月月的心，月月第一次见到小雨是在图书馆里！事情是这样的。当时小雨正在专心致志地看书。阳光洒在她的脸上。让她看起来如同天使一般美丽！月月被小雨的美丽和才华所吸引。开始暗暗关注她。在接下来的日子里。月月开始尝试与小雨接触！和她聊天和学习。他们有着许多共同的兴趣爱好，一起度过了许多快乐的时光，渐渐地！月月发现自己对小雨产生了特殊的感情，他开始向小雨表达自己的心意，然而，小雨并没有立即接受月月的感情！她告诉月月。她曾经受过感情的伤害，需要时间来慢慢修复自己的心灵。月月尊重小雨的决定！他开始用更多的时间和精力来陪伴小雨，帮助她走出过去的阴影。在接下来的几个月里。月月和小雨的关系逐渐升温！他们一起参加了许多校园活动。一起探索了那个城市的角角落落。渐渐地！雨也开始对月月产生了感情。她发现自己越来越依赖他。越来越喜欢他。最终！小雨和月月走到了一起，他们的爱情故事成为了校园里的佳话。让同学们都羡慕不已，他们一起度过了青春岁月，一起经历了成长和进步的喜悦与挫折！他们的感情越来越深厚。也越来越稳定。在他们的恋爱过程中，月月和小雨也学会了如何相处和包容对方！他们互相理解互相支持。一起面对生活中的挑战和困难！他们的爱情让他们变得更加坚强和勇敢，也让他们感受到了生命中最美好的东西。月月相信他们能走得更远，更相信自己不会辜负小雨，当他们遭遇挫折和失败的时候！两人永远不会被打倒。这正是他们彼此爱的力量。在他们空闲的时候，月月经常带小雨出去逛街！晚上一起看电影。有一天！月月说将来他要给小雨一场最美的婚礼，小雨十分感动也十分期盼。就这样。这份约定成为了两人前进的动力。两人共同努力最终一起考上了同一所大学的研究生。两人非常开心彼此深情地看着对方似乎有说不完的情话！研究生三年他们互相帮助一起度过了人生最有意义的大学时光，毕业后两人也很轻松找到了自己心仪的企业。月月没有忘记当初的约定。是的。他要给小雨一场最美好的婚礼。终于！这一天到来了，小雨穿上月月为她定制的婚纱。他们手牵手走向了更美好的未来。场下。所有的嘉宾都为他们鼓掌和欢呼并祝福他们的爱情能够永恒长存。</span><br><span class="line"></span><br><span class="line">VTJGc2RHVmtYMS9iVkY0NXp5dGxrZUVoZWZBcWtwSFFkTXF0VUxrMk9pYkxxNzlOSEpNbTlyUDNDdGtLckU0MQpDYUJKbU1JVmNVVlNiM0l6cEhldVd3PT0=</span><br><span class="line"></span><br><span class="line">hint:试试摩斯吧！</span><br></pre></td></tr></table></figure>
<p>先base64解出 </p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX1/bVF45zytlkeEhefAqkpHQdMqtULk2OibLq79NHJMm9rP3CtkKrE41CaBJmMIVcUVSb3IzpHeuWw<span class="operator">=</span><span class="operator">=</span></span><br></pre></td></tr></table></figure>
<p>AES、DES、RC4、Rabbit、Triple DES（3DES）</p>
<p>这些算法都可以引入密钥，且开头部分通常为 <code>U2FsdGVkX1</code></p>
<p>我以为crypto中这一大串文字应该是废话的，没想到这里用到了，提示摩斯密码，着实没想到竟然是标点符号</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">cipher = <span class="string">&#x27;你知道吗。月月今天遇到了一个让他心动的女孩，她的名字叫做小雨，太幸运了。小雨是一个活泼可爱的女孩！她的笑容如同春天里的阳光。温暖了月月的心，月月第一次见到小雨是在图书馆里！事情是这样的。当时小雨正在专心致志地看书。阳光洒在她的脸上。让她看起来如同天使一般美丽！月月被小雨的美丽和才华所吸引。开始暗暗关注她。在接下来的日子里。月月开始尝试与小雨接触！和她聊天和学习。他们有着许多共同的兴趣爱好，一起度过了许多快乐的时光，渐渐地！月月发现自己对小雨产生了特殊的感情，他开始向小雨表达自己的心意，然而，小雨并没有立即接受月月的感情！她告诉月月。她曾经受过感情的伤害，需要时间来慢慢修复自己的心灵。月月尊重小雨的决定！他开始用更多的时间和精力来陪伴小雨，帮助她走出过去的阴影。在接下来的几个月里。月月和小雨的关系逐渐升温！他们一起参加了许多校园活动。一起探索了那个城市的角角落落。渐渐地！雨也开始对月月产生了感情。她发现自己越来越依赖他。越来越喜欢他。最终！小雨和月月走到了一起，他们的爱情故事成为了校园里的佳话。让同学们都羡慕不已，他们一起度过了青春岁月，一起经历了成长和进步的喜悦与挫折！他们的感情越来越深厚。也越来越稳定。在他们的恋爱过程中，月月和小雨也学会了如何相处和包容对方！他们互相理解互相支持。一起面对生活中的挑战和困难！他们的爱情让他们变得更加坚强和勇敢，也让他们感受到了生命中最美好的东西。月月相信他们能走得更远，更相信自己不会辜负小雨，当他们遭遇挫折和失败的时候！两人永远不会被打倒。这正是他们彼此爱的力量。在他们空闲的时候，月月经常带小雨出去逛街！晚上一起看电影。有一天！月月说将来他要给小雨一场最美的婚礼，小雨十分感动也十分期盼。就这样。这份约定成为了两人前进的动力。两人共同努力最终一起考上了同一所大学的研究生。两人非常开心彼此深情地看着对方似乎有说不完的情话！研究生三年他们互相帮助一起度过了人生最有意义的大学时光，毕业后两人也很轻松找到了自己心仪的企业。月月没有忘记当初的约定。是的。他要给小雨一场最美好的婚礼。终于！这一天到来了，小雨穿上月月为她定制的婚纱。他们手牵手走向了更美好的未来。场下。所有的嘉宾都为他们鼓掌和欢呼并祝福他们的爱情能够永恒长存。&#x27;</span></span><br><span class="line"></span><br><span class="line">m = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cipher:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;。&#x27;</span> == i:</span><br><span class="line">        m+=<span class="string">&#x27;.&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&#x27;，&#x27;</span> == i:</span><br><span class="line">        m+=<span class="string">&#x27;-&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&#x27;！&#x27;</span> == i:</span><br><span class="line">        m+=<span class="string">&#x27; &#x27;</span></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># .--. .- ... ... .-- --- .-. -.. .. ... -.-- ..- . -.-- ..- . -.... -.... -....</span></span><br></pre></td></tr></table></figure>
<p>解出摩斯 为 <code>PASSWORDISYUEYUE666</code></p>
<p><img data-src="https://cdn.jsdelivr.net/gh/Wbuildings/hexoimage/imagesdfcc5932fe6f653d3aecf06bf68c422.png" alt="dfcc5932fe6f653d3aecf06bf68c422"></p>
<p>AES 的密钥长度一般为 128位，192位，256位，也即16bytes，24bytes，32bytes，</p>
<p>而这里是9字节， 这种是基于AES的PBE  </p>
<p><span class="exturl" data-url="aHR0cHM6Ly9zYm94LmNuL3Rvb2wvYWVz">Aes/Des/Rc4/Rabbit/TripleDes加密解密<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="麻辣兔头又一锅"><a href="#麻辣兔头又一锅" class="headerlink" title="麻辣兔头又一锅"></a>麻辣兔头又一锅</h3><p>描述：<strong>听说有人不喜欢短尾巴的兔兔？肿么可能？我也很疑惑呢。</strong></p>
<p>题目作者：<strong>萌新阿狸*</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">126292,165298,124522,116716,23623,21538,72802,90966,193480,77695,98618,127096,15893,65821,58966,163254,179952,134870,45821,21712,68316,87720,156070,16323,86266,148522,93678,110618,110445,136381,92706,129732,22416,177638,110110,4324,180608,3820,67750,134150,23116,116772,50573,149156,5292</span><br><span class="line">60144,146332,165671,109800,176885,65766,76908,147004,135068,182821,123107,77538,86482,88096,101725,16475,158935,123018,42322,144694,186769,176935,59296,134856,65813,131931,144283,95814,102191,185706,55744,67711,149076,108054,135112,100344,35434,121479,14506,145222,183989,17548,38904,27832,105943</span><br></pre></td></tr></table></figure>
<p>由描述知道 斐波那契数列 和 异或</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">a = [<span class="number">126292</span>, <span class="number">165298</span>, <span class="number">124522</span>, <span class="number">116716</span>, <span class="number">23623</span>, <span class="number">21538</span>, <span class="number">72802</span>, <span class="number">90966</span>, <span class="number">193480</span>, <span class="number">77695</span>, <span class="number">98618</span>, <span class="number">127096</span>, <span class="number">15893</span>, <span class="number">65821</span>, <span class="number">58966</span>,</span><br><span class="line">      <span class="number">163254</span>, <span class="number">179952</span>, <span class="number">134870</span>, <span class="number">45821</span>, <span class="number">21712</span>, <span class="number">68316</span>, <span class="number">87720</span>, <span class="number">156070</span>, <span class="number">16323</span>, <span class="number">86266</span>, <span class="number">148522</span>, <span class="number">93678</span>, <span class="number">110618</span>, <span class="number">110445</span>, <span class="number">136381</span>,</span><br><span class="line">      <span class="number">92706</span>, <span class="number">129732</span>, <span class="number">22416</span>, <span class="number">177638</span>, <span class="number">110110</span>, <span class="number">4324</span>, <span class="number">180608</span>, <span class="number">3820</span>, <span class="number">67750</span>, <span class="number">134150</span>, <span class="number">23116</span>, <span class="number">116772</span>, <span class="number">50573</span>, <span class="number">149156</span>, <span class="number">5292</span>]</span><br><span class="line">b = [<span class="number">60144</span>, <span class="number">146332</span>, <span class="number">165671</span>, <span class="number">109800</span>, <span class="number">176885</span>, <span class="number">65766</span>, <span class="number">76908</span>, <span class="number">147004</span>, <span class="number">135068</span>, <span class="number">182821</span>, <span class="number">123107</span>, <span class="number">77538</span>, <span class="number">86482</span>, <span class="number">88096</span>, <span class="number">101725</span>,</span><br><span class="line">      <span class="number">16475</span>, <span class="number">158935</span>, <span class="number">123018</span>, <span class="number">42322</span>, <span class="number">144694</span>, <span class="number">186769</span>, <span class="number">176935</span>, <span class="number">59296</span>, <span class="number">134856</span>, <span class="number">65813</span>, <span class="number">131931</span>, <span class="number">144283</span>, <span class="number">95814</span>, <span class="number">102191</span>, <span class="number">185706</span>,</span><br><span class="line">      <span class="number">55744</span>, <span class="number">67711</span>, <span class="number">149076</span>, <span class="number">108054</span>, <span class="number">135112</span>, <span class="number">100344</span>, <span class="number">35434</span>, <span class="number">121479</span>, <span class="number">14506</span>, <span class="number">145222</span>, <span class="number">183989</span>, <span class="number">17548</span>, <span class="number">38904</span>, <span class="number">27832</span>, <span class="number">105943</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    m = (gmpy2.fib(a[i]) ^ gmpy2.fib(b[i])) &amp; <span class="number">0xff</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># ctfshow&#123;6d83b2f1-1241-4b25-9c1c-0a4c218f6c5f&#125;</span></span><br></pre></td></tr></table></figure>
<p><code>gmpy2.fib(i)</code>可求斐波那契数列第i个数</p>
<p> <code>&amp; 0xff</code> 是每个异或值保留一个字节</p>
<p>佩服佬们的想象力</p>
<h3 id="NOeasyRSA"><a href="#NOeasyRSA" class="headerlink" title="NOeasyRSA"></a>NOeasyRSA</h3><p>题目描述：<strong>Can you find a and b?</strong></p>
<p>题目作者：<strong>mumu666</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> FLAG</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x, n</span>):  </span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">pow</span>(u,n,p)*x + v*(<span class="number">1</span>-<span class="built_in">pow</span>(u,n,p))*<span class="built_in">pow</span>(<span class="number">1</span>-u, -<span class="number">1</span>, p)) % p  </span><br><span class="line"> </span><br><span class="line">p = <span class="number">97201997431130462639713476119411091922677381239967611061717766639853376871260165905989218335681560177626304205941143288128749532327607316527719299945637260643711897738116821179208534292854942631428531228316344113303402450588666012800739695018334321748049518585617428717505851025279186520225325765864212731597</span></span><br><span class="line">u = <span class="number">14011530787746260724685809284106528245188320623672333581950055679051366424425259006994945665868546765648275822501035229606171697373122374288934559593175958252416643298136731105775907857798815936190074350794406666922357841091849449562922724459876362600203284195621546769313749721476449207319566681142955460891977927184371401451946649848065952527323468939007868874410618846898618148752279316070498097254384228565132693552949206926391461108714034141321700284318834819732949544823937032615318011463993204345644038210938407875147446570896826729265366024224612406740371824999201173579640264979086368843819069035017648357042</span></span><br><span class="line">v = <span class="number">16560637729264127314502582188855146263038095275553321912067588804088156431664370603746929023264744622682435376065011098909463163865218610904571775751705336266271206718700427773757241393847274601309127403955317959981271158685681135990095066557078560050980575698278958401980987514566688310172721963092100285717921465575782434632190913355536291988686994429739581469633462010143996998589435537178075521590880467628369030177392034117774853431604525531066071844562073814187461299329339694285509725214674761990940902460186665127466202741989052293452290042871514149972640901432877318075354158973805495004367245286709191395753</span></span><br><span class="line">w = <span class="number">30714296289538837760400431621661767909419746909959905820574067592409316977551664652203146506867115455464665524418603262821119202980897986798059489126166547078057148348119365709992892615014626003313040730934533283339617856938614948620116906770806796378275546490794161777851252745862081462799572448648587153412425374338967601487603800379070501278705056791472269999767679535887678042527423534392867454254712641029797659150392148648565421400107500607994226410206105774620083214215531253544274444448346065590895353139670885420838370607181375842930315910289979440845957719622069769102831263579510660283634808483329218819353</span></span><br><span class="line">a = randint(<span class="number">0</span>, <span class="number">2</span>**<span class="number">2048</span>)</span><br><span class="line">b = randint(<span class="number">0</span>, <span class="number">2</span>**<span class="number">2048</span>)</span><br><span class="line">A = f(w, a)</span><br><span class="line">B = f(w, b)</span><br><span class="line">key = long_to_bytes(f(B, a))[:<span class="built_in">len</span>(FLAG)]</span><br><span class="line">enc = strxor(FLAG, key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;A = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;B = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;enc = &#125;</span>&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">A = 19000912802080599027672447674783518419279033741329820736608320648294849832904652704615322546923683308427498322653162857743332527479657555691849627174691056234736228204031597391109766621450008024310365149769851160904834246087493085291270515883474521052340305802461028930107070785434600793548735004323108063823</span></span><br><span class="line"><span class="string">B = 73344156869667785951629011239443984128961974188783039136848369309843181351498207375582387449307849089511875560536212143659712959631858144127598424003355287131145957594729789310869405545587664999655457134475561514111282513273352679348722584469527242626837672035004800949907749224093056447758969518003237425788</span></span><br><span class="line"><span class="string">enc = b&#x27;\xfd\xc1\xb7\x9d&quot;$\xc2\xb0\xb5\xee\xf89\xa4V\x8e\x17\x01K9\xbc.\x92=\x85\x80\xd4\x03\xefAl&quot;\xbd\x8b\xcdL\xb5\xa3!&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>分析：</p>
<p>通过异或，我们需求key，求key需要知道 a</p>
<p>已知数据：u、v、w、p、A、B</p>
<script type="math/tex; mode=display">
key = u^a*B+v*(1-u^a)*(1-u)^{-1} \bmod p\\</script><script type="math/tex; mode=display">
A = u^a*w+v*(1-u^a)*(1-u)^{-1} \bmod p</script><p>处理一下</p>
<script type="math/tex; mode=display">key*(1-u) = u^a*B*(1-u)+v*(1-u^a) \bmod p=u^a*(B-B*u-v)+v \bmod p\\</script><script type="math/tex; mode=display">A*(1-u) = u^a*w*(1-u)+v*(1-u^a) \bmod p=u^a*(w-w*u-v)+v \bmod p</script><p>如此看来 只需知道 <script type="math/tex">u^a</script> 就可求 <code>key</code> ，而<script type="math/tex">u^a=(A*(1-u)-v)*(w-w*u-v)^{-1} \bmod p</script> </p>
<p>最后 <code>strxor</code> 一下即可</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"></span><br><span class="line">p = <span class="number">97201997431130462639713476119411091922677381239967611061717766639853376871260165905989218335681560177626304205941143288128749532327607316527719299945637260643711897738116821179208534292854942631428531228316344113303402450588666012800739695018334321748049518585617428717505851025279186520225325765864212731597</span></span><br><span class="line">u = <span class="number">14011530787746260724685809284106528245188320623672333581950055679051366424425259006994945665868546765648275822501035229606171697373122374288934559593175958252416643298136731105775907857798815936190074350794406666922357841091849449562922724459876362600203284195621546769313749721476449207319566681142955460891977927184371401451946649848065952527323468939007868874410618846898618148752279316070498097254384228565132693552949206926391461108714034141321700284318834819732949544823937032615318011463993204345644038210938407875147446570896826729265366024224612406740371824999201173579640264979086368843819069035017648357042</span></span><br><span class="line">v = <span class="number">16560637729264127314502582188855146263038095275553321912067588804088156431664370603746929023264744622682435376065011098909463163865218610904571775751705336266271206718700427773757241393847274601309127403955317959981271158685681135990095066557078560050980575698278958401980987514566688310172721963092100285717921465575782434632190913355536291988686994429739581469633462010143996998589435537178075521590880467628369030177392034117774853431604525531066071844562073814187461299329339694285509725214674761990940902460186665127466202741989052293452290042871514149972640901432877318075354158973805495004367245286709191395753</span></span><br><span class="line">w = <span class="number">30714296289538837760400431621661767909419746909959905820574067592409316977551664652203146506867115455464665524418603262821119202980897986798059489126166547078057148348119365709992892615014626003313040730934533283339617856938614948620116906770806796378275546490794161777851252745862081462799572448648587153412425374338967601487603800379070501278705056791472269999767679535887678042527423534392867454254712641029797659150392148648565421400107500607994226410206105774620083214215531253544274444448346065590895353139670885420838370607181375842930315910289979440845957719622069769102831263579510660283634808483329218819353</span></span><br><span class="line">A = <span class="number">19000912802080599027672447674783518419279033741329820736608320648294849832904652704615322546923683308427498322653162857743332527479657555691849627174691056234736228204031597391109766621450008024310365149769851160904834246087493085291270515883474521052340305802461028930107070785434600793548735004323108063823</span></span><br><span class="line">B = <span class="number">73344156869667785951629011239443984128961974188783039136848369309843181351498207375582387449307849089511875560536212143659712959631858144127598424003355287131145957594729789310869405545587664999655457134475561514111282513273352679348722584469527242626837672035004800949907749224093056447758969518003237425788</span></span><br><span class="line">enc = <span class="string">b&#x27;\xfd\xc1\xb7\x9d&quot;$\xc2\xb0\xb5\xee\xf89\xa4V\x8e\x17\x01K9\xbc.\x92=\x85\x80\xd4\x03\xefAl&quot;\xbd\x8b\xcdL\xb5\xa3!&#x27;</span></span><br><span class="line"></span><br><span class="line">ua = (A*(<span class="number">1</span>-u)-v)* libnum.invmod(w-w*u-v,p) %p</span><br><span class="line">key = (ua*(B-B*u-v)+v)*libnum.invmod(<span class="number">1</span>-u,p) %p</span><br><span class="line"><span class="built_in">print</span>(strxor(enc,libnum.n2s(key)[:<span class="built_in">len</span>(enc)]))</span><br><span class="line"><span class="comment"># ctfshow&#123;This_Is_Really_Not_So_Smooth!&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="sign-rand"><a href="#sign-rand" class="headerlink" title="sign_rand"></a>sign_rand</h3><p>题目作者：<strong>lingfeng</strong>      </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">            </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_state</span>(<span class="params">kbits, k</span>):</span><br><span class="line">    seed = [(random.getrandbits(kbits) &gt;&gt; k) &amp; <span class="number">0xfffffff</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>)]</span><br><span class="line">    state = (<span class="number">3</span>, <span class="built_in">tuple</span>(seed + [<span class="number">0</span>]), <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">give_gift</span>(<span class="params">kbits, num</span>):</span><br><span class="line">    gift = [random.getrandbits(kbits) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num)]</span><br><span class="line">    e = random.getrandbits(<span class="number">7</span>)</span><br><span class="line">    l_num = num - e</span><br><span class="line">    s_box = <span class="built_in">list</span>(<span class="built_in">range</span>(num))</span><br><span class="line">    random.shuffle(s_box)</span><br><span class="line">    l_gift = [gift[i] <span class="keyword">for</span> i <span class="keyword">in</span> s_box[:l_num]]</span><br><span class="line">    <span class="keyword">return</span> (l_gift, s_box[:l_num], e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc_flag</span>(<span class="params">state, e</span>):</span><br><span class="line">    key = bytes_to_long(md5(long_to_bytes(state[<span class="number">1</span>][e])).digest())</span><br><span class="line">    enc = bytes_to_long(flag) ^ key</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kbits, k, num = random.randrange(<span class="number">64</span>), random.randrange(<span class="number">16</span>), random.randrange(<span class="number">400</span>, <span class="number">600</span>)</span><br><span class="line">state = get_state(kbits, k)</span><br><span class="line">random.setstate(state)</span><br><span class="line">gift = give_gift(kbits, num)</span><br><span class="line">enc = enc_flag(state, gift[<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(gift, enc)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ([91463260584, 97520150804, 134987178347, 134745660347, 23369346769, 88869916197, 67723104206, 132211190015, 74383600340, 57357411421, 80301226226, 2847043233, 46071508714, 76391425800, 71113777427, 12603028605, 127607785895, 82661956584, 48539405830, 131191473154, 137430688091, 48026249914, 105523652421, 58217141456, 135651011411, 37099885733, 101903983367, 117525416468, 49720139903, 123719748136, 58611168240, 68135859850, 6355615539, 23769720298, 7999623487, 19601432037, 49460687576, 34510812373, 97988805553, 120381187017, 37643325426, 79314538948, 128727827227, 41938289773, 74120986880, 29052999070, 21215042789, 76176648906, 82899209179, 90338690991, 102277220210, 109016314367, 2419923303, 75246152672, 109203867772, 87030346778, 119151949871, 134868756437, 124854798665, 122116306769, 31536426951, 82104297926, 118556737102, 78417017414, 81807286830, 24688295471, 126360674284, 8870569872, 105339369180, 61910863416, 56597235604, 50122937080, 135836683348, 75685244539, 112566491901, 86217144353, 110999080631, 91114786530, 94967775022, 52680440255, 76947914257, 133052296759, 22589975272, 104632324223, 47428022416, 106941367714, 119250845700, 80196618477, 92917756830, 52764061858, 82855761133, 26800124167, 129317288037, 44051967549, 70500283649, 165355182, 78293334339, 45001066520, 84638985033, 32566871344, 38421055041, 56145488218, 83396525174, 116762960131, 58381974438, 132249926372, 36091120717, 35213963219, 88756092150, 45288405267, 27461079382, 19589246113, 28308681656, 47161727545, 69898448282, 22959597168, 132569999975, 100557577568, 127037292334, 29708117311, 33229333831, 29311547868, 135347707719, 85435007922, 54540391811, 109544478077, 66841548339, 47159376439, 42574542524, 62176229940, 3138675000, 21267865120, 22618290315, 126018690563, 21590061225, 9799239940, 10617934652, 40956988582, 131053131140, 90043238501, 81283244185, 109338223936, 68311960398, 25088200986, 28895564195, 17646619057, 82775422880, 81522377214, 28334564831, 100791800926, 85872403124, 127915503356, 72496838376, 109007653011, 96263138881, 69693106974, 4718076407, 68334177311, 31708464646, 96111162918, 48965277868, 54931198292, 105535767797, 105680940066, 109968562576, 23573023928, 48569942163, 106967716286, 94835446653, 92803971955, 53791818332, 14453746086, 132101017989, 26361874022, 32122658200, 51724426274, 114997634813, 75838224666, 89848273104, 73619960674, 97795812498, 132466249292, 25997032367, 40732063573, 59142286405, 68524304985, 49545031400, 28044368864, 95700359624, 108201671504, 127043767055, 9384509797, 120972803416, 41782179648, 76653307257, 44056421640, 101631026937, 99078185959, 54885001820, 69316726710, 19710227322, 86035277688, 42289562955, 98051921147, 79098792488, 106490144808, 13834874, 69114014086, 4418515159, 109316722991, 92603496375, 68830244931, 111949257703, 102637560761, 5012149380, 43811237017, 4526712578, 102995188930, 9165821006, 63456393327, 68912422322, 104913358841, 108860651772, 52967416635, 84227988465, 101715630295, 26297443306, 110653579906, 91487440397, 116959430145, 83499469513, 48913630229, 76988993305, 41832173701, 13694488408, 135450931748, 39634435716, 41679152695, 126540504548, 91399825525, 99004649347, 19517357430, 8279948639, 133596449559, 1449103211, 50732184406, 52247676129, 74928416312, 64326525401, 124673786795, 92042480385, 24404916254, 99622146133, 51463314254, 36722967192, 4007778602, 39109534005, 120478575332, 99886542155, 5756463131, 91679854224, 3608646835, 35655876863, 121959477025, 20408412916, 36341277711, 43627610089, 24855949002, 128669830633, 70347508117, 9425085453, 2022963949, 5053312318, 63243834495, 21497715007, 5936366400, 44266914863, 119468825913, 91726986385, 126494307832, 93847533617, 22070910941, 20204251399, 42254244260, 60489335607, 40705184865, 80919639775, 73360223499, 132743946450, 88897376509, 103144368275, 9982808097, 131532980487, 91081435155, 78915930938, 72790758029, 120696671493, 78255313725, 13309583510, 23841020581, 116634908326, 73400462338, 57323203784, 46210923108, 41134724194, 43089395737, 118503520944, 111039189867, 99418263301, 59298127775, 45252940179, 40345195432, 16841439060, 100422187771, 65791698364, 61167532292, 30338914082, 14930863404, 4703203112, 124912009656, 9195518396, 18552364400, 7303227315, 105753747788, 3079040268, 116480022128, 1215344111, 9934249637, 76178148585, 20033461169, 87344780021, 72391242953, 129540048833, 15495213032, 49963621916, 84362224351, 97100635498, 105086571577, 51150506310, 118045067326, 65966867679, 7925108854, 131280748402, 66481282233, 107509392827, 78521145687, 35456851157, 97461157961, 30244093674, 24123083085, 27909475052, 69646113342, 131930611276, 97792139629, 135917828529, 32305782568, 59325645293, 84962280113, 74529748221, 22659244720, 54776660364, 66934871192, 14824496938, 37231294479, 102244198902, 31674646475, 128196911226, 90158594889, 121714346066, 64647669235, 105263204191, 127988380741, 130175056631, 114272442969, 135960937840, 62465712860, 32333037569, 137012433094, 92929672123, 86030288893, 73602847949, 58136148471, 118893337093, 97692245318, 99539974338, 116231441994, 32445182154, 115683286754, 114711297102, 102210385893, 7687212992, 73626254322, 242951419, 5952493527, 96817591608, 45197171621, 122928115217, 106192593180, 99889552302, 125596158762, 136959359712, 67291405558, 71974425715, 115789979144, 59321975202, 84748820897, 133266408556, 6800817333, 110678933813, 96832595879, 97681824039, 89341148630, 84626208563, 58523733456, 93000780873, 68444996084, 775177345, 17204124036, 129474447019, 73589942581, 65415043899, 131703332659, 101783987222, 61388598262, 103435807803, 104030629529, 19123072760, 63612557945, 38245223725, 54345357864, 62016904380, 34602169486, 51229280420, 66624757580, 68760378559, 131556923700, 21935621011, 36349470821, 10120892182, 25883848878, 71735922493, 62883391871, 90647098, 41388569318, 52175456448, 71822304690, 19251125978, 91308465291, 50110754397, 91050175581, 83697004380, 6165622900, 129188497722, 71424103672, 57569171583, 13220579058, 118266862549, 21791521844, 70064705221, 83120075317, 83316886784, 111745960042, 26241940218, 32402511427, 118604113535, 98847819357, 117058412964, 57680263912, 83166477192], [508, 300, 327, 517, 431, 195, 41, 162, 110, 358, 433, 105, 40, 256, 172, 50, 474, 55, 67, 284, 215, 118, 513, 98, 120, 26, 155, 298, 4, 233, 243, 267, 428, 478, 494, 226, 146, 488, 20, 113, 143, 136, 49, 236, 128, 346, 501, 264, 498, 0, 413, 30, 410, 99, 1, 220, 443, 369, 290, 374, 119, 511, 483, 199, 248, 351, 388, 335, 131, 79, 496, 245, 414, 244, 158, 451, 255, 412, 47, 473, 254, 95, 299, 462, 169, 519, 493, 12, 257, 385, 432, 417, 59, 93, 455, 324, 52, 90, 407, 288, 112, 34, 528, 29, 192, 101, 419, 203, 123, 176, 177, 167, 204, 445, 416, 485, 196, 302, 424, 425, 6, 418, 258, 17, 370, 262, 227, 326, 387, 294, 295, 174, 25, 188, 81, 408, 469, 11, 472, 80, 400, 84, 382, 448, 201, 344, 7, 502, 163, 312, 484, 349, 239, 108, 411, 315, 303, 377, 36, 383, 78, 339, 491, 271, 216, 187, 322, 140, 405, 296, 402, 516, 450, 22, 482, 361, 371, 249, 453, 64, 152, 72, 194, 66, 345, 492, 447, 58, 486, 357, 149, 200, 83, 212, 219, 504, 333, 23, 439, 376, 457, 332, 153, 348, 210, 237, 173, 359, 129, 179, 426, 71, 19, 321, 338, 444, 139, 307, 515, 88, 266, 475, 182, 323, 336, 354, 272, 384, 330, 2, 211, 446, 238, 397, 230, 278, 141, 506, 181, 70, 316, 314, 459, 235, 121, 286, 76, 518, 280, 43, 111, 62, 487, 429, 524, 364, 86, 228, 353, 275, 104, 441, 268, 13, 500, 68, 87, 109, 403, 520, 231, 391, 42, 51, 328, 253, 436, 60, 497, 313, 481, 522, 53, 61, 420, 225, 189, 325, 183, 56, 100, 229, 27, 39, 3, 184, 291, 415, 454, 75, 28, 107, 347, 421, 166, 224, 279, 16, 342, 206, 207, 171, 368, 198, 456, 464, 406, 365, 151, 320, 161, 9, 89, 479, 142, 259, 401, 232, 523, 449, 150, 218, 15, 97, 287, 133, 458, 221, 63, 185, 350, 74, 135, 404, 466, 214, 116, 507, 355, 213, 178, 318, 423, 126, 395, 465, 440, 452, 157, 366, 190, 343, 467, 247, 509, 91, 205, 114, 193, 409, 375, 269, 373, 389, 148, 69, 396, 398, 317, 145, 122, 147, 512, 32, 130, 386, 94, 435, 310, 57, 422, 308, 305, 217, 8, 154, 156, 309, 223, 44, 24, 82, 160, 392, 477, 356, 134, 54, 138, 378, 331, 379, 250, 96, 489, 306, 399, 46, 18, 283, 470, 21, 360, 209, 168, 495, 180, 514, 191, 270, 510, 381, 186, 442, 31, 390, 5, 85, 92, 363, 33, 127, 197, 285, 380, 265, 48, 352, 505, 208, 438, 329, 468, 282, 45, 159, 301, 362, 341, 65, 263, 393, 222, 521, 175, 293, 37, 490, 35], 60) 912396759652812740801869061695733452669218533249083289698313292427681899514848561025221753354562922565560034</span></span><br></pre></td></tr></table></figure>
<p>非预期：</p>
<p><code>seed = [(random.getrandbits(kbits) &gt;&gt; k) &amp; 0xfffffff for i in range(624)]</code></p>
<p>可以看到 seed 最多只有28位，可以爆破一手</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line">gift= ([<span class="number">91463260584</span>, <span class="number">97520150804</span>, <span class="number">134987178347</span>, <span class="number">134745660347</span>, <span class="number">23369346769</span>, <span class="number">88869916197</span>, <span class="number">67723104206</span>, <span class="number">132211190015</span>, <span class="number">74383600340</span>, <span class="number">57357411421</span>, <span class="number">80301226226</span>, <span class="number">2847043233</span>, <span class="number">46071508714</span>, <span class="number">76391425800</span>, <span class="number">71113777427</span>, <span class="number">12603028605</span>, <span class="number">127607785895</span>, <span class="number">82661956584</span>, <span class="number">48539405830</span>, <span class="number">131191473154</span>, <span class="number">137430688091</span>, <span class="number">48026249914</span>, <span class="number">105523652421</span>, <span class="number">58217141456</span>, <span class="number">135651011411</span>, <span class="number">37099885733</span>, <span class="number">101903983367</span>, <span class="number">117525416468</span>, <span class="number">49720139903</span>, <span class="number">123719748136</span>, <span class="number">58611168240</span>, <span class="number">68135859850</span>, <span class="number">6355615539</span>, <span class="number">23769720298</span>, <span class="number">7999623487</span>, <span class="number">19601432037</span>, <span class="number">49460687576</span>, <span class="number">34510812373</span>, <span class="number">97988805553</span>, <span class="number">120381187017</span>, <span class="number">37643325426</span>, <span class="number">79314538948</span>, <span class="number">128727827227</span>, <span class="number">41938289773</span>, <span class="number">74120986880</span>, <span class="number">29052999070</span>, <span class="number">21215042789</span>, <span class="number">76176648906</span>, <span class="number">82899209179</span>, <span class="number">90338690991</span>, <span class="number">102277220210</span>, <span class="number">109016314367</span>, <span class="number">2419923303</span>, <span class="number">75246152672</span>, <span class="number">109203867772</span>, <span class="number">87030346778</span>, <span class="number">119151949871</span>, <span class="number">134868756437</span>, <span class="number">124854798665</span>, <span class="number">122116306769</span>, <span class="number">31536426951</span>, <span class="number">82104297926</span>, <span class="number">118556737102</span>, <span class="number">78417017414</span>, <span class="number">81807286830</span>, <span class="number">24688295471</span>, <span class="number">126360674284</span>, <span class="number">8870569872</span>, <span class="number">105339369180</span>, <span class="number">61910863416</span>, <span class="number">56597235604</span>, <span class="number">50122937080</span>, <span class="number">135836683348</span>, <span class="number">75685244539</span>, <span class="number">112566491901</span>, <span class="number">86217144353</span>, <span class="number">110999080631</span>, <span class="number">91114786530</span>, <span class="number">94967775022</span>, <span class="number">52680440255</span>, <span class="number">76947914257</span>, <span class="number">133052296759</span>, <span class="number">22589975272</span>, <span class="number">104632324223</span>, <span class="number">47428022416</span>, <span class="number">106941367714</span>, <span class="number">119250845700</span>, <span class="number">80196618477</span>, <span class="number">92917756830</span>, <span class="number">52764061858</span>, <span class="number">82855761133</span>, <span class="number">26800124167</span>, <span class="number">129317288037</span>, <span class="number">44051967549</span>, <span class="number">70500283649</span>, <span class="number">165355182</span>, <span class="number">78293334339</span>, <span class="number">45001066520</span>, <span class="number">84638985033</span>, <span class="number">32566871344</span>, <span class="number">38421055041</span>, <span class="number">56145488218</span>, <span class="number">83396525174</span>, <span class="number">116762960131</span>, <span class="number">58381974438</span>, <span class="number">132249926372</span>, <span class="number">36091120717</span>, <span class="number">35213963219</span>, <span class="number">88756092150</span>, <span class="number">45288405267</span>, <span class="number">27461079382</span>, <span class="number">19589246113</span>, <span class="number">28308681656</span>, <span class="number">47161727545</span>, <span class="number">69898448282</span>, <span class="number">22959597168</span>, <span class="number">132569999975</span>, <span class="number">100557577568</span>, <span class="number">127037292334</span>, <span class="number">29708117311</span>, <span class="number">33229333831</span>, <span class="number">29311547868</span>, <span class="number">135347707719</span>, <span class="number">85435007922</span>, <span class="number">54540391811</span>, <span class="number">109544478077</span>, <span class="number">66841548339</span>, <span class="number">47159376439</span>, <span class="number">42574542524</span>, <span class="number">62176229940</span>, <span class="number">3138675000</span>, <span class="number">21267865120</span>, <span class="number">22618290315</span>, <span class="number">126018690563</span>, <span class="number">21590061225</span>, <span class="number">9799239940</span>, <span class="number">10617934652</span>, <span class="number">40956988582</span>, <span class="number">131053131140</span>, <span class="number">90043238501</span>, <span class="number">81283244185</span>, <span class="number">109338223936</span>, <span class="number">68311960398</span>, <span class="number">25088200986</span>, <span class="number">28895564195</span>, <span class="number">17646619057</span>, <span class="number">82775422880</span>, <span class="number">81522377214</span>, <span class="number">28334564831</span>, <span class="number">100791800926</span>, <span class="number">85872403124</span>, <span class="number">127915503356</span>, <span class="number">72496838376</span>, <span class="number">109007653011</span>, <span class="number">96263138881</span>, <span class="number">69693106974</span>, <span class="number">4718076407</span>, <span class="number">68334177311</span>, <span class="number">31708464646</span>, <span class="number">96111162918</span>, <span class="number">48965277868</span>, <span class="number">54931198292</span>, <span class="number">105535767797</span>, <span class="number">105680940066</span>, <span class="number">109968562576</span>, <span class="number">23573023928</span>, <span class="number">48569942163</span>, <span class="number">106967716286</span>, <span class="number">94835446653</span>, <span class="number">92803971955</span>, <span class="number">53791818332</span>, <span class="number">14453746086</span>, <span class="number">132101017989</span>, <span class="number">26361874022</span>, <span class="number">32122658200</span>, <span class="number">51724426274</span>, <span class="number">114997634813</span>, <span class="number">75838224666</span>, <span class="number">89848273104</span>, <span class="number">73619960674</span>, <span class="number">97795812498</span>, <span class="number">132466249292</span>, <span class="number">25997032367</span>, <span class="number">40732063573</span>, <span class="number">59142286405</span>, <span class="number">68524304985</span>, <span class="number">49545031400</span>, <span class="number">28044368864</span>, <span class="number">95700359624</span>, <span class="number">108201671504</span>, <span class="number">127043767055</span>, <span class="number">9384509797</span>, <span class="number">120972803416</span>, <span class="number">41782179648</span>, <span class="number">76653307257</span>, <span class="number">44056421640</span>, <span class="number">101631026937</span>, <span class="number">99078185959</span>, <span class="number">54885001820</span>, <span class="number">69316726710</span>, <span class="number">19710227322</span>, <span class="number">86035277688</span>, <span class="number">42289562955</span>, <span class="number">98051921147</span>, <span class="number">79098792488</span>, <span class="number">106490144808</span>, <span class="number">13834874</span>, <span class="number">69114014086</span>, <span class="number">4418515159</span>, <span class="number">109316722991</span>, <span class="number">92603496375</span>, <span class="number">68830244931</span>, <span class="number">111949257703</span>, <span class="number">102637560761</span>, <span class="number">5012149380</span>, <span class="number">43811237017</span>, <span class="number">4526712578</span>, <span class="number">102995188930</span>, <span class="number">9165821006</span>, <span class="number">63456393327</span>, <span class="number">68912422322</span>, <span class="number">104913358841</span>, <span class="number">108860651772</span>, <span class="number">52967416635</span>, <span class="number">84227988465</span>, <span class="number">101715630295</span>, <span class="number">26297443306</span>, <span class="number">110653579906</span>, <span class="number">91487440397</span>, <span class="number">116959430145</span>, <span class="number">83499469513</span>, <span class="number">48913630229</span>, <span class="number">76988993305</span>, <span class="number">41832173701</span>, <span class="number">13694488408</span>, <span class="number">135450931748</span>, <span class="number">39634435716</span>, <span class="number">41679152695</span>, <span class="number">126540504548</span>, <span class="number">91399825525</span>, <span class="number">99004649347</span>, <span class="number">19517357430</span>, <span class="number">8279948639</span>, <span class="number">133596449559</span>, <span class="number">1449103211</span>, <span class="number">50732184406</span>, <span class="number">52247676129</span>, <span class="number">74928416312</span>, <span class="number">64326525401</span>, <span class="number">124673786795</span>, <span class="number">92042480385</span>, <span class="number">24404916254</span>, <span class="number">99622146133</span>, <span class="number">51463314254</span>, <span class="number">36722967192</span>, <span class="number">4007778602</span>, <span class="number">39109534005</span>, <span class="number">120478575332</span>, <span class="number">99886542155</span>, <span class="number">5756463131</span>, <span class="number">91679854224</span>, <span class="number">3608646835</span>, <span class="number">35655876863</span>, <span class="number">121959477025</span>, <span class="number">20408412916</span>, <span class="number">36341277711</span>, <span class="number">43627610089</span>, <span class="number">24855949002</span>, <span class="number">128669830633</span>, <span class="number">70347508117</span>, <span class="number">9425085453</span>, <span class="number">2022963949</span>, <span class="number">5053312318</span>, <span class="number">63243834495</span>, <span class="number">21497715007</span>, <span class="number">5936366400</span>, <span class="number">44266914863</span>, <span class="number">119468825913</span>, <span class="number">91726986385</span>, <span class="number">126494307832</span>, <span class="number">93847533617</span>, <span class="number">22070910941</span>, <span class="number">20204251399</span>, <span class="number">42254244260</span>, <span class="number">60489335607</span>, <span class="number">40705184865</span>, <span class="number">80919639775</span>, <span class="number">73360223499</span>, <span class="number">132743946450</span>, <span class="number">88897376509</span>, <span class="number">103144368275</span>, <span class="number">9982808097</span>, <span class="number">131532980487</span>, <span class="number">91081435155</span>, <span class="number">78915930938</span>, <span class="number">72790758029</span>, <span class="number">120696671493</span>, <span class="number">78255313725</span>, <span class="number">13309583510</span>, <span class="number">23841020581</span>, <span class="number">116634908326</span>, <span class="number">73400462338</span>, <span class="number">57323203784</span>, <span class="number">46210923108</span>, <span class="number">41134724194</span>, <span class="number">43089395737</span>, <span class="number">118503520944</span>, <span class="number">111039189867</span>, <span class="number">99418263301</span>, <span class="number">59298127775</span>, <span class="number">45252940179</span>, <span class="number">40345195432</span>, <span class="number">16841439060</span>, <span class="number">100422187771</span>, <span class="number">65791698364</span>, <span class="number">61167532292</span>, <span class="number">30338914082</span>, <span class="number">14930863404</span>, <span class="number">4703203112</span>, <span class="number">124912009656</span>, <span class="number">9195518396</span>, <span class="number">18552364400</span>, <span class="number">7303227315</span>, <span class="number">105753747788</span>, <span class="number">3079040268</span>, <span class="number">116480022128</span>, <span class="number">1215344111</span>, <span class="number">9934249637</span>, <span class="number">76178148585</span>, <span class="number">20033461169</span>, <span class="number">87344780021</span>, <span class="number">72391242953</span>, <span class="number">129540048833</span>, <span class="number">15495213032</span>, <span class="number">49963621916</span>, <span class="number">84362224351</span>, <span class="number">97100635498</span>, <span class="number">105086571577</span>, <span class="number">51150506310</span>, <span class="number">118045067326</span>, <span class="number">65966867679</span>, <span class="number">7925108854</span>, <span class="number">131280748402</span>, <span class="number">66481282233</span>, <span class="number">107509392827</span>, <span class="number">78521145687</span>, <span class="number">35456851157</span>, <span class="number">97461157961</span>, <span class="number">30244093674</span>, <span class="number">24123083085</span>, <span class="number">27909475052</span>, <span class="number">69646113342</span>, <span class="number">131930611276</span>, <span class="number">97792139629</span>, <span class="number">135917828529</span>, <span class="number">32305782568</span>, <span class="number">59325645293</span>, <span class="number">84962280113</span>, <span class="number">74529748221</span>, <span class="number">22659244720</span>, <span class="number">54776660364</span>, <span class="number">66934871192</span>, <span class="number">14824496938</span>, <span class="number">37231294479</span>, <span class="number">102244198902</span>, <span class="number">31674646475</span>, <span class="number">128196911226</span>, <span class="number">90158594889</span>, <span class="number">121714346066</span>, <span class="number">64647669235</span>, <span class="number">105263204191</span>, <span class="number">127988380741</span>, <span class="number">130175056631</span>, <span class="number">114272442969</span>, <span class="number">135960937840</span>, <span class="number">62465712860</span>, <span class="number">32333037569</span>, <span class="number">137012433094</span>, <span class="number">92929672123</span>, <span class="number">86030288893</span>, <span class="number">73602847949</span>, <span class="number">58136148471</span>, <span class="number">118893337093</span>, <span class="number">97692245318</span>, <span class="number">99539974338</span>, <span class="number">116231441994</span>, <span class="number">32445182154</span>, <span class="number">115683286754</span>, <span class="number">114711297102</span>, <span class="number">102210385893</span>, <span class="number">7687212992</span>, <span class="number">73626254322</span>, <span class="number">242951419</span>, <span class="number">5952493527</span>, <span class="number">96817591608</span>, <span class="number">45197171621</span>, <span class="number">122928115217</span>, <span class="number">106192593180</span>, <span class="number">99889552302</span>, <span class="number">125596158762</span>, <span class="number">136959359712</span>, <span class="number">67291405558</span>, <span class="number">71974425715</span>, <span class="number">115789979144</span>, <span class="number">59321975202</span>, <span class="number">84748820897</span>, <span class="number">133266408556</span>, <span class="number">6800817333</span>, <span class="number">110678933813</span>, <span class="number">96832595879</span>, <span class="number">97681824039</span>, <span class="number">89341148630</span>, <span class="number">84626208563</span>, <span class="number">58523733456</span>, <span class="number">93000780873</span>, <span class="number">68444996084</span>, <span class="number">775177345</span>, <span class="number">17204124036</span>, <span class="number">129474447019</span>, <span class="number">73589942581</span>, <span class="number">65415043899</span>, <span class="number">131703332659</span>, <span class="number">101783987222</span>, <span class="number">61388598262</span>, <span class="number">103435807803</span>, <span class="number">104030629529</span>, <span class="number">19123072760</span>, <span class="number">63612557945</span>, <span class="number">38245223725</span>, <span class="number">54345357864</span>, <span class="number">62016904380</span>, <span class="number">34602169486</span>, <span class="number">51229280420</span>, <span class="number">66624757580</span>, <span class="number">68760378559</span>, <span class="number">131556923700</span>, <span class="number">21935621011</span>, <span class="number">36349470821</span>, <span class="number">10120892182</span>, <span class="number">25883848878</span>, <span class="number">71735922493</span>, <span class="number">62883391871</span>, <span class="number">90647098</span>, <span class="number">41388569318</span>, <span class="number">52175456448</span>, <span class="number">71822304690</span>, <span class="number">19251125978</span>, <span class="number">91308465291</span>, <span class="number">50110754397</span>, <span class="number">91050175581</span>, <span class="number">83697004380</span>, <span class="number">6165622900</span>, <span class="number">129188497722</span>, <span class="number">71424103672</span>, <span class="number">57569171583</span>, <span class="number">13220579058</span>, <span class="number">118266862549</span>, <span class="number">21791521844</span>, <span class="number">70064705221</span>, <span class="number">83120075317</span>, <span class="number">83316886784</span>, <span class="number">111745960042</span>, <span class="number">26241940218</span>, <span class="number">32402511427</span>, <span class="number">118604113535</span>, <span class="number">98847819357</span>, <span class="number">117058412964</span>, <span class="number">57680263912</span>, <span class="number">83166477192</span>], [<span class="number">508</span>, <span class="number">300</span>, <span class="number">327</span>, <span class="number">517</span>, <span class="number">431</span>, <span class="number">195</span>, <span class="number">41</span>, <span class="number">162</span>, <span class="number">110</span>, <span class="number">358</span>, <span class="number">433</span>, <span class="number">105</span>, <span class="number">40</span>, <span class="number">256</span>, <span class="number">172</span>, <span class="number">50</span>, <span class="number">474</span>, <span class="number">55</span>, <span class="number">67</span>, <span class="number">284</span>, <span class="number">215</span>, <span class="number">118</span>, <span class="number">513</span>, <span class="number">98</span>, <span class="number">120</span>, <span class="number">26</span>, <span class="number">155</span>, <span class="number">298</span>, <span class="number">4</span>, <span class="number">233</span>, <span class="number">243</span>, <span class="number">267</span>, <span class="number">428</span>, <span class="number">478</span>, <span class="number">494</span>, <span class="number">226</span>, <span class="number">146</span>, <span class="number">488</span>, <span class="number">20</span>, <span class="number">113</span>, <span class="number">143</span>, <span class="number">136</span>, <span class="number">49</span>, <span class="number">236</span>, <span class="number">128</span>, <span class="number">346</span>, <span class="number">501</span>, <span class="number">264</span>, <span class="number">498</span>, <span class="number">0</span>, <span class="number">413</span>, <span class="number">30</span>, <span class="number">410</span>, <span class="number">99</span>, <span class="number">1</span>, <span class="number">220</span>, <span class="number">443</span>, <span class="number">369</span>, <span class="number">290</span>, <span class="number">374</span>, <span class="number">119</span>, <span class="number">511</span>, <span class="number">483</span>, <span class="number">199</span>, <span class="number">248</span>, <span class="number">351</span>, <span class="number">388</span>, <span class="number">335</span>, <span class="number">131</span>, <span class="number">79</span>, <span class="number">496</span>, <span class="number">245</span>, <span class="number">414</span>, <span class="number">244</span>, <span class="number">158</span>, <span class="number">451</span>, <span class="number">255</span>, <span class="number">412</span>, <span class="number">47</span>, <span class="number">473</span>, <span class="number">254</span>, <span class="number">95</span>, <span class="number">299</span>, <span class="number">462</span>, <span class="number">169</span>, <span class="number">519</span>, <span class="number">493</span>, <span class="number">12</span>, <span class="number">257</span>, <span class="number">385</span>, <span class="number">432</span>, <span class="number">417</span>, <span class="number">59</span>, <span class="number">93</span>, <span class="number">455</span>, <span class="number">324</span>, <span class="number">52</span>, <span class="number">90</span>, <span class="number">407</span>, <span class="number">288</span>, <span class="number">112</span>, <span class="number">34</span>, <span class="number">528</span>, <span class="number">29</span>, <span class="number">192</span>, <span class="number">101</span>, <span class="number">419</span>, <span class="number">203</span>, <span class="number">123</span>, <span class="number">176</span>, <span class="number">177</span>, <span class="number">167</span>, <span class="number">204</span>, <span class="number">445</span>, <span class="number">416</span>, <span class="number">485</span>, <span class="number">196</span>, <span class="number">302</span>, <span class="number">424</span>, <span class="number">425</span>, <span class="number">6</span>, <span class="number">418</span>, <span class="number">258</span>, <span class="number">17</span>, <span class="number">370</span>, <span class="number">262</span>, <span class="number">227</span>, <span class="number">326</span>, <span class="number">387</span>, <span class="number">294</span>, <span class="number">295</span>, <span class="number">174</span>, <span class="number">25</span>, <span class="number">188</span>, <span class="number">81</span>, <span class="number">408</span>, <span class="number">469</span>, <span class="number">11</span>, <span class="number">472</span>, <span class="number">80</span>, <span class="number">400</span>, <span class="number">84</span>, <span class="number">382</span>, <span class="number">448</span>, <span class="number">201</span>, <span class="number">344</span>, <span class="number">7</span>, <span class="number">502</span>, <span class="number">163</span>, <span class="number">312</span>, <span class="number">484</span>, <span class="number">349</span>, <span class="number">239</span>, <span class="number">108</span>, <span class="number">411</span>, <span class="number">315</span>, <span class="number">303</span>, <span class="number">377</span>, <span class="number">36</span>, <span class="number">383</span>, <span class="number">78</span>, <span class="number">339</span>, <span class="number">491</span>, <span class="number">271</span>, <span class="number">216</span>, <span class="number">187</span>, <span class="number">322</span>, <span class="number">140</span>, <span class="number">405</span>, <span class="number">296</span>, <span class="number">402</span>, <span class="number">516</span>, <span class="number">450</span>, <span class="number">22</span>, <span class="number">482</span>, <span class="number">361</span>, <span class="number">371</span>, <span class="number">249</span>, <span class="number">453</span>, <span class="number">64</span>, <span class="number">152</span>, <span class="number">72</span>, <span class="number">194</span>, <span class="number">66</span>, <span class="number">345</span>, <span class="number">492</span>, <span class="number">447</span>, <span class="number">58</span>, <span class="number">486</span>, <span class="number">357</span>, <span class="number">149</span>, <span class="number">200</span>, <span class="number">83</span>, <span class="number">212</span>, <span class="number">219</span>, <span class="number">504</span>, <span class="number">333</span>, <span class="number">23</span>, <span class="number">439</span>, <span class="number">376</span>, <span class="number">457</span>, <span class="number">332</span>, <span class="number">153</span>, <span class="number">348</span>, <span class="number">210</span>, <span class="number">237</span>, <span class="number">173</span>, <span class="number">359</span>, <span class="number">129</span>, <span class="number">179</span>, <span class="number">426</span>, <span class="number">71</span>, <span class="number">19</span>, <span class="number">321</span>, <span class="number">338</span>, <span class="number">444</span>, <span class="number">139</span>, <span class="number">307</span>, <span class="number">515</span>, <span class="number">88</span>, <span class="number">266</span>, <span class="number">475</span>, <span class="number">182</span>, <span class="number">323</span>, <span class="number">336</span>, <span class="number">354</span>, <span class="number">272</span>, <span class="number">384</span>, <span class="number">330</span>, <span class="number">2</span>, <span class="number">211</span>, <span class="number">446</span>, <span class="number">238</span>, <span class="number">397</span>, <span class="number">230</span>, <span class="number">278</span>, <span class="number">141</span>, <span class="number">506</span>, <span class="number">181</span>, <span class="number">70</span>, <span class="number">316</span>, <span class="number">314</span>, <span class="number">459</span>, <span class="number">235</span>, <span class="number">121</span>, <span class="number">286</span>, <span class="number">76</span>, <span class="number">518</span>, <span class="number">280</span>, <span class="number">43</span>, <span class="number">111</span>, <span class="number">62</span>, <span class="number">487</span>, <span class="number">429</span>, <span class="number">524</span>, <span class="number">364</span>, <span class="number">86</span>, <span class="number">228</span>, <span class="number">353</span>, <span class="number">275</span>, <span class="number">104</span>, <span class="number">441</span>, <span class="number">268</span>, <span class="number">13</span>, <span class="number">500</span>, <span class="number">68</span>, <span class="number">87</span>, <span class="number">109</span>, <span class="number">403</span>, <span class="number">520</span>, <span class="number">231</span>, <span class="number">391</span>, <span class="number">42</span>, <span class="number">51</span>, <span class="number">328</span>, <span class="number">253</span>, <span class="number">436</span>, <span class="number">60</span>, <span class="number">497</span>, <span class="number">313</span>, <span class="number">481</span>, <span class="number">522</span>, <span class="number">53</span>, <span class="number">61</span>, <span class="number">420</span>, <span class="number">225</span>, <span class="number">189</span>, <span class="number">325</span>, <span class="number">183</span>, <span class="number">56</span>, <span class="number">100</span>, <span class="number">229</span>, <span class="number">27</span>, <span class="number">39</span>, <span class="number">3</span>, <span class="number">184</span>, <span class="number">291</span>, <span class="number">415</span>, <span class="number">454</span>, <span class="number">75</span>, <span class="number">28</span>, <span class="number">107</span>, <span class="number">347</span>, <span class="number">421</span>, <span class="number">166</span>, <span class="number">224</span>, <span class="number">279</span>, <span class="number">16</span>, <span class="number">342</span>, <span class="number">206</span>, <span class="number">207</span>, <span class="number">171</span>, <span class="number">368</span>, <span class="number">198</span>, <span class="number">456</span>, <span class="number">464</span>, <span class="number">406</span>, <span class="number">365</span>, <span class="number">151</span>, <span class="number">320</span>, <span class="number">161</span>, <span class="number">9</span>, <span class="number">89</span>, <span class="number">479</span>, <span class="number">142</span>, <span class="number">259</span>, <span class="number">401</span>, <span class="number">232</span>, <span class="number">523</span>, <span class="number">449</span>, <span class="number">150</span>, <span class="number">218</span>, <span class="number">15</span>, <span class="number">97</span>, <span class="number">287</span>, <span class="number">133</span>, <span class="number">458</span>, <span class="number">221</span>, <span class="number">63</span>, <span class="number">185</span>, <span class="number">350</span>, <span class="number">74</span>, <span class="number">135</span>, <span class="number">404</span>, <span class="number">466</span>, <span class="number">214</span>, <span class="number">116</span>, <span class="number">507</span>, <span class="number">355</span>, <span class="number">213</span>, <span class="number">178</span>, <span class="number">318</span>, <span class="number">423</span>, <span class="number">126</span>, <span class="number">395</span>, <span class="number">465</span>, <span class="number">440</span>, <span class="number">452</span>, <span class="number">157</span>, <span class="number">366</span>, <span class="number">190</span>, <span class="number">343</span>, <span class="number">467</span>, <span class="number">247</span>, <span class="number">509</span>, <span class="number">91</span>, <span class="number">205</span>, <span class="number">114</span>, <span class="number">193</span>, <span class="number">409</span>, <span class="number">375</span>, <span class="number">269</span>, <span class="number">373</span>, <span class="number">389</span>, <span class="number">148</span>, <span class="number">69</span>, <span class="number">396</span>, <span class="number">398</span>, <span class="number">317</span>, <span class="number">145</span>, <span class="number">122</span>, <span class="number">147</span>, <span class="number">512</span>, <span class="number">32</span>, <span class="number">130</span>, <span class="number">386</span>, <span class="number">94</span>, <span class="number">435</span>, <span class="number">310</span>, <span class="number">57</span>, <span class="number">422</span>, <span class="number">308</span>, <span class="number">305</span>, <span class="number">217</span>, <span class="number">8</span>, <span class="number">154</span>, <span class="number">156</span>, <span class="number">309</span>, <span class="number">223</span>, <span class="number">44</span>, <span class="number">24</span>, <span class="number">82</span>, <span class="number">160</span>, <span class="number">392</span>, <span class="number">477</span>, <span class="number">356</span>, <span class="number">134</span>, <span class="number">54</span>, <span class="number">138</span>, <span class="number">378</span>, <span class="number">331</span>, <span class="number">379</span>, <span class="number">250</span>, <span class="number">96</span>, <span class="number">489</span>, <span class="number">306</span>, <span class="number">399</span>, <span class="number">46</span>, <span class="number">18</span>, <span class="number">283</span>, <span class="number">470</span>, <span class="number">21</span>, <span class="number">360</span>, <span class="number">209</span>, <span class="number">168</span>, <span class="number">495</span>, <span class="number">180</span>, <span class="number">514</span>, <span class="number">191</span>, <span class="number">270</span>, <span class="number">510</span>, <span class="number">381</span>, <span class="number">186</span>, <span class="number">442</span>, <span class="number">31</span>, <span class="number">390</span>, <span class="number">5</span>, <span class="number">85</span>, <span class="number">92</span>, <span class="number">363</span>, <span class="number">33</span>, <span class="number">127</span>, <span class="number">197</span>, <span class="number">285</span>, <span class="number">380</span>, <span class="number">265</span>, <span class="number">48</span>, <span class="number">352</span>, <span class="number">505</span>, <span class="number">208</span>, <span class="number">438</span>, <span class="number">329</span>, <span class="number">468</span>, <span class="number">282</span>, <span class="number">45</span>, <span class="number">159</span>, <span class="number">301</span>, <span class="number">362</span>, <span class="number">341</span>, <span class="number">65</span>, <span class="number">263</span>, <span class="number">393</span>, <span class="number">222</span>, <span class="number">521</span>, <span class="number">175</span>, <span class="number">293</span>, <span class="number">37</span>, <span class="number">490</span>, <span class="number">35</span>], <span class="number">60</span>)</span><br><span class="line">enc = <span class="number">912396759652812740801869061695733452669218533249083289698313292427681899514848561025221753354562922565560034</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">de_flag</span>(<span class="params">state</span>):</span><br><span class="line">    key = bytes_to_long(md5(long_to_bytes(state)).digest())</span><br><span class="line">    flag = enc ^ key</span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">0xfffffff</span>+<span class="number">1</span>):</span><br><span class="line">    flag = <span class="built_in">str</span>(long_to_bytes(de_flag(i)))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;\\x&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> flag <span class="keyword">and</span> <span class="string">&quot;_&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> flag <span class="keyword">and</span> <span class="string">&quot;@&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line"><span class="comment"># b&#x27;ctfshow&#123;F2AD971D-66C2-2D1D-69D6-CE7DE2A49B35&#125;&#x27;</span></span><br><span class="line"><span class="comment"># 67529674</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>上面这个判断有点粗糙</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    flag = m.decode()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">all</span>(f <span class="keyword">in</span> table <span class="keyword">for</span> f <span class="keyword">in</span> flag):</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;num = <span class="subst">&#123;num&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + <span class="string">&#x27;0123456789_-&#123;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>如果 flag里的所有字符都在table里，就筛选出flag了</p>
<p>官方解：</p>
<p>类似于黑盒测试，选择明文攻击</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># test.sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">buildT</span>():</span><br><span class="line">    rng = Random()</span><br><span class="line">    T = matrix(GF(<span class="number">2</span>), <span class="number">32</span>, <span class="number">32</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        s = [<span class="number">0</span>] * <span class="number">624</span></span><br><span class="line">        s[<span class="number">0</span>] = <span class="number">1</span> &lt;&lt; (<span class="number">31</span> - i)</span><br><span class="line">        rng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(s + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">        tmp = rng.getrandbits(<span class="number">32</span>)</span><br><span class="line">        row = vector(GF(<span class="number">2</span>), [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">bin</span>(tmp)[<span class="number">2</span>:].zfill(<span class="number">32</span>)])</span><br><span class="line">        T[i] = row</span><br><span class="line">    <span class="keyword">return</span> T</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>(<span class="params">key1</span>):</span><br><span class="line">    T = buildT()</span><br><span class="line">    a = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(key1)[<span class="number">2</span>:].zfill(<span class="number">32</span>)]</span><br><span class="line">    a = matrix(GF(<span class="number">2</span>), a)</span><br><span class="line">    b = T.solve_left(a)</span><br><span class="line">    c = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> b.<span class="built_in">list</span>()])</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">int</span>(c, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">gift= ([<span class="number">91463260584</span>, <span class="number">97520150804</span>, <span class="number">134987178347</span>, <span class="number">134745660347</span>, <span class="number">23369346769</span>, <span class="number">88869916197</span>, <span class="number">67723104206</span>, <span class="number">132211190015</span>, <span class="number">74383600340</span>, <span class="number">57357411421</span>, <span class="number">80301226226</span>, <span class="number">2847043233</span>, <span class="number">46071508714</span>, <span class="number">76391425800</span>, <span class="number">71113777427</span>, <span class="number">12603028605</span>, <span class="number">127607785895</span>, <span class="number">82661956584</span>, <span class="number">48539405830</span>, <span class="number">131191473154</span>, <span class="number">137430688091</span>, <span class="number">48026249914</span>, <span class="number">105523652421</span>, <span class="number">58217141456</span>, <span class="number">135651011411</span>, <span class="number">37099885733</span>, <span class="number">101903983367</span>, <span class="number">117525416468</span>, <span class="number">49720139903</span>, <span class="number">123719748136</span>, <span class="number">58611168240</span>, <span class="number">68135859850</span>, <span class="number">6355615539</span>, <span class="number">23769720298</span>, <span class="number">7999623487</span>, <span class="number">19601432037</span>, <span class="number">49460687576</span>, <span class="number">34510812373</span>, <span class="number">97988805553</span>, <span class="number">120381187017</span>, <span class="number">37643325426</span>, <span class="number">79314538948</span>, <span class="number">128727827227</span>, <span class="number">41938289773</span>, <span class="number">74120986880</span>, <span class="number">29052999070</span>, <span class="number">21215042789</span>, <span class="number">76176648906</span>, <span class="number">82899209179</span>, <span class="number">90338690991</span>, <span class="number">102277220210</span>, <span class="number">109016314367</span>, <span class="number">2419923303</span>, <span class="number">75246152672</span>, <span class="number">109203867772</span>, <span class="number">87030346778</span>, <span class="number">119151949871</span>, <span class="number">134868756437</span>, <span class="number">124854798665</span>, <span class="number">122116306769</span>, <span class="number">31536426951</span>, <span class="number">82104297926</span>, <span class="number">118556737102</span>, <span class="number">78417017414</span>, <span class="number">81807286830</span>, <span class="number">24688295471</span>, <span class="number">126360674284</span>, <span class="number">8870569872</span>, <span class="number">105339369180</span>, <span class="number">61910863416</span>, <span class="number">56597235604</span>, <span class="number">50122937080</span>, <span class="number">135836683348</span>, <span class="number">75685244539</span>, <span class="number">112566491901</span>, <span class="number">86217144353</span>, <span class="number">110999080631</span>, <span class="number">91114786530</span>, <span class="number">94967775022</span>, <span class="number">52680440255</span>, <span class="number">76947914257</span>, <span class="number">133052296759</span>, <span class="number">22589975272</span>, <span class="number">104632324223</span>, <span class="number">47428022416</span>, <span class="number">106941367714</span>, <span class="number">119250845700</span>, <span class="number">80196618477</span>, <span class="number">92917756830</span>, <span class="number">52764061858</span>, <span class="number">82855761133</span>, <span class="number">26800124167</span>, <span class="number">129317288037</span>, <span class="number">44051967549</span>, <span class="number">70500283649</span>, <span class="number">165355182</span>, <span class="number">78293334339</span>, <span class="number">45001066520</span>, <span class="number">84638985033</span>, <span class="number">32566871344</span>, <span class="number">38421055041</span>, <span class="number">56145488218</span>, <span class="number">83396525174</span>, <span class="number">116762960131</span>, <span class="number">58381974438</span>, <span class="number">132249926372</span>, <span class="number">36091120717</span>, <span class="number">35213963219</span>, <span class="number">88756092150</span>, <span class="number">45288405267</span>, <span class="number">27461079382</span>, <span class="number">19589246113</span>, <span class="number">28308681656</span>, <span class="number">47161727545</span>, <span class="number">69898448282</span>, <span class="number">22959597168</span>, <span class="number">132569999975</span>, <span class="number">100557577568</span>, <span class="number">127037292334</span>, <span class="number">29708117311</span>, <span class="number">33229333831</span>, <span class="number">29311547868</span>, <span class="number">135347707719</span>, <span class="number">85435007922</span>, <span class="number">54540391811</span>, <span class="number">109544478077</span>, <span class="number">66841548339</span>, <span class="number">47159376439</span>, <span class="number">42574542524</span>, <span class="number">62176229940</span>, <span class="number">3138675000</span>, <span class="number">21267865120</span>, <span class="number">22618290315</span>, <span class="number">126018690563</span>, <span class="number">21590061225</span>, <span class="number">9799239940</span>, <span class="number">10617934652</span>, <span class="number">40956988582</span>, <span class="number">131053131140</span>, <span class="number">90043238501</span>, <span class="number">81283244185</span>, <span class="number">109338223936</span>, <span class="number">68311960398</span>, <span class="number">25088200986</span>, <span class="number">28895564195</span>, <span class="number">17646619057</span>, <span class="number">82775422880</span>, <span class="number">81522377214</span>, <span class="number">28334564831</span>, <span class="number">100791800926</span>, <span class="number">85872403124</span>, <span class="number">127915503356</span>, <span class="number">72496838376</span>, <span class="number">109007653011</span>, <span class="number">96263138881</span>, <span class="number">69693106974</span>, <span class="number">4718076407</span>, <span class="number">68334177311</span>, <span class="number">31708464646</span>, <span class="number">96111162918</span>, <span class="number">48965277868</span>, <span class="number">54931198292</span>, <span class="number">105535767797</span>, <span class="number">105680940066</span>, <span class="number">109968562576</span>, <span class="number">23573023928</span>, <span class="number">48569942163</span>, <span class="number">106967716286</span>, <span class="number">94835446653</span>, <span class="number">92803971955</span>, <span class="number">53791818332</span>, <span class="number">14453746086</span>, <span class="number">132101017989</span>, <span class="number">26361874022</span>, <span class="number">32122658200</span>, <span class="number">51724426274</span>, <span class="number">114997634813</span>, <span class="number">75838224666</span>, <span class="number">89848273104</span>, <span class="number">73619960674</span>, <span class="number">97795812498</span>, <span class="number">132466249292</span>, <span class="number">25997032367</span>, <span class="number">40732063573</span>, <span class="number">59142286405</span>, <span class="number">68524304985</span>, <span class="number">49545031400</span>, <span class="number">28044368864</span>, <span class="number">95700359624</span>, <span class="number">108201671504</span>, <span class="number">127043767055</span>, <span class="number">9384509797</span>, <span class="number">120972803416</span>, <span class="number">41782179648</span>, <span class="number">76653307257</span>, <span class="number">44056421640</span>, <span class="number">101631026937</span>, <span class="number">99078185959</span>, <span class="number">54885001820</span>, <span class="number">69316726710</span>, <span class="number">19710227322</span>, <span class="number">86035277688</span>, <span class="number">42289562955</span>, <span class="number">98051921147</span>, <span class="number">79098792488</span>, <span class="number">106490144808</span>, <span class="number">13834874</span>, <span class="number">69114014086</span>, <span class="number">4418515159</span>, <span class="number">109316722991</span>, <span class="number">92603496375</span>, <span class="number">68830244931</span>, <span class="number">111949257703</span>, <span class="number">102637560761</span>, <span class="number">5012149380</span>, <span class="number">43811237017</span>, <span class="number">4526712578</span>, <span class="number">102995188930</span>, <span class="number">9165821006</span>, <span class="number">63456393327</span>, <span class="number">68912422322</span>, <span class="number">104913358841</span>, <span class="number">108860651772</span>, <span class="number">52967416635</span>, <span class="number">84227988465</span>, <span class="number">101715630295</span>, <span class="number">26297443306</span>, <span class="number">110653579906</span>, <span class="number">91487440397</span>, <span class="number">116959430145</span>, <span class="number">83499469513</span>, <span class="number">48913630229</span>, <span class="number">76988993305</span>, <span class="number">41832173701</span>, <span class="number">13694488408</span>, <span class="number">135450931748</span>, <span class="number">39634435716</span>, <span class="number">41679152695</span>, <span class="number">126540504548</span>, <span class="number">91399825525</span>, <span class="number">99004649347</span>, <span class="number">19517357430</span>, <span class="number">8279948639</span>, <span class="number">133596449559</span>, <span class="number">1449103211</span>, <span class="number">50732184406</span>, <span class="number">52247676129</span>, <span class="number">74928416312</span>, <span class="number">64326525401</span>, <span class="number">124673786795</span>, <span class="number">92042480385</span>, <span class="number">24404916254</span>, <span class="number">99622146133</span>, <span class="number">51463314254</span>, <span class="number">36722967192</span>, <span class="number">4007778602</span>, <span class="number">39109534005</span>, <span class="number">120478575332</span>, <span class="number">99886542155</span>, <span class="number">5756463131</span>, <span class="number">91679854224</span>, <span class="number">3608646835</span>, <span class="number">35655876863</span>, <span class="number">121959477025</span>, <span class="number">20408412916</span>, <span class="number">36341277711</span>, <span class="number">43627610089</span>, <span class="number">24855949002</span>, <span class="number">128669830633</span>, <span class="number">70347508117</span>, <span class="number">9425085453</span>, <span class="number">2022963949</span>, <span class="number">5053312318</span>, <span class="number">63243834495</span>, <span class="number">21497715007</span>, <span class="number">5936366400</span>, <span class="number">44266914863</span>, <span class="number">119468825913</span>, <span class="number">91726986385</span>, <span class="number">126494307832</span>, <span class="number">93847533617</span>, <span class="number">22070910941</span>, <span class="number">20204251399</span>, <span class="number">42254244260</span>, <span class="number">60489335607</span>, <span class="number">40705184865</span>, <span class="number">80919639775</span>, <span class="number">73360223499</span>, <span class="number">132743946450</span>, <span class="number">88897376509</span>, <span class="number">103144368275</span>, <span class="number">9982808097</span>, <span class="number">131532980487</span>, <span class="number">91081435155</span>, <span class="number">78915930938</span>, <span class="number">72790758029</span>, <span class="number">120696671493</span>, <span class="number">78255313725</span>, <span class="number">13309583510</span>, <span class="number">23841020581</span>, <span class="number">116634908326</span>, <span class="number">73400462338</span>, <span class="number">57323203784</span>, <span class="number">46210923108</span>, <span class="number">41134724194</span>, <span class="number">43089395737</span>, <span class="number">118503520944</span>, <span class="number">111039189867</span>, <span class="number">99418263301</span>, <span class="number">59298127775</span>, <span class="number">45252940179</span>, <span class="number">40345195432</span>, <span class="number">16841439060</span>, <span class="number">100422187771</span>, <span class="number">65791698364</span>, <span class="number">61167532292</span>, <span class="number">30338914082</span>, <span class="number">14930863404</span>, <span class="number">4703203112</span>, <span class="number">124912009656</span>, <span class="number">9195518396</span>, <span class="number">18552364400</span>, <span class="number">7303227315</span>, <span class="number">105753747788</span>, <span class="number">3079040268</span>, <span class="number">116480022128</span>, <span class="number">1215344111</span>, <span class="number">9934249637</span>, <span class="number">76178148585</span>, <span class="number">20033461169</span>, <span class="number">87344780021</span>, <span class="number">72391242953</span>, <span class="number">129540048833</span>, <span class="number">15495213032</span>, <span class="number">49963621916</span>, <span class="number">84362224351</span>, <span class="number">97100635498</span>, <span class="number">105086571577</span>, <span class="number">51150506310</span>, <span class="number">118045067326</span>, <span class="number">65966867679</span>, <span class="number">7925108854</span>, <span class="number">131280748402</span>, <span class="number">66481282233</span>, <span class="number">107509392827</span>, <span class="number">78521145687</span>, <span class="number">35456851157</span>, <span class="number">97461157961</span>, <span class="number">30244093674</span>, <span class="number">24123083085</span>, <span class="number">27909475052</span>, <span class="number">69646113342</span>, <span class="number">131930611276</span>, <span class="number">97792139629</span>, <span class="number">135917828529</span>, <span class="number">32305782568</span>, <span class="number">59325645293</span>, <span class="number">84962280113</span>, <span class="number">74529748221</span>, <span class="number">22659244720</span>, <span class="number">54776660364</span>, <span class="number">66934871192</span>, <span class="number">14824496938</span>, <span class="number">37231294479</span>, <span class="number">102244198902</span>, <span class="number">31674646475</span>, <span class="number">128196911226</span>, <span class="number">90158594889</span>, <span class="number">121714346066</span>, <span class="number">64647669235</span>, <span class="number">105263204191</span>, <span class="number">127988380741</span>, <span class="number">130175056631</span>, <span class="number">114272442969</span>, <span class="number">135960937840</span>, <span class="number">62465712860</span>, <span class="number">32333037569</span>, <span class="number">137012433094</span>, <span class="number">92929672123</span>, <span class="number">86030288893</span>, <span class="number">73602847949</span>, <span class="number">58136148471</span>, <span class="number">118893337093</span>, <span class="number">97692245318</span>, <span class="number">99539974338</span>, <span class="number">116231441994</span>, <span class="number">32445182154</span>, <span class="number">115683286754</span>, <span class="number">114711297102</span>, <span class="number">102210385893</span>, <span class="number">7687212992</span>, <span class="number">73626254322</span>, <span class="number">242951419</span>, <span class="number">5952493527</span>, <span class="number">96817591608</span>, <span class="number">45197171621</span>, <span class="number">122928115217</span>, <span class="number">106192593180</span>, <span class="number">99889552302</span>, <span class="number">125596158762</span>, <span class="number">136959359712</span>, <span class="number">67291405558</span>, <span class="number">71974425715</span>, <span class="number">115789979144</span>, <span class="number">59321975202</span>, <span class="number">84748820897</span>, <span class="number">133266408556</span>, <span class="number">6800817333</span>, <span class="number">110678933813</span>, <span class="number">96832595879</span>, <span class="number">97681824039</span>, <span class="number">89341148630</span>, <span class="number">84626208563</span>, <span class="number">58523733456</span>, <span class="number">93000780873</span>, <span class="number">68444996084</span>, <span class="number">775177345</span>, <span class="number">17204124036</span>, <span class="number">129474447019</span>, <span class="number">73589942581</span>, <span class="number">65415043899</span>, <span class="number">131703332659</span>, <span class="number">101783987222</span>, <span class="number">61388598262</span>, <span class="number">103435807803</span>, <span class="number">104030629529</span>, <span class="number">19123072760</span>, <span class="number">63612557945</span>, <span class="number">38245223725</span>, <span class="number">54345357864</span>, <span class="number">62016904380</span>, <span class="number">34602169486</span>, <span class="number">51229280420</span>, <span class="number">66624757580</span>, <span class="number">68760378559</span>, <span class="number">131556923700</span>, <span class="number">21935621011</span>, <span class="number">36349470821</span>, <span class="number">10120892182</span>, <span class="number">25883848878</span>, <span class="number">71735922493</span>, <span class="number">62883391871</span>, <span class="number">90647098</span>, <span class="number">41388569318</span>, <span class="number">52175456448</span>, <span class="number">71822304690</span>, <span class="number">19251125978</span>, <span class="number">91308465291</span>, <span class="number">50110754397</span>, <span class="number">91050175581</span>, <span class="number">83697004380</span>, <span class="number">6165622900</span>, <span class="number">129188497722</span>, <span class="number">71424103672</span>, <span class="number">57569171583</span>, <span class="number">13220579058</span>, <span class="number">118266862549</span>, <span class="number">21791521844</span>, <span class="number">70064705221</span>, <span class="number">83120075317</span>, <span class="number">83316886784</span>, <span class="number">111745960042</span>, <span class="number">26241940218</span>, <span class="number">32402511427</span>, <span class="number">118604113535</span>, <span class="number">98847819357</span>, <span class="number">117058412964</span>, <span class="number">57680263912</span>, <span class="number">83166477192</span>], [<span class="number">508</span>, <span class="number">300</span>, <span class="number">327</span>, <span class="number">517</span>, <span class="number">431</span>, <span class="number">195</span>, <span class="number">41</span>, <span class="number">162</span>, <span class="number">110</span>, <span class="number">358</span>, <span class="number">433</span>, <span class="number">105</span>, <span class="number">40</span>, <span class="number">256</span>, <span class="number">172</span>, <span class="number">50</span>, <span class="number">474</span>, <span class="number">55</span>, <span class="number">67</span>, <span class="number">284</span>, <span class="number">215</span>, <span class="number">118</span>, <span class="number">513</span>, <span class="number">98</span>, <span class="number">120</span>, <span class="number">26</span>, <span class="number">155</span>, <span class="number">298</span>, <span class="number">4</span>, <span class="number">233</span>, <span class="number">243</span>, <span class="number">267</span>, <span class="number">428</span>, <span class="number">478</span>, <span class="number">494</span>, <span class="number">226</span>, <span class="number">146</span>, <span class="number">488</span>, <span class="number">20</span>, <span class="number">113</span>, <span class="number">143</span>, <span class="number">136</span>, <span class="number">49</span>, <span class="number">236</span>, <span class="number">128</span>, <span class="number">346</span>, <span class="number">501</span>, <span class="number">264</span>, <span class="number">498</span>, <span class="number">0</span>, <span class="number">413</span>, <span class="number">30</span>, <span class="number">410</span>, <span class="number">99</span>, <span class="number">1</span>, <span class="number">220</span>, <span class="number">443</span>, <span class="number">369</span>, <span class="number">290</span>, <span class="number">374</span>, <span class="number">119</span>, <span class="number">511</span>, <span class="number">483</span>, <span class="number">199</span>, <span class="number">248</span>, <span class="number">351</span>, <span class="number">388</span>, <span class="number">335</span>, <span class="number">131</span>, <span class="number">79</span>, <span class="number">496</span>, <span class="number">245</span>, <span class="number">414</span>, <span class="number">244</span>, <span class="number">158</span>, <span class="number">451</span>, <span class="number">255</span>, <span class="number">412</span>, <span class="number">47</span>, <span class="number">473</span>, <span class="number">254</span>, <span class="number">95</span>, <span class="number">299</span>, <span class="number">462</span>, <span class="number">169</span>, <span class="number">519</span>, <span class="number">493</span>, <span class="number">12</span>, <span class="number">257</span>, <span class="number">385</span>, <span class="number">432</span>, <span class="number">417</span>, <span class="number">59</span>, <span class="number">93</span>, <span class="number">455</span>, <span class="number">324</span>, <span class="number">52</span>, <span class="number">90</span>, <span class="number">407</span>, <span class="number">288</span>, <span class="number">112</span>, <span class="number">34</span>, <span class="number">528</span>, <span class="number">29</span>, <span class="number">192</span>, <span class="number">101</span>, <span class="number">419</span>, <span class="number">203</span>, <span class="number">123</span>, <span class="number">176</span>, <span class="number">177</span>, <span class="number">167</span>, <span class="number">204</span>, <span class="number">445</span>, <span class="number">416</span>, <span class="number">485</span>, <span class="number">196</span>, <span class="number">302</span>, <span class="number">424</span>, <span class="number">425</span>, <span class="number">6</span>, <span class="number">418</span>, <span class="number">258</span>, <span class="number">17</span>, <span class="number">370</span>, <span class="number">262</span>, <span class="number">227</span>, <span class="number">326</span>, <span class="number">387</span>, <span class="number">294</span>, <span class="number">295</span>, <span class="number">174</span>, <span class="number">25</span>, <span class="number">188</span>, <span class="number">81</span>, <span class="number">408</span>, <span class="number">469</span>, <span class="number">11</span>, <span class="number">472</span>, <span class="number">80</span>, <span class="number">400</span>, <span class="number">84</span>, <span class="number">382</span>, <span class="number">448</span>, <span class="number">201</span>, <span class="number">344</span>, <span class="number">7</span>, <span class="number">502</span>, <span class="number">163</span>, <span class="number">312</span>, <span class="number">484</span>, <span class="number">349</span>, <span class="number">239</span>, <span class="number">108</span>, <span class="number">411</span>, <span class="number">315</span>, <span class="number">303</span>, <span class="number">377</span>, <span class="number">36</span>, <span class="number">383</span>, <span class="number">78</span>, <span class="number">339</span>, <span class="number">491</span>, <span class="number">271</span>, <span class="number">216</span>, <span class="number">187</span>, <span class="number">322</span>, <span class="number">140</span>, <span class="number">405</span>, <span class="number">296</span>, <span class="number">402</span>, <span class="number">516</span>, <span class="number">450</span>, <span class="number">22</span>, <span class="number">482</span>, <span class="number">361</span>, <span class="number">371</span>, <span class="number">249</span>, <span class="number">453</span>, <span class="number">64</span>, <span class="number">152</span>, <span class="number">72</span>, <span class="number">194</span>, <span class="number">66</span>, <span class="number">345</span>, <span class="number">492</span>, <span class="number">447</span>, <span class="number">58</span>, <span class="number">486</span>, <span class="number">357</span>, <span class="number">149</span>, <span class="number">200</span>, <span class="number">83</span>, <span class="number">212</span>, <span class="number">219</span>, <span class="number">504</span>, <span class="number">333</span>, <span class="number">23</span>, <span class="number">439</span>, <span class="number">376</span>, <span class="number">457</span>, <span class="number">332</span>, <span class="number">153</span>, <span class="number">348</span>, <span class="number">210</span>, <span class="number">237</span>, <span class="number">173</span>, <span class="number">359</span>, <span class="number">129</span>, <span class="number">179</span>, <span class="number">426</span>, <span class="number">71</span>, <span class="number">19</span>, <span class="number">321</span>, <span class="number">338</span>, <span class="number">444</span>, <span class="number">139</span>, <span class="number">307</span>, <span class="number">515</span>, <span class="number">88</span>, <span class="number">266</span>, <span class="number">475</span>, <span class="number">182</span>, <span class="number">323</span>, <span class="number">336</span>, <span class="number">354</span>, <span class="number">272</span>, <span class="number">384</span>, <span class="number">330</span>, <span class="number">2</span>, <span class="number">211</span>, <span class="number">446</span>, <span class="number">238</span>, <span class="number">397</span>, <span class="number">230</span>, <span class="number">278</span>, <span class="number">141</span>, <span class="number">506</span>, <span class="number">181</span>, <span class="number">70</span>, <span class="number">316</span>, <span class="number">314</span>, <span class="number">459</span>, <span class="number">235</span>, <span class="number">121</span>, <span class="number">286</span>, <span class="number">76</span>, <span class="number">518</span>, <span class="number">280</span>, <span class="number">43</span>, <span class="number">111</span>, <span class="number">62</span>, <span class="number">487</span>, <span class="number">429</span>, <span class="number">524</span>, <span class="number">364</span>, <span class="number">86</span>, <span class="number">228</span>, <span class="number">353</span>, <span class="number">275</span>, <span class="number">104</span>, <span class="number">441</span>, <span class="number">268</span>, <span class="number">13</span>, <span class="number">500</span>, <span class="number">68</span>, <span class="number">87</span>, <span class="number">109</span>, <span class="number">403</span>, <span class="number">520</span>, <span class="number">231</span>, <span class="number">391</span>, <span class="number">42</span>, <span class="number">51</span>, <span class="number">328</span>, <span class="number">253</span>, <span class="number">436</span>, <span class="number">60</span>, <span class="number">497</span>, <span class="number">313</span>, <span class="number">481</span>, <span class="number">522</span>, <span class="number">53</span>, <span class="number">61</span>, <span class="number">420</span>, <span class="number">225</span>, <span class="number">189</span>, <span class="number">325</span>, <span class="number">183</span>, <span class="number">56</span>, <span class="number">100</span>, <span class="number">229</span>, <span class="number">27</span>, <span class="number">39</span>, <span class="number">3</span>, <span class="number">184</span>, <span class="number">291</span>, <span class="number">415</span>, <span class="number">454</span>, <span class="number">75</span>, <span class="number">28</span>, <span class="number">107</span>, <span class="number">347</span>, <span class="number">421</span>, <span class="number">166</span>, <span class="number">224</span>, <span class="number">279</span>, <span class="number">16</span>, <span class="number">342</span>, <span class="number">206</span>, <span class="number">207</span>, <span class="number">171</span>, <span class="number">368</span>, <span class="number">198</span>, <span class="number">456</span>, <span class="number">464</span>, <span class="number">406</span>, <span class="number">365</span>, <span class="number">151</span>, <span class="number">320</span>, <span class="number">161</span>, <span class="number">9</span>, <span class="number">89</span>, <span class="number">479</span>, <span class="number">142</span>, <span class="number">259</span>, <span class="number">401</span>, <span class="number">232</span>, <span class="number">523</span>, <span class="number">449</span>, <span class="number">150</span>, <span class="number">218</span>, <span class="number">15</span>, <span class="number">97</span>, <span class="number">287</span>, <span class="number">133</span>, <span class="number">458</span>, <span class="number">221</span>, <span class="number">63</span>, <span class="number">185</span>, <span class="number">350</span>, <span class="number">74</span>, <span class="number">135</span>, <span class="number">404</span>, <span class="number">466</span>, <span class="number">214</span>, <span class="number">116</span>, <span class="number">507</span>, <span class="number">355</span>, <span class="number">213</span>, <span class="number">178</span>, <span class="number">318</span>, <span class="number">423</span>, <span class="number">126</span>, <span class="number">395</span>, <span class="number">465</span>, <span class="number">440</span>, <span class="number">452</span>, <span class="number">157</span>, <span class="number">366</span>, <span class="number">190</span>, <span class="number">343</span>, <span class="number">467</span>, <span class="number">247</span>, <span class="number">509</span>, <span class="number">91</span>, <span class="number">205</span>, <span class="number">114</span>, <span class="number">193</span>, <span class="number">409</span>, <span class="number">375</span>, <span class="number">269</span>, <span class="number">373</span>, <span class="number">389</span>, <span class="number">148</span>, <span class="number">69</span>, <span class="number">396</span>, <span class="number">398</span>, <span class="number">317</span>, <span class="number">145</span>, <span class="number">122</span>, <span class="number">147</span>, <span class="number">512</span>, <span class="number">32</span>, <span class="number">130</span>, <span class="number">386</span>, <span class="number">94</span>, <span class="number">435</span>, <span class="number">310</span>, <span class="number">57</span>, <span class="number">422</span>, <span class="number">308</span>, <span class="number">305</span>, <span class="number">217</span>, <span class="number">8</span>, <span class="number">154</span>, <span class="number">156</span>, <span class="number">309</span>, <span class="number">223</span>, <span class="number">44</span>, <span class="number">24</span>, <span class="number">82</span>, <span class="number">160</span>, <span class="number">392</span>, <span class="number">477</span>, <span class="number">356</span>, <span class="number">134</span>, <span class="number">54</span>, <span class="number">138</span>, <span class="number">378</span>, <span class="number">331</span>, <span class="number">379</span>, <span class="number">250</span>, <span class="number">96</span>, <span class="number">489</span>, <span class="number">306</span>, <span class="number">399</span>, <span class="number">46</span>, <span class="number">18</span>, <span class="number">283</span>, <span class="number">470</span>, <span class="number">21</span>, <span class="number">360</span>, <span class="number">209</span>, <span class="number">168</span>, <span class="number">495</span>, <span class="number">180</span>, <span class="number">514</span>, <span class="number">191</span>, <span class="number">270</span>, <span class="number">510</span>, <span class="number">381</span>, <span class="number">186</span>, <span class="number">442</span>, <span class="number">31</span>, <span class="number">390</span>, <span class="number">5</span>, <span class="number">85</span>, <span class="number">92</span>, <span class="number">363</span>, <span class="number">33</span>, <span class="number">127</span>, <span class="number">197</span>, <span class="number">285</span>, <span class="number">380</span>, <span class="number">265</span>, <span class="number">48</span>, <span class="number">352</span>, <span class="number">505</span>, <span class="number">208</span>, <span class="number">438</span>, <span class="number">329</span>, <span class="number">468</span>, <span class="number">282</span>, <span class="number">45</span>, <span class="number">159</span>, <span class="number">301</span>, <span class="number">362</span>, <span class="number">341</span>, <span class="number">65</span>, <span class="number">263</span>, <span class="number">393</span>, <span class="number">222</span>, <span class="number">521</span>, <span class="number">175</span>, <span class="number">293</span>, <span class="number">37</span>, <span class="number">490</span>, <span class="number">35</span>], <span class="number">60</span>)</span><br><span class="line">enc = <span class="number">912396759652812740801869061695733452669218533249083289698313292427681899514848561025221753354562922565560034</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># kbits = gift[0][1].bit_length()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_sbox</span>(<span class="params">s_box</span>):</span><br><span class="line">    inv = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(s_box)):</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> s_box:</span><br><span class="line">            inv.append(s_box.index(i))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            inv.append(<span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> inv</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec_flag</span>(<span class="params">enc, key</span>):</span><br><span class="line">    key = bytes_to_long(md5(long_to_bytes(key)).digest())</span><br><span class="line">    dec = enc ^ key</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(dec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s_box = inv_sbox(gift[<span class="number">1</span>])</span><br><span class="line">data = gift[<span class="number">0</span>][(s_box[gift[<span class="number">2</span>] // <span class="number">2</span>])]</span><br><span class="line"></span><br><span class="line">key1 = (data &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">key = get_key(key1)</span><br><span class="line"><span class="built_in">print</span>(dec_flag(enc, key))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>原理不懂，但报错要了我几个小时来改，最后偶然发现运行 <code>python test.sage</code> 就出了，因为这是个在python不会报错的而在sage里却报错的错误</p>
<h3 id="哪位师傅知道这个是什么密码啊？"><a href="#哪位师傅知道这个是什么密码啊？" class="headerlink" title="哪位师傅知道这个是什么密码啊？"></a>哪位师傅知道这个是什么密码啊？</h3><p>题目描述：<strong>为什么我运行了加密不出结果啊？为什么啊？啊？</strong></p>
<p>题目作者：<strong>春哥</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">F = <span class="keyword">lambda</span> x: x * F(x-<span class="number">1</span>) <span class="keyword">if</span> x &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">G = <span class="keyword">lambda</span> x, y: F(x) // (F(y) * F(x-y))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_keys</span>(<span class="params">n: <span class="built_in">int</span></span>):</span><br><span class="line">    p = getPrime(-<span class="number">11</span>+<span class="number">45</span>-<span class="number">14</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Please wait...&#x27;</span>)</span><br><span class="line">    s_list, t_list, u_list = [], [], []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;Progress: <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> / <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            t, s = <span class="built_in">sorted</span>(getPrime(<span class="number">101</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;NB&#x27;</span>)</span><br><span class="line">            u = (G(s, t) % p) &amp; <span class="number">0xFF</span></span><br><span class="line">            <span class="keyword">if</span> (u != <span class="number">0</span>):</span><br><span class="line">                s_list.append(s)</span><br><span class="line">                t_list.append(t)</span><br><span class="line">                u_list.append(u)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> (s_list, t_list, p), u_list </span><br><span class="line"></span><br><span class="line">FLAG = os.getenv(<span class="string">&#x27;FLAG&#x27;</span>, <span class="string">&#x27;ctfshow&#123;never_gonna_give_you_flag&#125;&#x27;</span>)</span><br><span class="line">pubkey, privkey = get_keys(<span class="built_in">len</span>(FLAG))</span><br><span class="line">ciphertext = <span class="built_in">bytes</span>(x ^ k <span class="keyword">for</span> x, k <span class="keyword">in</span> <span class="built_in">zip</span>(FLAG.encode(), privkey))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;pubkey = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;ciphertext.<span class="built_in">hex</span>() = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>大数阶乘 取模</p>
<p>官方exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">x</span>):</span><br><span class="line">    sys.stdout.write(<span class="string">f&#x27;<span class="subst">&#123;x&#125;</span>\n&#x27;</span>)</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_factorial_list</span>(<span class="params">p</span>):</span><br><span class="line">    factorial_list = [<span class="number">1</span>] * p</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, p):</span><br><span class="line">        factorial_list[i] = factorial_list[i-<span class="number">1</span>] * i % p</span><br><span class="line">    <span class="keyword">return</span> factorial_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">G</span>(<span class="params">x, y, p, factorial_list</span>):</span><br><span class="line">    x1, x2 = x // p, x % p</span><br><span class="line">    y1, y2 = y // p, y % p</span><br><span class="line">    <span class="comment"># print(f&#x27;&#123;x = &#125;, &#123;y = &#125;&#x27;)</span></span><br><span class="line">    <span class="comment"># print(f&#x27;&#123;x2 = &#125;, &#123;y2 = &#125;&#x27;)</span></span><br><span class="line">    <span class="keyword">if</span> (x2 &lt; y2):</span><br><span class="line">        cur_G = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cur_G = factorial_list[x2] * inverse(factorial_list[y2], p) * inverse(factorial_list[x2-y2], p) % p</span><br><span class="line">    <span class="comment"># print(f&#x27;&#123;cur_G = &#125;&#x27;)</span></span><br><span class="line">    <span class="keyword">if</span> (x1 == <span class="number">0</span>) <span class="keyword">and</span> (y1 == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> cur_G</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> G(x1, y1, p, factorial_list) * cur_G % p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s_list, t_list, p = ([<span class="number">2169473130821045784730790990467</span>, <span class="number">1449356852383878426566151663779</span>, <span class="number">2493349044744929793688627611149</span>, <span class="number">2134761062425015016604861755903</span>, <span class="number">2483034308427036483670406264923</span>, <span class="number">2245716791688272015151872944729</span>, <span class="number">2007785455169671161648798463391</span>, <span class="number">2240263858562962533407395118741</span>, <span class="number">2199653607884757419445443467171</span>, <span class="number">1892733395877536413087732462387</span>, <span class="number">2017642896410964696824916415717</span>, <span class="number">1525416837290524051585860586307</span>, <span class="number">1778082613236735124743572147159</span>, <span class="number">2197003827536615963771897307709</span>, <span class="number">2238244367849318469584746238461</span>, <span class="number">2106042304664372146486642002017</span>, <span class="number">2245855282910139891500464313371</span>, <span class="number">2233027706318121482574037143619</span>, <span class="number">2269115833481001638212461686719</span>, <span class="number">2219909401619999795891972723863</span>, <span class="number">1408053605297750247198874660711</span>, <span class="number">2095256802183309011076083152603</span>, <span class="number">2136456464566757431368235343093</span>, <span class="number">2285506903121970350143709058949</span>, <span class="number">1957061183493503498919325046029</span>, <span class="number">2457331225267459281319860495023</span>, <span class="number">1409022015193111891630813054243</span>, <span class="number">2525617774749763898371613130007</span>, <span class="number">1790539630767594144602088192383</span>, <span class="number">2225824951561730787349356744481</span>, <span class="number">1918712125318733455848759526753</span>, <span class="number">1925517758189720082278113664557</span>, <span class="number">2512298287727749709575301654483</span>, <span class="number">2065254062105719559515529127317</span>, <span class="number">1944904657236300566640138983597</span>, <span class="number">2509060767827661834029577492229</span>, <span class="number">1445911742376810920421245239871</span>, <span class="number">2252653104480183111484274663167</span>, <span class="number">2214359180192497909659970947937</span>, <span class="number">2392023156038690925569184542381</span>, <span class="number">2468194666587103535038927978747</span>, <span class="number">2137273008753025750754135256313</span>, <span class="number">1860423366614911344577702060289</span>, <span class="number">2192085257564223884505999975823</span>, <span class="number">1962530081404657743008348955163</span>], [<span class="number">1590348358505014988622312032471</span>, <span class="number">1440970986600794291092648756367</span>, <span class="number">1555690743078696585382674111791</span>, <span class="number">1537445328209593052665302637151</span>, <span class="number">1612317478758460736168277288763</span>, <span class="number">2231686860857034849432227304287</span>, <span class="number">1583532382383197709285641910899</span>, <span class="number">2169279313586858645434940846659</span>, <span class="number">1931402784910551900735634861873</span>, <span class="number">1797701334134291762058798189121</span>, <span class="number">1903539209949045965433500740807</span>, <span class="number">1473467664883654503284892664369</span>, <span class="number">1751331560725280431421676409603</span>, <span class="number">2089897955327690649757160502149</span>, <span class="number">1923971006077646365607243482739</span>, <span class="number">1863034106424449611722082348927</span>, <span class="number">1312544069279374606054075309357</span>, <span class="number">2131068231080921143368714825203</span>, <span class="number">2086463476093219386201552512567</span>, <span class="number">1560177070638112494896909188513</span>, <span class="number">1307420748743867422149455470609</span>, <span class="number">1807563713566775065879664230051</span>, <span class="number">2114263139857857969658887008017</span>, <span class="number">1609306244955096612039506486569</span>, <span class="number">1623094273653649066194646511171</span>, <span class="number">2400696233713561215916575142507</span>, <span class="number">1318059629541799023274296376661</span>, <span class="number">2414119023158594885888974289113</span>, <span class="number">1777507328244848462615948947837</span>, <span class="number">2065253720031548286854056878751</span>, <span class="number">1540469627569646718412541734861</span>, <span class="number">1776467933213165492416940154007</span>, <span class="number">1532302746066365760320339371763</span>, <span class="number">1290302629475805723721535581609</span>, <span class="number">1880300909305485379589295332029</span>, <span class="number">1584562156092887356432708356107</span>, <span class="number">1393195609906772235759082420501</span>, <span class="number">1713209896195348598916703481807</span>, <span class="number">1690549975167026745296280906779</span>, <span class="number">1620804254863211629908460175947</span>, <span class="number">2355042511124816525048523659633</span>, <span class="number">1976901781158698209614100227719</span>, <span class="number">1590804541546973741759893996729</span>, <span class="number">1848691390035222525567924855841</span>, <span class="number">1587908373391523000293352350193</span>], <span class="number">947407</span>)</span><br><span class="line">ciphertext = <span class="number">0x089882583bf628c0b0c089749a9f6573d6883045f2f13eb264ffdefa1d4e2817b3248ed92a4f47c106aba0dfd6</span></span><br><span class="line"></span><br><span class="line">factorial_list = get_factorial_list(p)</span><br><span class="line">u_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s_list)):</span><br><span class="line">    u = G(s_list[i], t_list[i], p, factorial_list) &amp; <span class="number">0xFF</span></span><br><span class="line">    u_list.append(u)</span><br><span class="line"></span><br><span class="line">ciphertext = <span class="built_in">list</span>(long_to_bytes(ciphertext))</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">bytes</span>(x ^ k <span class="keyword">for</span> x, k <span class="keyword">in</span> <span class="built_in">zip</span>(ciphertext, u_list))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># ctfshow&#123;5f4e0bfd-6449-4454-b516-b48aad89532e&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="Lucas-定理"><a href="#Lucas-定理" class="headerlink" title="Lucas 定理"></a>Lucas 定理</h4><p>Lucas 定理用于求解大组合数取模的问题，其中模数必须为素数。正常的组合数运算可以通过递推公式求解（详见 <span class="exturl" data-url="aHR0cHM6Ly9vaS13aWtpLm9yZy9tYXRoL2NvbWJpbmF0b3JpY3MvY29tYmluYXRpb24v">排列组合<i class="fa fa-external-link-alt"></i></span>），但当问题规模很大，而模数是一个不大的质数的时候，就不能简单地通过递推求解来得到答案，需要用到 Lucas 定理。</p>
<script type="math/tex; mode=display">
u = \frac{x!}{y!(x-y)!}\bmod p \mod 255</script><p><code>&amp; 255</code> 某种程度上相当于 <code>% 255</code> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">pubkey = ([<span class="number">2169473130821045784730790990467</span>, <span class="number">1449356852383878426566151663779</span>, <span class="number">2493349044744929793688627611149</span>, <span class="number">2134761062425015016604861755903</span>, <span class="number">2483034308427036483670406264923</span>, <span class="number">2245716791688272015151872944729</span>, <span class="number">2007785455169671161648798463391</span>, <span class="number">2240263858562962533407395118741</span>, <span class="number">2199653607884757419445443467171</span>, <span class="number">1892733395877536413087732462387</span>, <span class="number">2017642896410964696824916415717</span>, <span class="number">1525416837290524051585860586307</span>, <span class="number">1778082613236735124743572147159</span>, <span class="number">2197003827536615963771897307709</span>, <span class="number">2238244367849318469584746238461</span>, <span class="number">2106042304664372146486642002017</span>, <span class="number">2245855282910139891500464313371</span>, <span class="number">2233027706318121482574037143619</span>, <span class="number">2269115833481001638212461686719</span>, <span class="number">2219909401619999795891972723863</span>, <span class="number">1408053605297750247198874660711</span>, <span class="number">2095256802183309011076083152603</span>, <span class="number">2136456464566757431368235343093</span>, <span class="number">2285506903121970350143709058949</span>, <span class="number">1957061183493503498919325046029</span>, <span class="number">2457331225267459281319860495023</span>, <span class="number">1409022015193111891630813054243</span>, <span class="number">2525617774749763898371613130007</span>, <span class="number">1790539630767594144602088192383</span>, <span class="number">2225824951561730787349356744481</span>, <span class="number">1918712125318733455848759526753</span>, <span class="number">1925517758189720082278113664557</span>, <span class="number">2512298287727749709575301654483</span>, <span class="number">2065254062105719559515529127317</span>, <span class="number">1944904657236300566640138983597</span>, <span class="number">2509060767827661834029577492229</span>, <span class="number">1445911742376810920421245239871</span>, <span class="number">2252653104480183111484274663167</span>, <span class="number">2214359180192497909659970947937</span>, <span class="number">2392023156038690925569184542381</span>, <span class="number">2468194666587103535038927978747</span>, <span class="number">2137273008753025750754135256313</span>, <span class="number">1860423366614911344577702060289</span>, <span class="number">2192085257564223884505999975823</span>, <span class="number">1962530081404657743008348955163</span>], [<span class="number">1590348358505014988622312032471</span>, <span class="number">1440970986600794291092648756367</span>, <span class="number">1555690743078696585382674111791</span>, <span class="number">1537445328209593052665302637151</span>, <span class="number">1612317478758460736168277288763</span>, <span class="number">2231686860857034849432227304287</span>, <span class="number">1583532382383197709285641910899</span>, <span class="number">2169279313586858645434940846659</span>, <span class="number">1931402784910551900735634861873</span>, <span class="number">1797701334134291762058798189121</span>, <span class="number">1903539209949045965433500740807</span>, <span class="number">1473467664883654503284892664369</span>, <span class="number">1751331560725280431421676409603</span>, <span class="number">2089897955327690649757160502149</span>, <span class="number">1923971006077646365607243482739</span>, <span class="number">1863034106424449611722082348927</span>, <span class="number">1312544069279374606054075309357</span>, <span class="number">2131068231080921143368714825203</span>, <span class="number">2086463476093219386201552512567</span>, <span class="number">1560177070638112494896909188513</span>, <span class="number">1307420748743867422149455470609</span>, <span class="number">1807563713566775065879664230051</span>, <span class="number">2114263139857857969658887008017</span>, <span class="number">1609306244955096612039506486569</span>, <span class="number">1623094273653649066194646511171</span>, <span class="number">2400696233713561215916575142507</span>, <span class="number">1318059629541799023274296376661</span>, <span class="number">2414119023158594885888974289113</span>, <span class="number">1777507328244848462615948947837</span>, <span class="number">2065253720031548286854056878751</span>, <span class="number">1540469627569646718412541734861</span>, <span class="number">1776467933213165492416940154007</span>, <span class="number">1532302746066365760320339371763</span>, <span class="number">1290302629475805723721535581609</span>, <span class="number">1880300909305485379589295332029</span>, <span class="number">1584562156092887356432708356107</span>, <span class="number">1393195609906772235759082420501</span>, <span class="number">1713209896195348598916703481807</span>, <span class="number">1690549975167026745296280906779</span>, <span class="number">1620804254863211629908460175947</span>, <span class="number">2355042511124816525048523659633</span>, <span class="number">1976901781158698209614100227719</span>, <span class="number">1590804541546973741759893996729</span>, <span class="number">1848691390035222525567924855841</span>, <span class="number">1587908373391523000293352350193</span>], <span class="number">947407</span>)</span><br><span class="line">(S_list, T_list, p) = pubkey</span><br><span class="line">ciphertext = <span class="string">&quot;089882583bf628c0b0c089749a9f6573d6883045f2f13eb264ffdefa1d4e2817b3248ed92a4f47c106aba0dfd6&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pow</span>(<span class="params">a, b, m</span>):  <span class="comment"># 快速幂</span></span><br><span class="line">    ans = <span class="number">1</span></span><br><span class="line">    a %= m</span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        <span class="keyword">if</span> b &amp; <span class="number">1</span>:</span><br><span class="line">            ans = (ans % m) * (a % m) % m</span><br><span class="line">        b //= <span class="number">2</span></span><br><span class="line">        a = (a % m) * (a % m) % m</span><br><span class="line">    ans %= m</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv</span>(<span class="params">x, p</span>):  <span class="comment"># 快速求逆元</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(x, p - <span class="number">2</span>, p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">C</span>(<span class="params">n, m, p</span>):  <span class="comment"># 组合数</span></span><br><span class="line">    <span class="keyword">if</span> m &gt; n:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    up, down = <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - m + <span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">        up = up * i % p</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, m + <span class="number">1</span>):</span><br><span class="line">        down = down * i % p</span><br><span class="line">    <span class="keyword">return</span> up * inv(down, p) % p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Lucas</span>(<span class="params">n, m, p</span>):</span><br><span class="line">    <span class="keyword">if</span> m == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> C(n % p, m % p, p) * Lucas(n // p, m // p, p) % p</span><br><span class="line"></span><br><span class="line">u_list = []</span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> s, t <span class="keyword">in</span> <span class="built_in">zip</span>(S_list, T_list):</span><br><span class="line">    tmp = Lucas(s, t, p)</span><br><span class="line">    u = tmp &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Round<span class="subst">&#123;i&#125;</span>:u = <span class="subst">&#123;u&#125;</span>&quot;</span>)</span><br><span class="line">    u_list.append(u)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">bytes</span>(x ^ k <span class="keyword">for</span> x, k <span class="keyword">in</span> <span class="built_in">zip</span>(<span class="built_in">bytes</span>.fromhex(ciphertext), u_list))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># ctfshow&#123;5f4e0bfd-6449-4454-b516-b48aad89532e&#125;</span></span><br></pre></td></tr></table></figure>
<p><span class="exturl" data-url="aHR0cHM6Ly9vaS13aWtpLm9yZy9tYXRoL251bWJlci10aGVvcnkvbHVjYXMvIyVFOCVBRiU4MSVFNiU5OCU4RQ==">https://oi-wiki.org/math/number-theory/lucas/#%E8%AF%81%E6%98%8E<i class="fa fa-external-link-alt"></i></span></p>

    </div>

    
    
    
<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------　　　　本文结束　<i class="fa fa-flag"></i>　感谢阅读　　　　-------------</div>
    
</div>


        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Wbuildings
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://wbuildings.github.io/Crypto/ctfshow%E5%85%83%E6%97%A6%E6%B0%B4%E5%8F%8B%E8%8A%82/" title="ctfshow元旦水友节">https://wbuildings.github.io/Crypto/ctfshow元旦水友节/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/Wp/" rel="tag"><i class="fa fa-tag"></i> Wp</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/Crypto/2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%86%AC%E5%AD%A3%E8%B5%9B/" rel="prev" title="2023年春秋杯网络安全联赛冬季赛">
      <i class="fa fa-chevron-left"></i> 2023年春秋杯网络安全联赛冬季赛
    </a></div>
      <div class="post-nav-item">
    <a href="/Crypto/SICTF-Round-3/" rel="next" title="SICTF Round#3">
      SICTF Round#3 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%88%E6%9C%88%E7%9A%84%E7%88%B1%E6%83%85%E6%95%85%E4%BA%8B"><span class="nav-number">1.</span> <span class="nav-text">月月的爱情故事</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BA%BB%E8%BE%A3%E5%85%94%E5%A4%B4%E5%8F%88%E4%B8%80%E9%94%85"><span class="nav-number">2.</span> <span class="nav-text">麻辣兔头又一锅</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NOeasyRSA"><span class="nav-number">3.</span> <span class="nav-text">NOeasyRSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sign-rand"><span class="nav-number">4.</span> <span class="nav-text">sign_rand</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%93%AA%E4%BD%8D%E5%B8%88%E5%82%85%E7%9F%A5%E9%81%93%E8%BF%99%E4%B8%AA%E6%98%AF%E4%BB%80%E4%B9%88%E5%AF%86%E7%A0%81%E5%95%8A%EF%BC%9F"><span class="nav-number">5.</span> <span class="nav-text">哪位师傅知道这个是什么密码啊？</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Wbuildings"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Wbuildings</p>
  <div class="site-description" itemprop="description">须知少年凌云志，曾许人间第一流</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span>
  </div>


<!-- recent posts -->

      </div>

      
      <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
      <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
      <div class="widget-wrap">
          <h3 class="widget-title">Tag Cloud</h3>
          <div id="myCanvasContainer" class="widget tagcloud">
              <canvas width="250" height="250" id="resCanvas" style="width=100%">
                  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AES/" rel="tag">AES</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DSA/" rel="tag">DSA</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dual-RSA/" rel="tag">Dual RSA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ECRSA/" rel="tag">ECRSA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HNP/" rel="tag">HNP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LFSR/" rel="tag">LFSR</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LWE/" rel="tag">LWE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lattice/" rel="tag">Lattice</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MITM/" rel="tag">MITM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MT19937/" rel="tag">MT19937</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RSA/" rel="tag">RSA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Schmidt-Samoa/" rel="tag">Schmidt-Samoa</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shamir/" rel="tag">Shamir</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sylvester/" rel="tag">Sylvester</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Wp/" rel="tag">Wp</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sage/" rel="tag">sage</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E5%85%83copper/" rel="tag">二元copper</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/" rel="tag">古典密码</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E7%9F%A5%E8%AF%86/" rel="tag">密码知识</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9B%B2%E7%BA%BF/" rel="tag">曲线</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E8%AE%B0/" rel="tag">杂记</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%B4%A0%E6%95%B0/" rel="tag">素数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%83%8C%E5%8C%85%E5%AF%86%E7%A0%81/" rel="tag">背包密码</a><span class="tag-list-count">2</span></li></ul>
              </canvas>
          </div>
      </div>
      


    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wbuildings</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">1m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">15:50</span>
</div>

  <script>
    var OriginTitle = document.title;
    var titleTime;
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        document.title = '(*^▽^*)我藏好了哦~' + OriginTitle;
        clearTimeout(titleTime);
      } else {
        document.title = 'q(≧▽≦q)被你发现啦~' + OriginTitle;
        titleTime = setTimeout(function() {
          document.title = OriginTitle;
        }, 2000);
      }
    });
  </script>


<script color="24,24,24" opacity="0.5" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  
  <script data-pjax>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













    <div id="pjax">
  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://wbuildings.github.io/Crypto/ctfshow%E5%85%83%E6%97%A6%E6%B0%B4%E5%8F%8B%E8%8A%82/',]
      });
      });
  </script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'apuSRwmMMe8HwB5WcdQuox47-gzGzoHsz',
      appKey     : 'MS1uA9PBT4L62Jbrjbh0UEHT',
      placeholder: "在这里写下你的评论吧！",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>


  <script async src="/js/love.min.js"></script>





    </div>
<script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>